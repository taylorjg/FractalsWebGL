{"version":3,"file":"653.js","mappings":"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","sources":["webpack://fractalswebgl/./node_modules/promise-worker/register.js","webpack://fractalswebgl/webpack/bootstrap","webpack://fractalswebgl/webpack/runtime/compat get default export","webpack://fractalswebgl/webpack/runtime/define property getters","webpack://fractalswebgl/webpack/runtime/hasOwnProperty shorthand","webpack://fractalswebgl/./src/js/constants.js","webpack://fractalswebgl/./src/js/utils.js","webpack://fractalswebgl/./src/js/web-worker.js"],"sourcesContent":["'use strict'\n\nfunction isPromise (obj) {\n  // via https://unpkg.com/is-promise@2.1.0/index.js\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function'\n}\n\nfunction registerPromiseWorker (callback) {\n  function postOutgoingMessage (e, messageId, error, result) {\n    function postMessage (msg) {\n      /* istanbul ignore if */\n      if (typeof self.postMessage !== 'function') { // service worker\n        e.ports[0].postMessage(msg)\n      } else { // web worker\n        self.postMessage(msg)\n      }\n    }\n    if (error) {\n      /* istanbul ignore else */\n      if (typeof console !== 'undefined' && 'error' in console) {\n        // This is to make errors easier to debug. I think it's important\n        // enough to just leave here without giving the user an option\n        // to silence it.\n        console.error('Worker caught an error:', error)\n      }\n      postMessage([messageId, {\n        message: error.message\n      }])\n    } else {\n      postMessage([messageId, null, result])\n    }\n  }\n\n  function tryCatchFunc (callback, message) {\n    try {\n      return { res: callback(message) }\n    } catch (e) {\n      return { err: e }\n    }\n  }\n\n  function handleIncomingMessage (e, callback, messageId, message) {\n    var result = tryCatchFunc(callback, message)\n\n    if (result.err) {\n      postOutgoingMessage(e, messageId, result.err)\n    } else if (!isPromise(result.res)) {\n      postOutgoingMessage(e, messageId, null, result.res)\n    } else {\n      result.res.then(function (finalResult) {\n        postOutgoingMessage(e, messageId, null, finalResult)\n      }, function (finalError) {\n        postOutgoingMessage(e, messageId, finalError)\n      })\n    }\n  }\n\n  function onIncomingMessage (e) {\n    var payload = e.data\n    if (!Array.isArray(payload) || payload.length !== 2) {\n      // message doens't match communication format; ignore\n      return\n    }\n    var messageId = payload[0]\n    var message = payload[1]\n\n    if (typeof callback !== 'function') {\n      postOutgoingMessage(e, messageId, new Error(\n        'Please pass a function into register().'))\n    } else {\n      handleIncomingMessage(e, callback, messageId, message)\n    }\n  }\n\n  self.addEventListener('message', onIncomingMessage)\n}\n\nmodule.exports = registerPromiseWorker\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export const INITIAL_ITERATIONS = 128;\nexport const MIN_ITERATIONS = 16;\nexport const MAX_ITERATIONS_MANUAL = 4096;\nexport const MAX_ITERATIONS_AUTO = 256;\nexport const DELTA_ITERATIONS = 16;\nexport const FRACTAL_SET_ID_MANDELBROT = 0;\nexport const FRACTAL_SET_ID_JULIA = 1;\n\nexport const COLOUR_MAP_NAMES = [\n  \"jet\",\n  \"hsv\",\n  \"hot\",\n  \"cool\",\n  \"warm\",\n  \"spring\",\n  \"summer\",\n  \"autumn\",\n  \"winter\",\n  \"bone\",\n  \"copper\",\n  \"greys\",\n  \"YIOrRd\",\n  \"bluered\",\n  \"RdBu\",\n  \"picnic\",\n  \"rainbow\",\n  \"portland\",\n  \"blackbody\",\n  \"earth\",\n  \"electric\",\n  \"viridis\",\n  \"inferno\",\n  \"magma\",\n  \"plasma\",\n  \"rainbow-soft\",\n  \"bathymetry\",\n  \"cdom\",\n  \"chlorophyll\",\n  \"density\",\n  \"freesurface-blue\",\n  \"freesurface-red\",\n];\n\nexport const INITIAL_BOOKMARK = {\n  fractalSetId: FRACTAL_SET_ID_MANDELBROT,\n  juliaConstant: { x: 0, y: 0 },\n  colourMapId: 0,\n  regionBottomLeft: { x: -0.22, y: -0.7 },\n  regionTopRight: { x: -0.21, y: -0.69 },\n  maxIterations: INITIAL_ITERATIONS,\n};\n\nexport const HOME_BOOKMARK = {\n  fractalSetId: FRACTAL_SET_ID_MANDELBROT,\n  juliaConstant: { x: 0, y: 0 },\n  colourMapId: 0,\n  regionBottomLeft: { x: -2.25, y: -1.5 },\n  regionTopRight: { x: 0.75, y: 1.5 },\n  maxIterations: INITIAL_ITERATIONS,\n};\n","export const clamp = (min, max, value) => Math.max(min, Math.min(max, value));\n\nexport const randomFloat = (min, max) => {\n  return Math.random() * (max - min) + min;\n};\n\nexport const randomInt = (min, max) => {\n  return Math.trunc(randomFloat(min, max));\n};\n\nexport const randomElement = (elements) => {\n  const randomIndex = randomInt(0, elements.length);\n  return elements[randomIndex];\n};\n\nexport const randomPanSpeed = () => randomFloat(-0.1, 0.1);\n\nexport const randomZoomSpeed = () => randomFloat(0.01, 0.1);\n","import registerPromiseWorker from \"promise-worker/register\";\nimport * as C from \"./constants\";\nimport * as U from \"./utils\";\n\nconst evaluatePoint = (configuration, point) => {\n  let z = { x: 0, y: 0 };\n  const c = point;\n  let iteration = 0;\n  while (iteration < configuration.maxIterations) {\n    if (z.x * z.x + z.y * z.y >= 4) break;\n    const zSquared = { x: z.x * z.x - z.y * z.y, y: 2.0 * z.x * z.y };\n    z = { x: zSquared.x + c.x, y: zSquared.y + c.y };\n    iteration += 1;\n  }\n  return iteration;\n};\n\nconst evaluatePoints = (configuration, gridSize) => {\n  const w = configuration.regionTopRight.x - configuration.regionBottomLeft.x;\n  const h = configuration.regionTopRight.y - configuration.regionBottomLeft.y;\n  const dx = w / (gridSize + 1);\n  const dy = h / (gridSize + 1);\n  const values = [];\n  for (let row = 1; row <= gridSize; row++) {\n    const y = configuration.regionBottomLeft.y + row * dy;\n    for (let col = 1; col <= gridSize; col++) {\n      const x = configuration.regionBottomLeft.x + col * dx;\n      const point = { x, y };\n      const value = evaluatePoint(configuration, point);\n      values.push(value);\n    }\n  }\n  return values;\n};\n\nconst isInteresting = (configuration) => {\n  const gridSize = 12;\n  const values = evaluatePoints(configuration, gridSize);\n  const factor = U.randomFloat(0.4, 0.7);\n  return new Set(values).size >= values.length * factor;\n};\n\nconst createRandomConfiguration = (fractalSetIds, colourMapIds) => {\n  const fractalSetId = U.randomElement(fractalSetIds);\n  const colourMapId = U.randomElement(colourMapIds);\n  const cx = U.randomFloat(-2, 0.75);\n  const cy = U.randomFloat(-1.5, 1.5);\n  const sz = U.randomFloat(0.01, 0.5);\n  const maxIterations = U.randomInt(C.MIN_ITERATIONS, C.MAX_ITERATIONS_AUTO);\n  const panSpeedX = U.randomPanSpeed();\n  const panSpeedY = U.randomPanSpeed();\n  const zoomSpeed = U.randomZoomSpeed();\n\n  return {\n    fractalSetId,\n    juliaConstant: { x: cx, y: cy },\n    colourMapId,\n    regionBottomLeft: { x: cx - sz, y: cy - sz },\n    regionTopRight: { x: cx + sz, y: cy + sz },\n    maxIterations,\n    panSpeedX,\n    panSpeedY,\n    zoomSpeed,\n  };\n};\n\nconst onChooseConfiguration = (fractalSetIds, colourMapIds) => {\n  for (;;) {\n    const configuration = createRandomConfiguration(\n      fractalSetIds,\n      colourMapIds\n    );\n    if (isInteresting(configuration)) {\n      // console.log(\"[onChooseConfiguration]\", \"configuration:\", JSON.stringify(configuration, null, 2));\n      return configuration;\n    }\n  }\n};\n\nconst onUnknownMessage = (message) => {\n  console.log(`Unknown message: ${JSON.stringify(message)}`);\n};\n\nconst processMessage = (message) => {\n  // console.log(\"[processMessage]\", \"message.type:\", message.type);\n  switch (message.type) {\n    case \"chooseConfiguration\":\n      return onChooseConfiguration(message.fractalSetIds, message.colourMapIds);\n    default:\n      return onUnknownMessage(message);\n  }\n};\n\nregisterPromiseWorker(processMessage);\n"],"names":["module","exports","callback","postOutgoingMessage","e","messageId","error","result","postMessage","msg","self","ports","console","message","addEventListener","payload","data","Array","isArray","length","Error","obj","res","err","tryCatchFunc","then","finalResult","finalError","handleIncomingMessage","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","randomFloat","min","max","Math","random","randomInt","trunc","randomElement","elements","randomPanSpeed","evaluatePoint","configuration","point","z","x","y","c","iteration","maxIterations","zSquared","isInteresting","values","gridSize","dx","regionTopRight","regionBottomLeft","dy","row","col","value","push","evaluatePoints","factor","Set","size","createRandomConfiguration","fractalSetIds","colourMapIds","fractalSetId","colourMapId","cx","cy","sz","juliaConstant","panSpeedX","panSpeedY","zoomSpeed","type","onChooseConfiguration","log","JSON","stringify","onUnknownMessage"],"sourceRoot":""}