(()=>{var e={440:e=>{e.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},800:(e,n,r)=>{"use strict";var i=r(440),t=r(450);function o(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function a(e){for(var n,r="#",i=0;i<3;++i)r+=("00"+(n=(n=e[i]).toString(16))).substr(n.length);return r}function d(e){return"rgba("+e.join(",")+")"}e.exports=function(e){var n,r,g,x,b,s,c,l,u,m;if(e||(e={}),l=(e.nshades||72)-1,c=e.format||"hex",(s=e.colormap)||(s="jet"),"string"==typeof s){if(s=s.toLowerCase(),!i[s])throw Error(s+" not a supported colorscale");b=i[s]}else{if(!Array.isArray(s))throw Error("unsupported colormap option",s);b=s.slice()}if(b.length>l+1)throw new Error(s+" map requires nshades to be at least size "+b.length);u=Array.isArray(e.alpha)?2!==e.alpha.length?[1,1]:e.alpha.slice():"number"==typeof e.alpha?[e.alpha,e.alpha]:[1,1],n=b.map((function(e){return Math.round(e.index*l)})),u[0]=Math.min(Math.max(u[0],0),1),u[1]=Math.min(Math.max(u[1],0),1);var f=b.map((function(e,n){var r=b[n].index,i=b[n].rgb.slice();return 4===i.length&&i[3]>=0&&i[3]<=1||(i[3]=u[0]+(u[1]-u[0])*r),i})),p=[];for(m=0;m<n.length-1;++m){x=n[m+1]-n[m],r=f[m],g=f[m+1];for(var h=0;h<x;h++){var y=h/x;p.push([Math.round(t(r[0],g[0],y)),Math.round(t(r[1],g[1],y)),Math.round(t(r[2],g[2],y)),t(r[3],g[3],y)])}}return p.push(b[b.length-1].rgb.concat(u[1])),"hex"===c?p=p.map(a):"rgbaString"===c?p=p.map(d):"float"===c&&(p=p.map(o)),p}},450:e=>{e.exports=function(e,n,r){return e*(1-r)+n*r}},905:e=>{"use strict";var n=0;function r(e,n){var r=n.data;if(Array.isArray(r)&&!(r.length<2)){var i=r[0],t=r[1],o=r[2],a=e._callbacks[i];a&&(delete e._callbacks[i],a(t,o))}}function i(e){var n=this;n._worker=e,n._callbacks={},e.addEventListener("message",(function(e){r(n,e)}))}i.prototype.postMessage=function(e){var i=this,t=n++,o=[t,e];return new Promise((function(e,n){if(i._callbacks[t]=function(r,i){if(r)return n(new Error(r.message));e(i)},void 0!==i._worker.controller){var a=new MessageChannel;a.port1.onmessage=function(e){r(i,e)},i._worker.controller.postMessage(o,[a.port2])}else i._worker.postMessage(o)}))},e.exports=i}},n={};function r(i){var t=n[i];if(void 0!==t)return t.exports;var o=n[i]={exports:{}};return e[i](o,o.exports,r),o.exports}r.m=e,r.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return r.d(n,{a:n}),n},r.d=(e,n)=>{for(var i in n)r.o(n,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},r.u=e=>e+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var n=r.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var i=n.getElementsByTagName("script");if(i.length)for(var t=i.length-1;t>-1&&!e;)e=i[t--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),r.b=document.baseURI||self.location.href,(()=>{"use strict";var e=r(905),n=r.n(e),i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});var t=r(800),o=r.n(t);const a=new Worker(new URL(r.p+r.u(415),r.b)),d=new(n())(a);let g,x;const b=new Map,s=new Map;let c,l,u,m,f,p,h=128,y={},v={},w=!1;const I={fractalSetId:0,juliaConstant:{x:0,y:0},colourMapId:0,regionBottomLeft:{x:-.22,y:-.7},regionTopRight:{x:-.21,y:-.69},maxIterations:128},M={fractalSetId:0,juliaConstant:{x:0,y:0},colourMapId:0,regionBottomLeft:{x:-2.25,y:-1.5},regionTopRight:{x:.75,y:1.5},maxIterations:128};let A=!1,T=0,k=new Map;const E=()=>x instanceof WebGL2RenderingContext,z=(e,n,r)=>{const i=e.createShader(r);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){const n=e.getShaderInfoLog(i);return console.error(`Failed to compile shader: ${n}`),null}return i},S=(e,n,r)=>{const i=z(x,n,x.VERTEX_SHADER),t=z(x,r,x.FRAGMENT_SHADER),o=x.createProgram();if(x.attachShader(o,i),x.attachShader(o,t),x.linkProgram(o),!x.getProgramParameter(o,x.LINK_STATUS)){const e=x.getProgramInfoLog(o);return void console.error(`Could not initialise shaders: ${e}`)}const a=x.getAttribLocation(o,"aVertexPosition");x.enableVertexAttribArray(a);const d=x.getAttribLocation(o,"aPlotPosition");x.enableVertexAttribArray(d);const g=x.getUniformLocation(o,"uModelViewMatrix"),b=x.getUniformLocation(o,"uColormap"),s=x.getUniformLocation(o,"uJuliaConstant"),c=E()?{uMaxIterations:x.getUniformLocation(o,"uMaxIterations")}:void 0,l=x.createBuffer();return x.bindBuffer(x.ARRAY_BUFFER,l),x.bufferData(x.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),x.STATIC_DRAW),x.vertexAttribPointer(a,2,x.FLOAT,!1,0,0),{name:e,program:o,aVertexPosition:a,aPlotPosition:d,uModelViewMatrix:g,...c,uColormap:b,uJuliaConstant:s,vertexPositionBuffer:l}},R=(e,n,r)=>{Number.isInteger(e)&&(c=e,l=b.get(e)),n&&(u=n),u||(u={x:0,y:0}),Number.isInteger(r)&&(m=r,f=s.get(r)),x.useProgram(l.program);const t=(o=new i(16),i!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o);var o;!function(e,n){e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(t,[1,-1,1]),x.uniformMatrix4fv(l.uModelViewMatrix,!1,t),x.uniform1i(l.uColormap,f.textureUnit),x.uniform2f(l.uJuliaConstant,u.x,u.y),L(),P()},P=()=>{const e=[v.x,v.y,y.x,v.y,v.x,y.y,y.x,y.y],n=x.createBuffer();x.bindBuffer(x.ARRAY_BUFFER,n),x.bufferData(x.ARRAY_BUFFER,new Float32Array(e),x.STATIC_DRAW),x.vertexAttribPointer(l.aPlotPosition,2,x.FLOAT,!1,0,0),E()&&x.uniform1i(l.uMaxIterations,h),x.drawArrays(x.TRIANGLE_STRIP,0,4),x.deleteBuffer(n)},C=async e=>{Y(e);const n={type:"chooseConfiguration",fractalSetIds:[0,1],colorMapIds:Array.from(s.keys())},r=await d.postMessage(n);setTimeout(C,1e4,r)},_=e=>{const n=(v.x-y.x)/100*e/2,r=(v.y-y.y)/100*e/2;y.x+=n,y.y+=r,v.x-=n,v.y-=r},L=()=>{g.width=g.clientWidth,g.height=g.clientHeight,x.viewport(0,0,g.width,g.height),((e,n)=>{const r=v.x-y.x,i=v.y-y.y;if(e>n){const t=(e/n*i-r)/2;y.x-=t,v.x+=t}if(e<n){const t=(n/e*r-i)/2;y.y-=t,v.y+=t}})(g.width,g.height)},B=()=>{L(),P()},N=e=>{const n=e.offsetX,r=e.offsetY,{regionMouseX:i,regionMouseY:t}=((e,n)=>{const r=v.x-y.x,i=v.y-y.y;return{regionMouseX:y.x+e*r/g.width,regionMouseY:y.y+n*i/g.height}})(n,r);if(e.shiftKey){const e=v.x-y.x,n=v.y-y.y,r=i-(y.x+e/2),o=t-(y.y+n/2);return y.x+=r,y.y+=o,v.x+=r,v.y+=o,P()}if(e.altKey)switch(c){case 0:return R(1,{x:i,y:t});case 1:return R(0);default:return}w=!0,p={mouseX:n,mouseY:r}},F=e=>{if(!w)return;const n=e.offsetX,r=e.offsetY,i=n-p.mouseX,t=r-p.mouseY,o=v.x-y.x,a=v.y-y.y,d=i*o/g.width,x=t*a/g.height;y.x-=d,y.y-=x,v.x-=d,v.y-=x,P(),p={mouseX:n,mouseY:r}},U=()=>{w=!1},D=()=>{w=!1},j=e=>{if(A)return X(e);if(A||"b"!==e.key||!e.ctrlKey){if("+"===e.key)return _(50),P();if("-"===e.key)return _(-100),P();if("h"===e.key&&e.ctrlKey)return Y(M);if(("c"===e.key||"C"===e.key)&&e.ctrlKey){const n=Array.from(s.keys()),r=n.length,i=n.indexOf(m),t=n[(i+(e.shiftKey?r-1:1))%r];return R(void 0,void 0,t)}if(E()&&("i"===e.key||"I"===e.key)){const n=16*(e.shiftKey?-1:1);return h+=n,h=Math.min(h,256),h=Math.max(h,16),P()}"r"===e.key||e.key}else A=!0},X=e=>{if(A=!1,"n"===e.key){const e=q();return O(e)}if("l"===e.key)return V()},O=e=>{const n=$("#bookmarkModal"),r=Number.isInteger(e.id),i=r?"Edit Bookmark":"Create Bookmark";$(".modal-title",n).text(i),$('input[type="submit"]',n).off("click").on("click",(i=>{i.preventDefault(),e.name=$("#name",n).val(),r||(e.id=T++,k.set(e.id,e)),J(k),n.modal("hide")}));const t=$("img.thumbnail",n),o=$("canvas.thumbnail",n);if(r)o.hide(),t.show(),t[0].src=e.thumbnail;else{t.hide(),o.show();const n=o[0],r=n.getContext("2d"),i=Math.min(g.width,g.height),a=Math.min(g.width,g.height),d=(g.width-i)/2,x=(g.height-a)/2,b=n.width,s=n.height;r.drawImage(g,d,x,i,a,0,0,b,s),e.thumbnail=n.toDataURL("image/jpeg",1)}$("#name",n).val(e.name).focus(),$(".fractal-set",n).text(b.get(e.fractalSetId).name),$(".colour-map",n).text(s.get(e.colourMapId).name),$(".max-iterations",n).text(e.maxIterations),$(".region-bottom-left",n).text(`(${e.regionBottomLeft.x}, ${e.regionBottomLeft.y})`),$(".region-top-right",n).text(`(${e.regionTopRight.x}, ${e.regionTopRight.y})`);const a=$(".julia-constant",n),d=a.closest("div");1===e.fractalSetId?(a.text(`(${e.juliaConstant.x}, ${e.juliaConstant.y})`),d.show()):d.hide(),n.modal()},V=()=>{const e=$("#manageBookmarksModal"),n=$("tbody",e).empty(),r=(n,r)=>()=>{e.modal("hide"),n(r)},i=e=>Y(e),t=e=>O(e),o=e=>{k.delete(e.id),J(k)},a=document.getElementById("bookmark-row-template");k.forEach((e=>{const d=document.importNode(a.content,!0),g=d.querySelector(":nth-child(1) img"),x=d.querySelector(":nth-child(2)"),b=d.querySelector(":nth-child(3) i"),s=d.querySelector(":nth-child(4) i");g.src=e.thumbnail,x.innerText=e.name,g.addEventListener("click",r(i,e)),b.addEventListener("click",r(t,e)),s.addEventListener("click",r(o,e)),n.append(d)})),e.modal()},q=e=>({name:e||`Bookmark${T}`,fractalSetId:c,juliaConstant:{...u},colourMapId:m,regionBottomLeft:{...y},regionTopRight:{...v},maxIterations:h}),Y=e=>{y.x=e.regionBottomLeft.x,y.y=e.regionBottomLeft.y,v.x=e.regionTopRight.x,v.y=e.regionTopRight.y,h=e.maxIterations,R(e.fractalSetId,e.juliaConstant,e.colourMapId)},J=e=>{localStorage.bookmarks=JSON.stringify(Array.from(e.entries()))};(async e=>{if(g=document.getElementById("canvas"),(e=>{x=e.getContext("webgl"),x||console.error("Failed to initialise WebGL")})(g),(()=>{const e=E()?"#version 300 es\nprecision highp float;\n\nin vec2 aVertexPosition;\nin vec2 aPlotPosition;\nuniform mat4 uModelViewMatrix;\nout vec2 vPosition;\n\nvoid main(void) {\n  gl_Position = uModelViewMatrix * vec4(aVertexPosition, 0, 1);\n  vPosition = aPlotPosition;\n}\n":"precision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aPlotPosition;\nuniform mat4 uModelViewMatrix;\nvarying vec2 vPosition;\n\nvoid main(void) {\n  gl_Position = uModelViewMatrix * vec4(aVertexPosition, 0, 1);\n  vPosition = aPlotPosition;\n}\n",n=E()?"#version 300 es\nprecision highp float;\n\n// Can't use @import anymore - I think it was a feature of the following\n// package which I am no longer using:\n// https://www.npmjs.com/package/webpack-glsl-loader\n// @import ./common;\n\nvec4 loop(int maxIterations, sampler2D colormap, vec2 z, vec2 c) {\n  int iteration = 0;\n  while (iteration < maxIterations) {\n    if (dot(z, z) >= 4.0) break;\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n    iteration++;\n  }\n  int s = 255 * iteration / maxIterations;\n  int t = 0;\n  ivec2 coord = ivec2(s, t);\n  int lod = 0;\n  return texelFetch(colormap, coord, lod);\n}\n\nuniform int uMaxIterations;\nuniform sampler2D uColormap;\nin vec2 vPosition;\nout vec4 fragColor;\n\nvoid main(void) {\n  vec2 z;\n  vec2 c = vPosition;\n  fragColor = loop(uMaxIterations, uColormap, z, c);\n}\n":"precision highp float;\n\n// Can't use @import anymore - I think it was a feature of the following\n// package which I am no longer using:\n// https://www.npmjs.com/package/webpack-glsl-loader\n// @import ./common;\n\n// Same value as INITIAL_ITERATIONS in constants.js\nconst int MAX_ITERATIONS = 128;\n\nvec4 loop(sampler2D colormap, vec2 z, vec2 c) {\n  int iteration = MAX_ITERATIONS;\n  for (int i = 0; i < MAX_ITERATIONS; i++) {\n    if (dot(z, z) >= 4.0) {\n      iteration = i;\n      break;\n    }\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n  }\n  float s = float(iteration) / float(MAX_ITERATIONS + 1);\n  float t = 0.0;\n  vec2 coord = vec2(s, t);\n  return texture2D(colormap, coord);\n}\n\nuniform sampler2D uColormap;\nvarying vec2 vPosition;\n\nvoid main(void) {\n  vec2 z;\n  vec2 c = vPosition;\n  gl_FragColor = loop(uColormap, z, c);\n}\n",r=E()?"#version 300 es\nprecision highp float;\n\n// Can't use @import anymore - I think it was a feature of the following\n// package which I am no longer using:\n// https://www.npmjs.com/package/webpack-glsl-loader\n// @import ./common;\n\nvec4 loop(int maxIterations, sampler2D colormap, vec2 z, vec2 c) {\n  int iteration = 0;\n  while (iteration < maxIterations) {\n    if (dot(z, z) >= 4.0) break;\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n    iteration++;\n  }\n  int s = 255 * iteration / maxIterations;\n  int t = 0;\n  ivec2 coord = ivec2(s, t);\n  int lod = 0;\n  return texelFetch(colormap, coord, lod);\n}\n\nuniform int uMaxIterations;\nuniform sampler2D uColormap;\nuniform vec2 uJuliaConstant;\nin vec2 vPosition;\nout vec4 fragColor;\n\nvoid main(void) {\n  vec2 z = vPosition;\n  vec2 c = uJuliaConstant;\n  fragColor = loop(uMaxIterations, uColormap, z, c);\n}\n":"precision highp float;\n\n// Can't use @import anymore - I think it was a feature of the following\n// package which I am no longer using:\n// https://www.npmjs.com/package/webpack-glsl-loader\n// @import ./common;\n\n// Same value as INITIAL_ITERATIONS in constants.js\nconst int MAX_ITERATIONS = 128;\n\nvec4 loop(sampler2D colormap, vec2 z, vec2 c) {\n  int iteration = MAX_ITERATIONS;\n  for (int i = 0; i < MAX_ITERATIONS; i++) {\n    if (dot(z, z) >= 4.0) {\n      iteration = i;\n      break;\n    }\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n  }\n  float s = float(iteration) / float(MAX_ITERATIONS + 1);\n  float t = 0.0;\n  vec2 coord = vec2(s, t);\n  return texture2D(colormap, coord);\n}\n\nuniform sampler2D uColormap;\nuniform vec2 uJuliaConstant;\nvarying vec2 vPosition;\n\nvoid main(void) {\n  vec2 z = vPosition;\n  vec2 c = uJuliaConstant;\n  gl_FragColor = loop(uColormap, z, c);\n}\n",i=S("Mandelbrot",e,n),t=S("Julia",e,r);b.set(0,i),b.set(1,t)})(),["jet","hsv","hot","cool","warm","spring","summer","autumn","winter","bone","copper","greys","YIOrRd","bluered","RdBu","picnic","rainbow","portland","blackbody","earth","electric","viridis","inferno","magma","plasma","rainbow-soft","bathymetry","cdom","chlorophyll","density","freesurface-blue","freesurface-red"].forEach(((e,n)=>{s.set(n,((e,n)=>{const r=o()({colormap:e,nshades:256,format:"float"}).flat();return((e,n)=>{const r=x.createTexture();x.activeTexture(x.TEXTURE0+n),x.bindTexture(x.TEXTURE_2D,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.NEAREST);const i=new Uint8Array(e.map((e=>255*e))),t=e.length/4;x.texImage2D(x.TEXTURE_2D,0,x.RGBA,t,1,0,x.RGBA,x.UNSIGNED_BYTE,i)})(r,n),{name:e,colourMap:r,textureUnit:n}})(e,n))})),window.addEventListener("resize",B),e)g.addEventListener("mousedown",N),g.addEventListener("mousemove",F),g.addEventListener("mouseup",U),g.addEventListener("mouseleave",D),document.addEventListener("keydown",j),k=new Map(JSON.parse(localStorage.bookmarks||"[]")),T=k.size?Math.max(...k.keys())+1:0,Y(I);else{C(I);const e=()=>{(e=>{const n=(v.x-y.x)/100*e,r=(v.y-y.y)/100*e;y.x-=n,y.y-=r,v.x-=n,v.y-=r})(.01),_(.01),P(),requestAnimationFrame(e)};e()}})("manual"===new URL(document.location).searchParams.get("mode"))})()})();
//# sourceMappingURL=bundle.js.map