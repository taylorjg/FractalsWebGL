(()=>{var t={440:t=>{t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},800:(t,e,n)=>{"use strict";var i=n(440),r=n(450);function o(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function s(t){for(var e,n="#",i=0;i<3;++i)n+=("00"+(e=(e=t[i]).toString(16))).substr(e.length);return n}function a(t){return"rgba("+t.join(",")+")"}t.exports=function(t){var e,n,d,c,u,g,l,h,b,m;if(t||(t={}),h=(t.nshades||72)-1,l=t.format||"hex",(g=t.colormap)||(g="jet"),"string"==typeof g){if(g=g.toLowerCase(),!i[g])throw Error(g+" not a supported colorscale");u=i[g]}else{if(!Array.isArray(g))throw Error("unsupported colormap option",g);u=g.slice()}if(u.length>h+1)throw new Error(g+" map requires nshades to be at least size "+u.length);b=Array.isArray(t.alpha)?2!==t.alpha.length?[1,1]:t.alpha.slice():"number"==typeof t.alpha?[t.alpha,t.alpha]:[1,1],e=u.map((function(t){return Math.round(t.index*h)})),b[0]=Math.min(Math.max(b[0],0),1),b[1]=Math.min(Math.max(b[1],0),1);var f=u.map((function(t,e){var n=u[e].index,i=u[e].rgb.slice();return 4===i.length&&i[3]>=0&&i[3]<=1||(i[3]=b[0]+(b[1]-b[0])*n),i})),p=[];for(m=0;m<e.length-1;++m){c=e[m+1]-e[m],n=f[m],d=f[m+1];for(var x=0;x<c;x++){var v=x/c;p.push([Math.round(r(n[0],d[0],v)),Math.round(r(n[1],d[1],v)),Math.round(r(n[2],d[2],v)),r(n[3],d[3],v)])}}return p.push(u[u.length-1].rgb.concat(b[1])),"hex"===l?p=p.map(s):"rgbaString"===l?p=p.map(a):"float"===l&&(p=p.map(o)),p}},450:t=>{t.exports=function(t,e,n){return t*(1-n)+e*n}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(800),e=n.n(t),i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});const r={toVector:(t,e)=>(void 0===t&&(t=e),Array.isArray(t)?t:[t,t]),add:(t,e)=>[t[0]+e[0],t[1]+e[1]],sub:(t,e)=>[t[0]-e[0],t[1]-e[1]],addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function o(t,e,n){return 0===e||Math.abs(e)===1/0?Math.pow(t,5*n):t*e*n/(e+n*t)}function s(t,e,n,i=.15){return 0===i?function(t,e,n){return Math.max(e,Math.min(t,n))}(t,e,n):t<e?-o(e-t,n-e,i)+e:t>n?+o(t-n,n-e,i)+n:t}function a(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const u={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function g(t){return t?t[0].toUpperCase()+t.slice(1):""}const l=["enter","leave"];const h=["gotpointercapture","lostpointercapture"];function b(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const i=h.includes(e)?"capturecapture":"capture",r=!!~e.indexOf(i);return r&&(e=e.replace("capture","")),{device:e,capture:r,passive:n}}function m(t){return"touches"in t}function f(t){return m(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function p(t){return m(t)?function(t){return"touchend"===t.type||"touchcancel"===t.type?t.changedTouches:t.targetTouches}(t)[0]:t}function x(t){const e=p(t);return m(t)?e.identifier:e.pointerId}function v(t){const e=p(t);return[e.clientX,e.clientY]}function y(t,...e){return"function"==typeof t?t(...e):t}function _(){}function w(...t){return 0===t.length?_:1===t.length?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function T(t,e){return Object.assign({},e,t||{})}class S{constructor(t,e,n){this.ctrl=t,this.args=e,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:e,ingKey:n,args:i}=this;e[n]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=i,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const e=this.state,n=this.config;e._active||(this.reset(),this.computeInitial(),e._active=!0,e.target=t.target,e.currentTarget=t.currentTarget,e.lastOffset=n.from?y(n.from,e):e.offset,e.offset=e.lastOffset,e.startTime=e.timeStamp=t.timeStamp)}computeValues(t){const e=this.state;e._values=t,e.values=this.config.transform(t)}computeInitial(){const t=this.state;t._initial=t._values,t.initial=t.values}compute(t){const{state:e,config:n,shared:i}=this;e.args=this.args;let o=0;if(t&&(e.event=t,n.preventDefault&&t.cancelable&&e.event.preventDefault(),e.type=t.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,function(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:i,metaKey:r,ctrlKey:o}=t;Object.assign(e,{shiftKey:n,altKey:i,metaKey:r,ctrlKey:o})}return e}(t)),i.down=i.pressed=i.buttons%2==1||i.touches>0,o=t.timeStamp-e.timeStamp,e.timeStamp=t.timeStamp,e.elapsedTime=e.timeStamp-e.startTime),e._active){const t=e._delta.map(Math.abs);r.addTo(e._distance,t)}this.axisIntent&&this.axisIntent(t);const[a,d]=e._movement,[c,u]=n.threshold,{_step:g,values:l}=e;if(n.hasCustomTransform?(!1===g[0]&&(g[0]=Math.abs(a)>=c&&l[0]),!1===g[1]&&(g[1]=Math.abs(d)>=u&&l[1])):(!1===g[0]&&(g[0]=Math.abs(a)>=c&&Math.sign(a)*c),!1===g[1]&&(g[1]=Math.abs(d)>=u&&Math.sign(d)*u)),e.intentional=!1!==g[0]||!1!==g[1],!e.intentional)return;const h=[0,0];if(n.hasCustomTransform){const[t,e]=l;h[0]=!1!==g[0]?t-g[0]:0,h[1]=!1!==g[1]?e-g[1]:0}else h[0]=!1!==g[0]?a-g[0]:0,h[1]=!1!==g[1]?d-g[1]:0;this.restrictToAxis&&!e._blocked&&this.restrictToAxis(h);const b=e.offset,m=e._active&&!e._blocked||e.active;m&&(e.first=e._active&&!e.active,e.last=!e._active&&e.active,e.active=i[this.ingKey]=e._active,t&&(e.first&&("bounds"in n&&(e._bounds=y(n.bounds,e)),this.setup&&this.setup()),e.movement=h,this.computeOffset()));const[f,p]=e.offset,[[x,v],[_,w]]=e._bounds;e.overflow=[f<x?-1:f>v?1:0,p<_?-1:p>w?1:0],e._movementBound[0]=!!e.overflow[0]&&(!1===e._movementBound[0]?e._movement[0]:e._movementBound[0]),e._movementBound[1]=!!e.overflow[1]&&(!1===e._movementBound[1]?e._movement[1]:e._movementBound[1]);const T=e._active&&n.rubberband||[0,0];if(e.offset=function(t,[e,n],[i,r]){const[[o,a],[d,c]]=t;return[s(e,o,a,i),s(n,d,c,r)]}(e._bounds,e.offset,T),e.delta=r.sub(e.offset,b),this.computeMovement(),m&&(!e.last||o>32)){e.delta=r.sub(e.offset,b);const t=e.delta.map(Math.abs);r.addTo(e.distance,t),e.direction=e.delta.map(Math.sign),e._direction=e._delta.map(Math.sign),!e.first&&o>0&&(e.velocity=[t[0]/o,t[1]/o],e.timeDelta=o)}}emit(){const t=this.state,e=this.shared,n=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!n.triggerAllEvents)return;const i=this.handler(c(c(c({},e),t),{},{[this.aliasKey]:t.values}));void 0!==i&&(t.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}class M extends S{constructor(...t){super(...t),a(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=r.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=r.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){const e=this.state,n=this.config;if(!e.axis&&t){const i="object"==typeof n.axisThreshold?n.axisThreshold[f(t)]:n.axisThreshold;e.axis=function([t,e],n){const i=Math.abs(t),r=Math.abs(e);return i>r&&i>n?"x":r>i&&r>n?"y":void 0}(e._movement,i)}e._blocked=(n.lockDirection||!!n.axis)&&!e.axis||!!n.axis&&n.axis!==e.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0}}}const R=t=>t,k={enabled:(t=!0)=>t,eventOptions:(t,e,n)=>c(c({},n.shared.eventOptions),t),preventDefault:(t=!1)=>t,triggerAllEvents:(t=!1)=>t,rubberband(t=0){switch(t){case!0:return[.15,.15];case!1:return[0,0];default:return r.toVector(t)}},from:t=>"function"==typeof t?t:null!=t?r.toVector(t):void 0,transform(t,e,n){const i=t||n.shared.transform;return this.hasCustomTransform=!!i,i||R},threshold:t=>r.toVector(t,0)},I=c(c({},k),{},{axis(t,e,{axis:n}){if(this.lockDirection="lock"===n,!this.lockDirection)return n},axisThreshold:(t=0)=>t,bounds(t={}){if("function"==typeof t)return e=>I.bounds(t(e));if("current"in t)return()=>t.current;if("function"==typeof HTMLElement&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:i=-1/0,bottom:r=1/0}=t;return[[e,n],[i,r]]}}),E={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]},A="undefined"!=typeof window&&window.document&&window.document.createElement;function C(){return A&&"ontouchstart"in window||A&&window.navigator.maxTouchPoints>1}const O={isBrowser:A,gesture:function(){try{return"constructor"in GestureEvent}catch(t){return!1}}(),touch:C(),touchscreen:C(),pointer:A&&"onpointerdown"in window,pointerLock:A&&"exitPointerLock"in window.document},P={mouse:0,touch:0,pen:8},L=c(c({},I),{},{device(t,e,{pointer:{touch:n=!1,lock:i=!1,mouse:r=!1}={}}){return this.pointerLock=i&&O.pointerLock,O.touch&&n?"touch":this.pointerLock?"mouse":O.pointer&&!r?"pointer":O.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay="number"==typeof n?n:n||void 0===n&&t?250:void 0,O.touchscreen&&!1!==n)return t||(void 0!==n?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:i=1,keys:r=!0}={}}){return this.pointerButtons=i,this.keys=r,!this.pointerLock&&"pointer"===this.device&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:i=3,axis:o}){const s=r.toVector(t,n?i:o?1:0);return this.filterTaps=n,this.tapsThreshold=i,s},swipe({velocity:t=.5,distance:e=50,duration:n=250}={}){return{velocity:this.transform(r.toVector(t)),distance:this.transform(r.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return 180;case!1:return 0;default:return t}},axisThreshold:t=>t?c(c({},P),t):P,keyboardDisplacement:(t=10)=>t});c(c({},k),{},{device(t,e,{shared:n,pointer:{touch:i=!1}={}}){if(n.target&&!O.touch&&O.gesture)return"gesture";if(O.touch&&i)return"touch";if(O.touchscreen){if(O.pointer)return"pointer";if(O.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:i={}}){const r=t=>{const e=T(y(n,t),{min:-1/0,max:1/0});return[e.min,e.max]},o=t=>{const e=T(y(i,t),{min:-1/0,max:1/0});return[e.min,e.max]};return"function"!=typeof n&&"function"!=typeof i?[r(),o()]:t=>[r(t),o(t)]},threshold(t,e,n){return this.lockDirection="lock"===n.axis,r.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey:t=>void 0===t?"ctrlKey":t,pinchOnWheel:(t=!0)=>t}),c(c({},I),{},{mouseOnly:(t=!0)=>t}),c(c({},I),{},{mouseOnly:(t=!0)=>t});const B=new Map,D=new Map,j={key:"drag",engine:class extends M{constructor(...t){super(...t),a(this,"ingKey","dragging")}reset(){super.reset();const t=this.state;t._pointerId=void 0,t._pointerActive=!1,t._keyboardActive=!1,t._preventScroll=!1,t._delayed=!1,t.swipe=[0,0],t.tap=!1,t.canceled=!1,t.cancel=this.cancel.bind(this)}setup(){const t=this.state;if(t._bounds instanceof HTMLElement){const e=t._bounds.getBoundingClientRect(),n=t.currentTarget.getBoundingClientRect(),i={left:e.left-n.left+t.offset[0],right:e.right-n.right+t.offset[0],top:e.top-n.top+t.offset[1],bottom:e.bottom-n.bottom+t.offset[1]};t._bounds=I.bounds(i)}}cancel(){const t=this.state;t.canceled||(t.canceled=!0,t._active=!1,setTimeout((()=>{this.compute(),this.emit()}),0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(t){const e=this.config,n=this.state;if(null!=t.buttons&&(Array.isArray(e.pointerButtons)?!e.pointerButtons.includes(t.buttons):-1!==e.pointerButtons&&e.pointerButtons!==t.buttons))return;const i=this.ctrl.setEventIds(t);e.pointerCapture&&t.target.setPointerCapture(t.pointerId),i&&i.size>1&&n._pointerActive||(this.start(t),this.setupPointer(t),n._pointerId=x(t),n._pointerActive=!0,this.computeValues(v(t)),this.computeInitial(),e.preventScrollAxis&&"mouse"!==f(t)?(n._active=!1,this.setupScrollPrevention(t)):e.delay>0?(this.setupDelayTrigger(t),e.triggerAllEvents&&(this.compute(t),this.emit())):this.startPointerDrag(t))}startPointerDrag(t){const e=this.state;e._active=!0,e._preventScroll=!0,e._delayed=!1,this.compute(t),this.emit()}pointerMove(t){const e=this.state,n=this.config;if(!e._pointerActive)return;if(e.type===t.type&&t.timeStamp===e.timeStamp)return;const i=x(t);if(void 0!==e._pointerId&&i!==e._pointerId)return;const o=v(t);return document.pointerLockElement===t.target?e._delta=[t.movementX,t.movementY]:(e._delta=r.sub(o,e._values),this.computeValues(o)),r.addTo(e._movement,e._delta),this.compute(t),e._delayed&&e.intentional?(this.timeoutStore.remove("dragDelay"),e.active=!1,void this.startPointerDrag(t)):n.preventScrollAxis&&!e._preventScroll?e.axis?e.axis===n.preventScrollAxis||"xy"===n.preventScrollAxis?(e._active=!1,void this.clean()):(this.timeoutStore.remove("startPointerDrag"),void this.startPointerDrag(t)):void 0:void this.emit()}pointerUp(t){this.ctrl.setEventIds(t);try{this.config.pointerCapture&&t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)}catch(t){}const e=this.state,n=this.config;if(!e._active||!e._pointerActive)return;const i=x(t);if(void 0!==e._pointerId&&i!==e._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(t);const[r,o]=e._distance;if(e.tap=r<=n.tapsThreshold&&o<=n.tapsThreshold,e.tap&&n.filterTaps)e._force=!0;else{const[t,i]=e._delta,[r,o]=e._movement,[s,a]=n.swipe.velocity,[d,c]=n.swipe.distance,u=n.swipe.duration;if(e.elapsedTime<u){const n=Math.abs(t/e.timeDelta),u=Math.abs(i/e.timeDelta);n>s&&Math.abs(r)>d&&(e.swipe[0]=Math.sign(t)),u>a&&Math.abs(o)>c&&(e.swipe[1]=Math.sign(i))}}this.emit()}pointerClick(t){!this.state.tap&&t.detail>0&&(t.preventDefault(),t.stopPropagation())}setupPointer(t){const e=this.config,n=e.device;e.pointerLock&&t.currentTarget.requestPointerLock(),e.pointerCapture||(this.eventStore.add(this.sharedConfig.window,n,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(t){this.state._preventScroll&&t.cancelable&&t.preventDefault()}setupScrollPrevention(t){this.state._preventScroll=!1,function(t){"persist"in t&&"function"==typeof t.persist&&t.persist()}(t);const e=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",e),this.eventStore.add(this.sharedConfig.window,"touch","cancel",e),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,t)}setupDelayTrigger(t){this.state._delayed=!0,this.timeoutStore.add("dragDelay",(()=>{this.state._step=[0,0],this.startPointerDrag(t)}),this.config.delay)}keyDown(t){const e=E[t.key];if(e){const n=this.state,i=t.shiftKey?10:t.altKey?.1:1;this.start(t),n._delta=e(this.config.keyboardDisplacement,i),n._keyboardActive=!0,r.addTo(n._movement,n._delta),this.compute(t),this.emit()}}keyUp(t){t.key in E&&(this.state._keyboardActive=!1,this.setActive(),this.compute(t),this.emit())}bind(t){const e=this.config.device;t(e,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(t(e,"change",this.pointerMove.bind(this)),t(e,"end",this.pointerUp.bind(this)),t(e,"cancel",this.pointerUp.bind(this)),t("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(t("key","down",this.keyDown.bind(this)),t("key","up",this.keyUp.bind(this))),this.config.filterTaps&&t("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},resolver:L};const U={target(t){if(t)return()=>"current"in t?t.current:t},enabled:(t=!0)=>t,window:(t=(O.isBrowser?window:void 0))=>t,eventOptions:({passive:t=!0,capture:e=!1}={})=>({passive:t,capture:e}),transform:t=>t},z=["target","eventOptions","window","enabled","transform"];function X(t={},e){const n={};for(const[i,r]of Object.entries(e))switch(typeof r){case"function":n[i]=r.call(n,t[i],i,t);break;case"object":n[i]=X(t[i],r);break;case"boolean":r&&(n[i]=t[i])}return n}class F{constructor(t,e){a(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=e}add(t,e,n,i,r){const o=this._listeners,s=function(t,e=""){const n=u[t];return t+(n&&n[e]||e)}(e,n),a=c(c({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),r);t.addEventListener(s,i,a);const d=()=>{t.removeEventListener(s,i,a),o.delete(d)};return o.add(d),d}clean(){this._listeners.forEach((t=>t())),this._listeners.clear()}}class Y{constructor(){a(this,"_timeouts",new Map)}add(t,e,n=140,...i){this.remove(t),this._timeouts.set(t,window.setTimeout(e,n,...i))}remove(t){const e=this._timeouts.get(t);e&&window.clearTimeout(e)}clean(){this._timeouts.forEach((t=>{window.clearTimeout(t)})),this._timeouts.clear()}}class N{constructor(t){var e,n;a(this,"gestures",new Set),a(this,"_targetEventStore",new F(this)),a(this,"gestureEventStores",{}),a(this,"gestureTimeoutStores",{}),a(this,"handlers",{}),a(this,"config",{}),a(this,"pointerIds",new Set),a(this,"touchIds",new Set),a(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),e=this,(n=t).drag&&K(e,"drag"),n.wheel&&K(e,"wheel"),n.scroll&&K(e,"scroll"),n.move&&K(e,"move"),n.pinch&&K(e,"pinch"),n.hover&&K(e,"hover")}setEventIds(t){return m(t)?(this.touchIds=new Set(function(t){return function(t){return Array.from(t.touches).filter((e=>{var n,i;return e.target===t.currentTarget||(null===(n=t.currentTarget)||void 0===n||null===(i=n.contains)||void 0===i?void 0:i.call(n,e.target))}))}(t).map((t=>t.identifier))}(t)),this.touchIds):"pointerId"in t?("pointerup"===t.type||"pointercancel"===t.type?this.pointerIds.delete(t.pointerId):"pointerdown"===t.type&&this.pointerIds.add(t.pointerId),this.pointerIds):void 0}applyHandlers(t,e){this.handlers=t,this.nativeHandlers=e}applyConfig(t,e){this.config=function(t,e,n={}){const i=t,{target:r,eventOptions:o,window:s,enabled:a,transform:d}=i,u=function(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}(i,z);if(n.shared=X({target:r,eventOptions:o,window:s,enabled:a,transform:d},U),e){const t=D.get(e);n[e]=X(c({shared:n.shared},u),t)}else for(const t in u){const e=D.get(t);e&&(n[t]=X(c({shared:n.shared},u[t]),e))}return n}(t,e,this.config)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const e=this.config.shared,n={};let i;if(!e.target||(i=e.target(),i)){if(e.enabled){for(const e of this.gestures){const r=this.config[e],o=V(n,r.eventOptions,!!i);r.enabled&&new(B.get(e))(this,t,e).bind(o)}const r=V(n,e.eventOptions,!!i);for(const e in this.nativeHandlers)r(e,"",(n=>this.nativeHandlers[e](c(c({},this.state.shared),{},{event:n,args:t}))),void 0,!0)}for(const t in n)n[t]=w(...n[t]);if(!i)return n;for(const t in n){const{device:e,capture:r,passive:o}=b(t);this._targetEventStore.add(i,e,"",n[t],{capture:r,passive:o})}}}}function K(t,e){t.gestures.add(e),t.gestureEventStores[e]=new F(t,e),t.gestureTimeoutStores[e]=new Y}const V=(t,e,n)=>(i,r,o,s={},a=!1)=>{var d,c;const h=null!==(d=s.capture)&&void 0!==d?d:e.capture,b=null!==(c=s.passive)&&void 0!==c?c:e.passive;let m=a?i:function(t,e="",n=!1){const i=u[t],r=i&&i[e]||e;return"on"+g(t)+g(r)+(function(t=!1,e){return t&&!l.includes(e)}(n,r)?"Capture":"")}(i,r,h);n&&b&&(m+="Passive"),t[m]=t[m]||[],t[m].push(o)};function H(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach((function(e){H(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}class q{constructor(t,e,n,i,r){this._target=t,this._gestureKey=i,this._ctrl=new N(e),this._ctrl.applyHandlers(e,r),this._ctrl.applyConfig(W(W({},n),{},{target:t}),i),this._ctrl.effect()}destroy(){this._ctrl.clean()}setConfig(t){this._ctrl.clean(),this._ctrl.applyConfig(W(W({},t),{},{target:this._target}),this._gestureKey),this._ctrl.effect()}}const J=function(t,e,n){var i;return i=j,B.set(i.key,i.engine),D.set(i.key,i.resolver),new q(t,{drag:e},n||{},"drag")};class Z{constructor(){this._bottomLeft={x:0,y:0},this._topRight={x:0,y:0}}get top(){return this._topRight.y}get bottom(){return this._bottomLeft.y}get left(){return this._bottomLeft.x}get right(){return this._topRight.x}get topLeft(){return{x:this.left,y:this.top}}get topRight(){return{...this._topRight}}get bottomLeft(){return{...this._bottomLeft}}get bottomRight(){return{x:this.right,y:this.bottom}}get width(){return this._topRight.x-this._bottomLeft.x}get height(){return this.topRight.y-this._bottomLeft.y}get centreX(){return this.left+this.width/2}get centreY(){return this.bottom+this.height/2}set(t,e){this._bottomLeft.x=t.x,this._bottomLeft.y=t.y,this._topRight.x=e.x,this._topRight.y=e.y}adjustAspectRatio(t,e){if(t>=e){const n=(t/e*this.height-this.width)/2;this._bottomLeft.x-=n,this._topRight.x+=n}if(t<e){const n=(e/t*this.width-this.height)/2;this._bottomLeft.y-=n,this._topRight.y+=n}}mouseToRegion(t,e,n){const i=e*(this.width/t.width),r=n*(this.height/t.height);return{regionMouseX:this.left+i,regionMouseY:this.bottom+r}}drag(t,e,n){const i=e*(this.width/t.width),r=n*(this.height/t.height);this._bottomLeft.x-=i,this._bottomLeft.y-=r,this._topRight.x-=i,this._topRight.y-=r}recentre(t,e){const n=t-this.centreX,i=e-this.centreY;this._bottomLeft.x+=n,this._bottomLeft.y+=i,this._topRight.x+=n,this._topRight.y+=i}panX(t){const e=this.width/100*t;this._bottomLeft.x-=e,this._topRight.x-=e}panY(t){const e=this.height/100*t;this._bottomLeft.y-=e,this._topRight.y-=e}zoom(t){const e=this.width/100*t/2,n=this.height/100*t/2;this._bottomLeft.x+=e,this._bottomLeft.y+=n,this._topRight.x-=e,this._topRight.y-=n}}const Q=(t,e)=>Math.random()*(e-t)+t,tt=(t,e)=>Math.floor(Q(t,e)),et=t=>t[tt(0,t.length)],nt=()=>Q(-.1,.1),it=()=>Q(.01,1),rt=(t,e,n,i)=>{e.width=n,e.height=i;const r=e.getContext("2d"),o=new ImageData(t,n,i);r.putImageData(o,0,0),r.scale(1,-1),r.translate(0,-i),r.drawImage(e,0,0)},ot=["jet","hsv","hot","cool","warm","spring","summer","autumn","winter","bone","copper","greys","YIOrRd","bluered","RdBu","picnic","rainbow","portland","blackbody","earth","electric","viridis","inferno","magma","plasma","rainbow-soft","bathymetry","cdom","chlorophyll","density","freesurface-blue"],st={fractalSetId:0,juliaConstant:{x:0,y:0},colourMapId:0,regionBottomLeft:{x:-.22,y:-.7},regionTopRight:{x:-.21,y:-.69},maxIterations:128},at={fractalSetId:0,juliaConstant:{x:0,y:0},colourMapId:0,regionBottomLeft:{x:-2.25,y:-1.5},regionTopRight:{x:.75,y:1.5},maxIterations:128},dt=64;let ct,ut,gt,lt,ht,bt,mt,ft=!1;const pt=new Map,xt=new Map;let vt,yt,_t,wt,Tt,St=128;const Mt=new Z;let Rt,kt,It,Et,At=0,Ct=0,Ot=0,Pt=!1,Lt=!1,Bt=!1,Dt=new Map,jt=0,Ut=!1,zt=!1,Xt=!0,Ft=0;const Yt=()=>{Ut=!0},Nt=()=>{Ut=!1},Kt=t=>{localStorage.bookmarks=JSON.stringify(Array.from(t.entries()))},$t=t=>{t.id=jt++,Dt.set(t.id,t),Kt(Dt)},Vt=t=>{Dt.set(t.id,t),Kt(Dt)},Ht=t=>{Dt.delete(t.id),Kt(Dt)},Gt=t=>({name:t||`Bookmark${jt}`,fractalSetId:vt,juliaConstant:{..._t},colourMapId:wt,regionBottomLeft:{...Mt.bottomLeft},regionTopRight:{...Mt.topRight},maxIterations:St}),Wt=t=>{ee(t)},qt="webgl",Jt="webgl2",Zt=["experimental-webgl",qt,Jt],Qt=(t,e,n,i)=>{const r=((t,e)=>{if((null==e?void 0:e.length)>0){const n=t.indexOf("// INSERT-COMMON-CODE-HERE\n");if(n>=0){const i=n+27,r=e.join("\n");return t.substring(0,i)+r+t.substring(i)}}return t})(e,i),o=t.createShader(n);if(t.shaderSource(o,r),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(o);return console.error(`Failed to compile shader: ${e}`),null}return o},te=(t,e,n)=>{const i=ft?["const int COLOUR_MAP_SIZE = 256;\n\nuniform int uSmoothColouring;\nuniform int uReturnIteration;\n\nvec4 loop(int maxIterations, sampler2D colourMap, vec2 z, vec2 c) {\n  int iteration = 0;\n  while (iteration < maxIterations) {\n    if (dot(z, z) >= 4.0) break;\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n    iteration++;\n  }\n\n  if (uReturnIteration > 0) {\n    int hi = (iteration & 0xff00) >> 8;\n    int lo = iteration & 0xff;\n    float hif = float(hi) / 255.0;\n    float lof = float(lo) / 255.0;\n    return vec4(lof, hif, 0.0, 1.0);\n  } else {\n    float possiblySmoothedIteration = uSmoothColouring > 0\n      ? float(iteration) - clamp(log(log(length(z))) / log(2.0), -1.0, 1.0)\n      : float(iteration);\n\n    float s = possiblySmoothedIteration / float(maxIterations);\n    float t = 0.5;\n    vec2 textureCoords = vec2(s, t);\n    return texture(colourMap, textureCoords);\n  }\n}\n"]:["// Same value as INITIAL_ITERATIONS in constants.js\nconst int MAX_ITERATIONS = 128;\n\nconst int COLOUR_MAP_SIZE = 256;\n\nuniform int uSmoothColouring;\nuniform int uReturnIteration;\n\nvec4 loop(sampler2D colourMap, vec2 z, vec2 c) {\n  int iteration = MAX_ITERATIONS;\n  for (int i = 0; i < MAX_ITERATIONS; i++) {\n    if (dot(z, z) >= 4.0) {\n      iteration = i;\n      break;\n    }\n    vec2 zSquared = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y);\n    z = zSquared + c;\n  }\n\n  if (uReturnIteration > 0) {\n    int hi = (iteration & 0xff00) >> 8;\n    int lo = iteration & 0xff;\n    float hif = float(hi) / 255.0;\n    float lof = float(lo) / 255.0;\n    return vec4(lof, hif, 0.0, 1.0);\n  } else {\n    // http://linas.org/art-gallery/escape/escape.html\n    float possiblySmoothedIteration = uSmoothColouring > 0\n      ? float(iteration) - clamp(log(log(length(z))) / log(2.0), -1.0, 1.0)\n      : float(iteration);\n\n    float s = possiblySmoothedIteration / float(MAX_ITERATIONS);\n    float t = 0.5;\n    vec2 textureCoords = vec2(s, t);\n    return texture2D(colourMap, textureCoords);\n  }\n}\n"],r=Qt(bt,e,bt.VERTEX_SHADER),o=Qt(bt,n,bt.FRAGMENT_SHADER,i),s=bt.createProgram();if(bt.attachShader(s,r),bt.attachShader(s,o),bt.linkProgram(s),!bt.getProgramParameter(s,bt.LINK_STATUS)){const t=bt.getProgramInfoLog(s);return void console.error(`Failed to link program: ${t}`)}if(bt.validateProgram(s),!bt.getProgramParameter(s,bt.VALIDATE_STATUS)){const t=bt.getProgramInfoLog(s);return void console.error(`Failed to validate program: ${t}`)}const a=bt.getAttribLocation(s,"aVertexPosition");bt.enableVertexAttribArray(a);const d=bt.getAttribLocation(s,"aRegionPosition");bt.enableVertexAttribArray(d);const c=bt.createBuffer();bt.bindBuffer(bt.ARRAY_BUFFER,c),bt.bufferData(bt.ARRAY_BUFFER,32,bt.DYNAMIC_DRAW);const u=bt.getUniformLocation(s,"uModelViewMatrix"),g=bt.getUniformLocation(s,"uColourMap"),l=bt.getUniformLocation(s,"uJuliaConstant"),h=bt.getUniformLocation(s,"uSmoothColouring"),b=bt.getUniformLocation(s,"uReturnIteration"),m=ft?{uMaxIterations:bt.getUniformLocation(s,"uMaxIterations")}:void 0,f=new Float32Array([1,1,-1,1,1,-1,-1,-1]),p=bt.createBuffer();return bt.bindBuffer(bt.ARRAY_BUFFER,p),bt.bufferData(bt.ARRAY_BUFFER,f,bt.STATIC_DRAW),bt.vertexAttribPointer(a,2,bt.FLOAT,!1,0,0),{name:t,program:s,aVertexPosition:a,aRegionPosition:d,uModelViewMatrix:u,...m,uColourMap:g,uJuliaConstant:l,uSmoothColouring:h,uReturnIteration:b,vertexPositionBuffer:p,regionPositionBuffer:c}},ee=t=>{let{fractalSetId:e,juliaConstant:n,colourMapId:r,maxIterations:o,regionBottomLeft:s,regionTopRight:a}=t;s&&a&&ne((()=>{Mt.set(s,a)})),Number.isInteger(e)&&(vt=e,yt=pt.get(e)),n&&(_t=n),Number.isInteger(r)&&(wt=r,Tt=xt.get(r)),ft&&Number.isInteger(o)&&(St=o),bt.useProgram(yt.program);const d=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}((c=new i(16),i!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c),[1,-1,1]);var c;bt.uniformMatrix4fv(yt.uModelViewMatrix,!1,d),bt.uniform1i(yt.uColourMap,Tt.textureUnit),bt.uniform2f(yt.uJuliaConstant,_t.x,_t.y),bt.uniform1i(yt.uSmoothColouring,Xt),bt.uniform1i(yt.uReturnIteration,!1),ft&&bt.uniform1i(yt.uMaxIterations,St)},ne=t=>{t(),(()=>{if(!yt)return;const{regionPositionBuffer:t,aRegionPosition:e}=yt,n=new Float32Array([Mt.topRight.x,Mt.topRight.y,Mt.topLeft.x,Mt.topLeft.y,Mt.bottomRight.x,Mt.bottomRight.y,Mt.bottomLeft.x,Mt.bottomLeft.y]);bt.bindBuffer(bt.ARRAY_BUFFER,t),bt.bufferData(bt.ARRAY_BUFFER,n,bt.DYNAMIC_DRAW),bt.vertexAttribPointer(e,2,bt.FLOAT,!1,0,0),bt.bindBuffer(bt.ARRAY_BUFFER,null)})()},ie=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&bt.uniform1i(yt.uReturnIteration,!0),bt.drawArrays(bt.TRIANGLE_STRIP,0,4),t&&bt.uniform1i(yt.uReturnIteration,!1),ct.manualMode&&be()},re=async t=>{const e=t??Et;e&&(t||(console.log("[displayConfiguration]","nextConfigurationCount:",Ft),Et=void 0,Ft=0),Wt(e),oe(),be(e),At=e.panSpeedX??nt(),Ct=e.panSpeedY??nt(),Ot=e.zoomSpeed??it()),setTimeout(re,1e4)},oe=(t,e)=>{const n=t??ut.clientWidth,i=e??ut.clientHeight;t||e||(ut.width=n,ut.height=i,gt.setSize(n,i)),bt.viewport(0,0,n,i),ne((()=>{Mt.adjustAspectRatio(n,i)}))},se=()=>{oe(),ie()},ae=t=>{const e=t.offsetX,n=t.offsetY,{regionMouseX:i,regionMouseY:r}=Mt.mouseToRegion(ut,e,n);if(t.metaKey)return Lt=!0,Rt={mouseX:e,mouseY:n},void(kt={mouseX:e,mouseY:n});if(t.shiftKey)return ne((()=>{Mt.recentre(i,r)})),ie();if(t.altKey)switch(vt){case 0:return ee({fractalSetId:1,juliaConstant:{x:i,y:r}}),void ie();case 1:return ee({fractalSetId:0}),void ie();default:return}Pt=!0,It={mouseX:e,mouseY:n}},de=t=>{const e=t.offsetX,n=t.offsetY;return Pt?(ne((()=>{const t=e-It.mouseX,i=n-It.mouseY;Mt.drag(ut,t,i)})),ie(),void(It={mouseX:e,mouseY:n})):Lt?(kt={mouseX:e,mouseY:n},void gt.drawSelectionRegion(Rt.mouseX,Rt.mouseY,kt.mouseX,kt.mouseY)):void 0},ce=()=>{if(Pt=!1,Lt){const t=Rt,e=kt,n=Math.max(t.mouseY,e.mouseY),i=Math.min(t.mouseY,e.mouseY),r=Math.min(t.mouseX,e.mouseX),o=Math.max(t.mouseX,e.mouseX),s=Mt.mouseToRegion(ut,r,i),a=Mt.mouseToRegion(ut,o,n),d={x:s.regionMouseX,y:s.regionMouseY},c={x:a.regionMouseX,y:a.regionMouseY};ne((()=>{Mt.set(d,c)})),oe(),ie(),gt.clearSelectionRegion(),Lt=!1}},ue=()=>{Pt&&(Pt=!1),Lt&&(gt.clearSelectionRegion(),Rt=void 0,kt=void 0,Lt=!1)},ge=t=>{if(!Ut){if(Bt)return me(t);if(Bt||"b"!==t.key||!t.ctrlKey){if("+"===t.key)return ne((()=>{Mt.zoom(50)})),void ie();if("-"===t.key)return ne((()=>{Mt.zoom(-100)})),void ie();if("h"===t.key)return Wt(at),oe(),void ie();if("c"===t.key||"C"===t.key){const e=Array.from(xt.keys()),n=e.length,i=e.indexOf(wt),r=e[(i+(t.shiftKey?n-1:1))%n];return ee({colourMapId:r}),void ie()}if(ft&&("i"===t.key||"I"===t.key)){const n=16*(t.shiftKey?-1:1);return 16,4096,e=St+n,St=Math.max(16,Math.min(4096,e)),ee({maxIterations:St}),void ie()}var e;"s"===t.key&&(Xt=!Xt,ee({}),ie()),"v"===t.key&&(zt?le():he())}else Bt=!0}},le=()=>{gt.hideConfigurationSummary(),zt=!1},he=()=>{const t=Gt();gt.showConfigurationSummary(t),zt=!0},be=()=>{const t=Gt();gt.updateConfigurationSummary(t)},me=t=>{if(Bt=!1,"n"===t.key){const t=Gt();return mt.presentBookmarkModal(t)}if("l"===t.key)return mt.presentManageBookmarksModal(Dt)},fe=new URL(document.location);var pe;(async t=>{ct=t,ut=document.getElementById("canvas"),(t=>{const e=e=>{try{bt=t.getContext(e),bt||console.log(`Failed to initialise WebGL (contextType: ${e})`)}catch(t){alert(`Exception trying to initialise WebGL (contextType: ${e})\n${t.message}`)}const n=Boolean(bt);return n&&e===Jt&&(ft=!0),n},n=Zt.includes(ct.contextType)?ct.contextType:Jt;e(n)||n!==qt&&e(qt)})(ut),(()=>{const t=ft?"#version 300 es\nprecision highp float;\n\nin vec2 aVertexPosition;\nin vec2 aRegionPosition;\nuniform mat4 uModelViewMatrix;\nout vec2 vRegionPosition;\n\nvoid main(void) {\n  gl_Position = uModelViewMatrix * vec4(aVertexPosition, 0, 1);\n  vRegionPosition = aRegionPosition;\n}\n":"precision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aRegionPosition;\nuniform mat4 uModelViewMatrix;\nvarying vec2 vRegionPosition;\n\nvoid main(void) {\n  gl_Position = uModelViewMatrix * vec4(aVertexPosition, 0, 1);\n  vRegionPosition = aRegionPosition;\n}\n",e=ft?"#version 300 es\nprecision highp float;\n\n// INSERT-COMMON-CODE-HERE\n\nuniform int uMaxIterations;\nuniform sampler2D uColourMap;\nuniform vec2 uJuliaConstant;\nin vec2 vRegionPosition;\nout vec4 fragColor;\n\nvoid main(void) {\n  vec2 z = vRegionPosition;\n  vec2 c = uJuliaConstant;\n  fragColor = loop(uMaxIterations, uColourMap, z, c);\n}\n":"precision highp float;\n\n// INSERT-COMMON-CODE-HERE\n\nuniform sampler2D uColourMap;\nuniform vec2 uJuliaConstant;\nvarying vec2 vRegionPosition;\n\nvoid main(void) {\n  vec2 z = vRegionPosition;\n  vec2 c = uJuliaConstant;\n  gl_FragColor = loop(uColourMap, z, c);\n}\n",n=te("Mandelbrot",t,ft?"#version 300 es\nprecision highp float;\n\n// INSERT-COMMON-CODE-HERE\n\nuniform int uMaxIterations;\nuniform sampler2D uColourMap;\nin vec2 vRegionPosition;\nout vec4 fragColor;\n\nvoid main(void) {\n  vec2 z;\n  vec2 c = vRegionPosition;\n  fragColor = loop(uMaxIterations, uColourMap, z, c);\n}\n":"precision highp float;\n\n// INSERT-COMMON-CODE-HERE\n\nuniform sampler2D uColourMap;\nvarying vec2 vRegionPosition;\n\nvoid main(void) {\n  vec2 z;\n  vec2 c = vRegionPosition;\n  gl_FragColor = loop(uColourMap, z, c);\n}\n"),i=te("Julia",t,e);pt.set(0,n),pt.set(1,i)})(),ot.forEach(((t,n)=>{xt.set(n,((t,n)=>{const i=e()({colormap:t,nshades:256,format:"float"}).flat();return((t,e)=>{const n=bt.createTexture();bt.activeTexture(bt.TEXTURE0+e),bt.bindTexture(bt.TEXTURE_2D,n),bt.texParameteri(bt.TEXTURE_2D,bt.TEXTURE_WRAP_S,bt.CLAMP_TO_EDGE),bt.texParameteri(bt.TEXTURE_2D,bt.TEXTURE_WRAP_T,bt.CLAMP_TO_EDGE),bt.texParameteri(bt.TEXTURE_2D,bt.TEXTURE_MIN_FILTER,bt.LINEAR),bt.texParameteri(bt.TEXTURE_2D,bt.TEXTURE_MAG_FILTER,bt.LINEAR);const i=new Uint8Array(t.map((t=>255*t))),r=t.length/4;bt.texImage2D(bt.TEXTURE_2D,0,bt.RGBA,r,1,0,bt.RGBA,bt.UNSIGNED_BYTE,i)})(i,n),{name:t,colourMap:i,textureUnit:n}})(t,n))})),gt=(t=>{let{fractalSets:e,colourMaps:n}=t;const i=document.getElementById("canvasOverlay"),r=i.getContext("2d"),o=document.getElementById("divOverlay"),s=document.getElementById("configurationSummary");let a,d=!1;const c=()=>{r.clearRect(0,0,i.width,i.height)},u=t=>{let{x:e,y:n}=t;return`(${e}, ${n})`},g=t=>{var i,r;const o=1===t.fractalSetId?u(t.juliaConstant):"",a=`${u(t.regionBottomLeft)}, ${u(t.regionTopRight)}`,d=[(null===(i=e.get(t.fractalSetId))||void 0===i?void 0:i.name)??"unknown",o,a,(null===(r=n.get(t.colourMapId))||void 0===r?void 0:r.name)??"unknown",t.maxIterations];s.innerText=d.filter(Boolean).join(" | ")},l=()=>{s.style.display="block"},h=()=>{s.style.display="none"},b=()=>{clearTimeout(a),a=void 0};return{setSize:(t,e)=>{i.width=t,i.height=e,o.width=t,o.height=e},drawSelectionRegion:(t,e,n,i)=>{c();const o=Math.max(e,i),s=Math.min(e,i),a=Math.min(t,n),d=Math.max(t,n)-a,u=o-s;r.lineWidth=2,r.strokeStyle="#FFFFFF80",r.strokeRect(a,s,d,u)},clearSelectionRegion:c,showConfigurationSummary:t=>{g(t),l(),b(),d=!0},hideConfigurationSummary:()=>{h(),b(),d=!1},updateConfigurationSummary:t=>{g(t),d||(l(),b(),a=setTimeout((()=>{h(),a=void 0}),5e3))}}})({fractalSets:pt,colourMaps:xt}),lt=(t=>{let{gl:e,createBookmark:n,switchToBookmark:i,setCanvasAndViewportSize:r,render:o}=t;return{renderThumbnail:(t,s,a,d)=>{const c=e.createTexture();e.activeTexture(e.TEXTURE0+ot.length),e.bindTexture(e.TEXTURE_2D,c),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,s,0,e.RGBA,e.UNSIGNED_BYTE,null);const u=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,u),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,c,0);const g=n("saved-configuration");i(a),r(t,s),o(d);const l=new Uint8ClampedArray(t*s*4);return e.readPixels(0,0,t,s,e.RGBA,e.UNSIGNED_BYTE,l),i(g),r(),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(u),e.bindTexture(e.TEXTURE_2D,null),e.deleteTexture(c),l}}})({gl:bt,createBookmark:Gt,switchToBookmark:Wt,setCanvasAndViewportSize:oe,render:ie});const n=Array.from(pt.keys()),i=Array.from(xt.keys());if(ht=(t=>{let{renderThumbnail:e,fractalSetIds:n,colourMapIds:i,preview:r}=t;const o=document.getElementById("canvas"),s=document.getElementById("preview-panel"),a=document.getElementById("preview-initial"),d=document.getElementById("preview-final"),c=(t,n,i,r)=>{const o=e(n,i,t,!0),s=new Set;for(let t=0;t<o.length;t+=4){const e=o[t]+(o[t+1]<<8);s.add(e)}const a=Array.from(s).length,d=t.maxIterations,c=.6*d,u=a>=c;if(u){const t={type:r,numUniqueIterationValues:a,threshold:c,maxIterations:d};console.log("[configureConfigurationChooser]",JSON.stringify(t,null,2))}return u};return{chooseConfiguration:t=>{const u=(()=>{const t=et(n),e=et(i),r=Q(-2,.75),o=Q(-1.5,1.5),s=Q(.01,.5);return{fractalSetId:t,juliaConstant:{x:r,y:o},colourMapId:e,regionBottomLeft:{x:r-s,y:o-s},regionTopRight:{x:r+s,y:o+s},maxIterations:tt(32,1024),panSpeedX:nt(),panSpeedY:nt(),zoomSpeed:it()}})(),g=o.clientWidth/o.clientHeight,l=new Z;l.set(u.regionBottomLeft,u.regionTopRight),l.adjustAspectRatio(o.clientWidth,o.clientHeight),u.regionBottomLeft=l.bottomLeft,u.regionTopRight=l.topRight;const h=64,b=Math.round(64/g);if(c(u,h,b,"initial")){const n=((t,e)=>{const n=60*e,i=new Z;i.set(t.regionBottomLeft,t.regionTopRight);for(let e=0;e<n;e++)i.panX(t.panSpeedX),i.panY(t.panSpeedY),i.zoom(t.zoomSpeed);return{...t,regionBottomLeft:i.bottomLeft,regionTopRight:i.topRight}})(u,t);if(c(n,h,b,"final")){if(r){s.style.visibility="visible";const t=e(h,b,u),i=e(h,b,n);rt(t,a,h,b),rt(i,d,h,b)}return u}}}}})({renderThumbnail:lt.renderThumbnail,fractalSetIds:n,colourMapIds:i,preview:ct.preview}),mt=(t=>{let{isWebGL2:e,renderThumbnail:n,addBookmark:i,updateBookmark:r,deleteBookmark:o,switchToBookmark:s,fractalSets:a,colourMaps:d,onModalOpen:c,onModalClose:u}=t;const g=t=>{console.log("[presentBookmarkModal]","bookmark:",t);const o=$("#bookmarkModal").on("show.bs.modal",c).on("hide.bs.modal",u),s=Number.isInteger(t.id),g=s?"Edit Bookmark":"Create Bookmark";$(".modal-title",o).text(g),$('input[type="submit"]',o).off("click").on("click",(e=>{e.preventDefault(),t.name=$("#name",o).val(),s?r(t):i(t),o.modal("hide")}));const l=$("#thumbnail-canvas",o).get(0),h=n(dt,dt,t);rt(h,l,dt,dt),$("#name",o).val(t.name).focus(),$(".fractal-set",o).text(a.get(t.fractalSetId).name);const b=$("#colour-map-select",o).empty();for(const[e,n]of d){const i=e===t.colourMapId?"selected":"";b.append(`<option value="${e}" ${i}>${n.name}</option>`)}b.on("change",(e=>{t.colourMapId=Number(e.target.value);const i=n(dt,dt,t);rt(i,l,dt,dt)}));const m=$("#max-iterations",o);m.text(t.maxIterations);const f=$("#max-iterations-range",o);e?(f.attr("min",16).attr("max",4096).attr("step",16).val(t.maxIterations),f.on("input",(e=>{t.maxIterations=Number(e.target.value),m.text(t.maxIterations);const i=n(dt,dt,t);rt(i,l,dt,dt)}))):f.hide(),$(".region-bottom-left",o).text(`(${t.regionBottomLeft.x}, ${t.regionBottomLeft.y})`),$(".region-top-right",o).text(`(${t.regionTopRight.x}, ${t.regionTopRight.y})`);const p=$(".julia-constant",o),x=p.closest("div");1===t.fractalSetId?(p.text(`(${t.juliaConstant.x}, ${t.juliaConstant.y})`),x.show()):x.hide(),o.modal()};return{presentBookmarkModal:g,presentManageBookmarksModal:t=>{console.log("[presentManageBookmarksModal]","bookmarks:",t);const e=$("#manageBookmarksModal").on("show.bs.modal",c).on("hide.bs.modal",u),i=$("tbody",e).empty(),r=(t,n)=>()=>{e.modal("hide"),t(n)},a=t=>s(t),d=t=>{const e={...t};g(e)},l=t=>{o(t)},h=document.getElementById("bookmark-row-template");t.forEach((t=>{const e=document.importNode(h.content,!0),o=e.querySelector(":nth-child(2)"),s=e.querySelector(":nth-child(3) i"),c=e.querySelector(":nth-child(4) i"),u=e.querySelector(":nth-child(1) canvas"),g=n(dt,dt,t);rt(g,u,dt,dt),o.innerText=t.name,u.addEventListener("click",r(a,t)),s.addEventListener("click",r(d,t)),c.addEventListener("click",r(l,t)),i.append(e)})),e.modal()}}})({isWebGL2:ft,renderThumbnail:lt.renderThumbnail,addBookmark:$t,updateBookmark:Vt,deleteBookmark:Ht,switchToBookmark:t=>{Wt(t),oe(),ie()},fractalSets:pt,colourMaps:xt,onModalOpen:Yt,onModalClose:Nt}),window.addEventListener("resize",se),ct.manualMode)ut.addEventListener("mousedown",ae),ut.addEventListener("mousemove",de),ut.addEventListener("mouseup",ce),ut.addEventListener("mouseleave",ue),document.addEventListener("keydown",ge),new J(ut,(t=>{if(!t.metaKey)if(t.active)if(Pt)ne((()=>{const[e,n]=t.values,i=e-It.mouseX,r=n-It.mouseY;Mt.drag(ut,i,r),It={mouseX:e,mouseY:n}})),ie();else{Pt=!0;const[e,n]=t.initial;It={mouseX:e,mouseY:n}}else Pt=!1})),(t=>{const e=JSON.parse(localStorage.bookmarks||"[]");for(const[n,i]of e){const{thumbnail:e,...r}=i;t.set(n,r)}})(Dt),jt=Dt.size?Math.max(...Dt.keys())+1:0,Wt(st),oe(),ie();else{re(st);const t=()=>{ne((()=>{Mt.panX(At),Mt.panY(Ct),Mt.zoom(Ot)})),ie(),requestAnimationFrame(t),Et||(Et=ht.chooseConfiguration(10),Ft++)};t()}})({manualMode:"manual"===fe.searchParams.get("mode"),contextType:fe.searchParams.get("contextType"),preview:(pe=fe.searchParams.get("preview"),["","true","1","on"].includes(null==pe?void 0:pe.toLowerCase()))})})()})();
//# sourceMappingURL=bundle.js.map