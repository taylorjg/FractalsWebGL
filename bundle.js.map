{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://fractalswebgl/./node_modules/colormap/colorScale.js","webpack://fractalswebgl/./node_modules/colormap/index.js","webpack://fractalswebgl/./node_modules/lerp/index.js","webpack://fractalswebgl/webpack/bootstrap","webpack://fractalswebgl/webpack/runtime/compat get default export","webpack://fractalswebgl/webpack/runtime/define property getters","webpack://fractalswebgl/webpack/runtime/hasOwnProperty shorthand","webpack://fractalswebgl/./node_modules/gl-matrix/esm/common.js","webpack://fractalswebgl/./node_modules/@use-gesture/core/dist/maths-0ab39ae9.esm.js","webpack://fractalswebgl/./node_modules/@use-gesture/core/dist/actions-94b581a0.esm.js","webpack://fractalswebgl/./node_modules/@use-gesture/core/dist/use-gesture-core.esm.js","webpack://fractalswebgl/./node_modules/@use-gesture/vanilla/dist/use-gesture-vanilla.esm.js","webpack://fractalswebgl/./src/js/region.js","webpack://fractalswebgl/./src/js/utils.js","webpack://fractalswebgl/./src/js/constants.js","webpack://fractalswebgl/./src/js/ui.js","webpack://fractalswebgl/./src/js/graphics.js","webpack://fractalswebgl/./node_modules/gl-matrix/esm/mat4.js","webpack://fractalswebgl/./src/js/index.js","webpack://fractalswebgl/./src/js/overlay.js","webpack://fractalswebgl/./src/js/thumbnail.js","webpack://fractalswebgl/./src/js/configuration-chooser.js"],"sourcesContent":["module.exports={\n\t\"jet\":[{\"index\":0,\"rgb\":[0,0,131]},{\"index\":0.125,\"rgb\":[0,60,170]},{\"index\":0.375,\"rgb\":[5,255,255]},{\"index\":0.625,\"rgb\":[255,255,0]},{\"index\":0.875,\"rgb\":[250,0,0]},{\"index\":1,\"rgb\":[128,0,0]}],\n\n\t\"hsv\":[{\"index\":0,\"rgb\":[255,0,0]},{\"index\":0.169,\"rgb\":[253,255,2]},{\"index\":0.173,\"rgb\":[247,255,2]},{\"index\":0.337,\"rgb\":[0,252,4]},{\"index\":0.341,\"rgb\":[0,252,10]},{\"index\":0.506,\"rgb\":[1,249,255]},{\"index\":0.671,\"rgb\":[2,0,253]},{\"index\":0.675,\"rgb\":[8,0,253]},{\"index\":0.839,\"rgb\":[255,0,251]},{\"index\":0.843,\"rgb\":[255,0,245]},{\"index\":1,\"rgb\":[255,0,6]}],\n\n\t\"hot\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.3,\"rgb\":[230,0,0]},{\"index\":0.6,\"rgb\":[255,210,0]},{\"index\":1,\"rgb\":[255,255,255]}],\n\n\t\"spring\":[{\"index\":0,\"rgb\":[255,0,255]},{\"index\":1,\"rgb\":[255,255,0]}],\n\n\t\"summer\":[{\"index\":0,\"rgb\":[0,128,102]},{\"index\":1,\"rgb\":[255,255,102]}],\n\n\t\"autumn\":[{\"index\":0,\"rgb\":[255,0,0]},{\"index\":1,\"rgb\":[255,255,0]}],\n\n\t\"winter\":[{\"index\":0,\"rgb\":[0,0,255]},{\"index\":1,\"rgb\":[0,255,128]}],\n\n\t\"bone\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.376,\"rgb\":[84,84,116]},{\"index\":0.753,\"rgb\":[169,200,200]},{\"index\":1,\"rgb\":[255,255,255]}],\n\n\t\"copper\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.804,\"rgb\":[255,160,102]},{\"index\":1,\"rgb\":[255,199,127]}],\n\n\t\"greys\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":1,\"rgb\":[255,255,255]}],\n\n\t\"yignbu\":[{\"index\":0,\"rgb\":[8,29,88]},{\"index\":0.125,\"rgb\":[37,52,148]},{\"index\":0.25,\"rgb\":[34,94,168]},{\"index\":0.375,\"rgb\":[29,145,192]},{\"index\":0.5,\"rgb\":[65,182,196]},{\"index\":0.625,\"rgb\":[127,205,187]},{\"index\":0.75,\"rgb\":[199,233,180]},{\"index\":0.875,\"rgb\":[237,248,217]},{\"index\":1,\"rgb\":[255,255,217]}],\n\n\t\"greens\":[{\"index\":0,\"rgb\":[0,68,27]},{\"index\":0.125,\"rgb\":[0,109,44]},{\"index\":0.25,\"rgb\":[35,139,69]},{\"index\":0.375,\"rgb\":[65,171,93]},{\"index\":0.5,\"rgb\":[116,196,118]},{\"index\":0.625,\"rgb\":[161,217,155]},{\"index\":0.75,\"rgb\":[199,233,192]},{\"index\":0.875,\"rgb\":[229,245,224]},{\"index\":1,\"rgb\":[247,252,245]}],\n\n\t\"yiorrd\":[{\"index\":0,\"rgb\":[128,0,38]},{\"index\":0.125,\"rgb\":[189,0,38]},{\"index\":0.25,\"rgb\":[227,26,28]},{\"index\":0.375,\"rgb\":[252,78,42]},{\"index\":0.5,\"rgb\":[253,141,60]},{\"index\":0.625,\"rgb\":[254,178,76]},{\"index\":0.75,\"rgb\":[254,217,118]},{\"index\":0.875,\"rgb\":[255,237,160]},{\"index\":1,\"rgb\":[255,255,204]}],\n\n\t\"bluered\":[{\"index\":0,\"rgb\":[0,0,255]},{\"index\":1,\"rgb\":[255,0,0]}],\n\n\t\"rdbu\":[{\"index\":0,\"rgb\":[5,10,172]},{\"index\":0.35,\"rgb\":[106,137,247]},{\"index\":0.5,\"rgb\":[190,190,190]},{\"index\":0.6,\"rgb\":[220,170,132]},{\"index\":0.7,\"rgb\":[230,145,90]},{\"index\":1,\"rgb\":[178,10,28]}],\n\n\t\"picnic\":[{\"index\":0,\"rgb\":[0,0,255]},{\"index\":0.1,\"rgb\":[51,153,255]},{\"index\":0.2,\"rgb\":[102,204,255]},{\"index\":0.3,\"rgb\":[153,204,255]},{\"index\":0.4,\"rgb\":[204,204,255]},{\"index\":0.5,\"rgb\":[255,255,255]},{\"index\":0.6,\"rgb\":[255,204,255]},{\"index\":0.7,\"rgb\":[255,153,255]},{\"index\":0.8,\"rgb\":[255,102,204]},{\"index\":0.9,\"rgb\":[255,102,102]},{\"index\":1,\"rgb\":[255,0,0]}],\n\n\t\"rainbow\":[{\"index\":0,\"rgb\":[150,0,90]},{\"index\":0.125,\"rgb\":[0,0,200]},{\"index\":0.25,\"rgb\":[0,25,255]},{\"index\":0.375,\"rgb\":[0,152,255]},{\"index\":0.5,\"rgb\":[44,255,150]},{\"index\":0.625,\"rgb\":[151,255,0]},{\"index\":0.75,\"rgb\":[255,234,0]},{\"index\":0.875,\"rgb\":[255,111,0]},{\"index\":1,\"rgb\":[255,0,0]}],\n\n\t\"portland\":[{\"index\":0,\"rgb\":[12,51,131]},{\"index\":0.25,\"rgb\":[10,136,186]},{\"index\":0.5,\"rgb\":[242,211,56]},{\"index\":0.75,\"rgb\":[242,143,56]},{\"index\":1,\"rgb\":[217,30,30]}],\n\n\t\"blackbody\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.2,\"rgb\":[230,0,0]},{\"index\":0.4,\"rgb\":[230,210,0]},{\"index\":0.7,\"rgb\":[255,255,255]},{\"index\":1,\"rgb\":[160,200,255]}],\n\n\t\"earth\":[{\"index\":0,\"rgb\":[0,0,130]},{\"index\":0.1,\"rgb\":[0,180,180]},{\"index\":0.2,\"rgb\":[40,210,40]},{\"index\":0.4,\"rgb\":[230,230,50]},{\"index\":0.6,\"rgb\":[120,70,20]},{\"index\":1,\"rgb\":[255,255,255]}],\n\n\t\"electric\":[{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.15,\"rgb\":[30,0,100]},{\"index\":0.4,\"rgb\":[120,0,100]},{\"index\":0.6,\"rgb\":[160,90,0]},{\"index\":0.8,\"rgb\":[230,200,0]},{\"index\":1,\"rgb\":[255,250,220]}],\n\n\t\"alpha\": [{\"index\":0, \"rgb\": [255,255,255,0]},{\"index\":1, \"rgb\": [255,255,255,1]}],\n\n\t\"viridis\": [{\"index\":0,\"rgb\":[68,1,84]},{\"index\":0.13,\"rgb\":[71,44,122]},{\"index\":0.25,\"rgb\":[59,81,139]},{\"index\":0.38,\"rgb\":[44,113,142]},{\"index\":0.5,\"rgb\":[33,144,141]},{\"index\":0.63,\"rgb\":[39,173,129]},{\"index\":0.75,\"rgb\":[92,200,99]},{\"index\":0.88,\"rgb\":[170,220,50]},{\"index\":1,\"rgb\":[253,231,37]}],\n\n\t\"inferno\": [{\"index\":0,\"rgb\":[0,0,4]},{\"index\":0.13,\"rgb\":[31,12,72]},{\"index\":0.25,\"rgb\":[85,15,109]},{\"index\":0.38,\"rgb\":[136,34,106]},{\"index\":0.5,\"rgb\":[186,54,85]},{\"index\":0.63,\"rgb\":[227,89,51]},{\"index\":0.75,\"rgb\":[249,140,10]},{\"index\":0.88,\"rgb\":[249,201,50]},{\"index\":1,\"rgb\":[252,255,164]}],\n\n\t\"magma\": [{\"index\":0,\"rgb\":[0,0,4]},{\"index\":0.13,\"rgb\":[28,16,68]},{\"index\":0.25,\"rgb\":[79,18,123]},{\"index\":0.38,\"rgb\":[129,37,129]},{\"index\":0.5,\"rgb\":[181,54,122]},{\"index\":0.63,\"rgb\":[229,80,100]},{\"index\":0.75,\"rgb\":[251,135,97]},{\"index\":0.88,\"rgb\":[254,194,135]},{\"index\":1,\"rgb\":[252,253,191]}],\n\n\t\"plasma\": [{\"index\":0,\"rgb\":[13,8,135]},{\"index\":0.13,\"rgb\":[75,3,161]},{\"index\":0.25,\"rgb\":[125,3,168]},{\"index\":0.38,\"rgb\":[168,34,150]},{\"index\":0.5,\"rgb\":[203,70,121]},{\"index\":0.63,\"rgb\":[229,107,93]},{\"index\":0.75,\"rgb\":[248,148,65]},{\"index\":0.88,\"rgb\":[253,195,40]},{\"index\":1,\"rgb\":[240,249,33]}],\n\n\t\"warm\": [{\"index\":0,\"rgb\":[125,0,179]},{\"index\":0.13,\"rgb\":[172,0,187]},{\"index\":0.25,\"rgb\":[219,0,170]},{\"index\":0.38,\"rgb\":[255,0,130]},{\"index\":0.5,\"rgb\":[255,63,74]},{\"index\":0.63,\"rgb\":[255,123,0]},{\"index\":0.75,\"rgb\":[234,176,0]},{\"index\":0.88,\"rgb\":[190,228,0]},{\"index\":1,\"rgb\":[147,255,0]}],\n\n\t\"cool\": [{\"index\":0,\"rgb\":[125,0,179]},{\"index\":0.13,\"rgb\":[116,0,218]},{\"index\":0.25,\"rgb\":[98,74,237]},{\"index\":0.38,\"rgb\":[68,146,231]},{\"index\":0.5,\"rgb\":[0,204,197]},{\"index\":0.63,\"rgb\":[0,247,146]},{\"index\":0.75,\"rgb\":[0,255,88]},{\"index\":0.88,\"rgb\":[40,255,8]},{\"index\":1,\"rgb\":[147,255,0]}],\n\n\t\"rainbow-soft\": [{\"index\":0,\"rgb\":[125,0,179]},{\"index\":0.1,\"rgb\":[199,0,180]},{\"index\":0.2,\"rgb\":[255,0,121]},{\"index\":0.3,\"rgb\":[255,108,0]},{\"index\":0.4,\"rgb\":[222,194,0]},{\"index\":0.5,\"rgb\":[150,255,0]},{\"index\":0.6,\"rgb\":[0,255,55]},{\"index\":0.7,\"rgb\":[0,246,150]},{\"index\":0.8,\"rgb\":[50,167,222]},{\"index\":0.9,\"rgb\":[103,51,235]},{\"index\":1,\"rgb\":[124,0,186]}],\n\n\t\"bathymetry\": [{\"index\":0,\"rgb\":[40,26,44]},{\"index\":0.13,\"rgb\":[59,49,90]},{\"index\":0.25,\"rgb\":[64,76,139]},{\"index\":0.38,\"rgb\":[63,110,151]},{\"index\":0.5,\"rgb\":[72,142,158]},{\"index\":0.63,\"rgb\":[85,174,163]},{\"index\":0.75,\"rgb\":[120,206,163]},{\"index\":0.88,\"rgb\":[187,230,172]},{\"index\":1,\"rgb\":[253,254,204]}],\n\n\t\"cdom\": [{\"index\":0,\"rgb\":[47,15,62]},{\"index\":0.13,\"rgb\":[87,23,86]},{\"index\":0.25,\"rgb\":[130,28,99]},{\"index\":0.38,\"rgb\":[171,41,96]},{\"index\":0.5,\"rgb\":[206,67,86]},{\"index\":0.63,\"rgb\":[230,106,84]},{\"index\":0.75,\"rgb\":[242,149,103]},{\"index\":0.88,\"rgb\":[249,193,135]},{\"index\":1,\"rgb\":[254,237,176]}],\n\n\t\"chlorophyll\": [{\"index\":0,\"rgb\":[18,36,20]},{\"index\":0.13,\"rgb\":[25,63,41]},{\"index\":0.25,\"rgb\":[24,91,59]},{\"index\":0.38,\"rgb\":[13,119,72]},{\"index\":0.5,\"rgb\":[18,148,80]},{\"index\":0.63,\"rgb\":[80,173,89]},{\"index\":0.75,\"rgb\":[132,196,122]},{\"index\":0.88,\"rgb\":[175,221,162]},{\"index\":1,\"rgb\":[215,249,208]}],\n\n\t\"density\": [{\"index\":0,\"rgb\":[54,14,36]},{\"index\":0.13,\"rgb\":[89,23,80]},{\"index\":0.25,\"rgb\":[110,45,132]},{\"index\":0.38,\"rgb\":[120,77,178]},{\"index\":0.5,\"rgb\":[120,113,213]},{\"index\":0.63,\"rgb\":[115,151,228]},{\"index\":0.75,\"rgb\":[134,185,227]},{\"index\":0.88,\"rgb\":[177,214,227]},{\"index\":1,\"rgb\":[230,241,241]}],\n\n\t\"freesurface-blue\": [{\"index\":0,\"rgb\":[30,4,110]},{\"index\":0.13,\"rgb\":[47,14,176]},{\"index\":0.25,\"rgb\":[41,45,236]},{\"index\":0.38,\"rgb\":[25,99,212]},{\"index\":0.5,\"rgb\":[68,131,200]},{\"index\":0.63,\"rgb\":[114,156,197]},{\"index\":0.75,\"rgb\":[157,181,203]},{\"index\":0.88,\"rgb\":[200,208,216]},{\"index\":1,\"rgb\":[241,237,236]}],\n\n\t\"freesurface-red\": [{\"index\":0,\"rgb\":[60,9,18]},{\"index\":0.13,\"rgb\":[100,17,27]},{\"index\":0.25,\"rgb\":[142,20,29]},{\"index\":0.38,\"rgb\":[177,43,27]},{\"index\":0.5,\"rgb\":[192,87,63]},{\"index\":0.63,\"rgb\":[205,125,105]},{\"index\":0.75,\"rgb\":[216,162,148]},{\"index\":0.88,\"rgb\":[227,199,193]},{\"index\":1,\"rgb\":[241,237,236]}],\n\n\t\"oxygen\": [{\"index\":0,\"rgb\":[64,5,5]},{\"index\":0.13,\"rgb\":[106,6,15]},{\"index\":0.25,\"rgb\":[144,26,7]},{\"index\":0.38,\"rgb\":[168,64,3]},{\"index\":0.5,\"rgb\":[188,100,4]},{\"index\":0.63,\"rgb\":[206,136,11]},{\"index\":0.75,\"rgb\":[220,174,25]},{\"index\":0.88,\"rgb\":[231,215,44]},{\"index\":1,\"rgb\":[248,254,105]}],\n\n\t\"par\": [{\"index\":0,\"rgb\":[51,20,24]},{\"index\":0.13,\"rgb\":[90,32,35]},{\"index\":0.25,\"rgb\":[129,44,34]},{\"index\":0.38,\"rgb\":[159,68,25]},{\"index\":0.5,\"rgb\":[182,99,19]},{\"index\":0.63,\"rgb\":[199,134,22]},{\"index\":0.75,\"rgb\":[212,171,35]},{\"index\":0.88,\"rgb\":[221,210,54]},{\"index\":1,\"rgb\":[225,253,75]}],\n\n\t\"phase\": [{\"index\":0,\"rgb\":[145,105,18]},{\"index\":0.13,\"rgb\":[184,71,38]},{\"index\":0.25,\"rgb\":[186,58,115]},{\"index\":0.38,\"rgb\":[160,71,185]},{\"index\":0.5,\"rgb\":[110,97,218]},{\"index\":0.63,\"rgb\":[50,123,164]},{\"index\":0.75,\"rgb\":[31,131,110]},{\"index\":0.88,\"rgb\":[77,129,34]},{\"index\":1,\"rgb\":[145,105,18]}],\n\n\t\"salinity\": [{\"index\":0,\"rgb\":[42,24,108]},{\"index\":0.13,\"rgb\":[33,50,162]},{\"index\":0.25,\"rgb\":[15,90,145]},{\"index\":0.38,\"rgb\":[40,118,137]},{\"index\":0.5,\"rgb\":[59,146,135]},{\"index\":0.63,\"rgb\":[79,175,126]},{\"index\":0.75,\"rgb\":[120,203,104]},{\"index\":0.88,\"rgb\":[193,221,100]},{\"index\":1,\"rgb\":[253,239,154]}],\n\n\t\"temperature\": [{\"index\":0,\"rgb\":[4,35,51]},{\"index\":0.13,\"rgb\":[23,51,122]},{\"index\":0.25,\"rgb\":[85,59,157]},{\"index\":0.38,\"rgb\":[129,79,143]},{\"index\":0.5,\"rgb\":[175,95,130]},{\"index\":0.63,\"rgb\":[222,112,101]},{\"index\":0.75,\"rgb\":[249,146,66]},{\"index\":0.88,\"rgb\":[249,196,65]},{\"index\":1,\"rgb\":[232,250,91]}],\n\n\t\"turbidity\": [{\"index\":0,\"rgb\":[34,31,27]},{\"index\":0.13,\"rgb\":[65,50,41]},{\"index\":0.25,\"rgb\":[98,69,52]},{\"index\":0.38,\"rgb\":[131,89,57]},{\"index\":0.5,\"rgb\":[161,112,59]},{\"index\":0.63,\"rgb\":[185,140,66]},{\"index\":0.75,\"rgb\":[202,174,88]},{\"index\":0.88,\"rgb\":[216,209,126]},{\"index\":1,\"rgb\":[233,246,171]}],\n\n\t\"velocity-blue\": [{\"index\":0,\"rgb\":[17,32,64]},{\"index\":0.13,\"rgb\":[35,52,116]},{\"index\":0.25,\"rgb\":[29,81,156]},{\"index\":0.38,\"rgb\":[31,113,162]},{\"index\":0.5,\"rgb\":[50,144,169]},{\"index\":0.63,\"rgb\":[87,173,176]},{\"index\":0.75,\"rgb\":[149,196,189]},{\"index\":0.88,\"rgb\":[203,221,211]},{\"index\":1,\"rgb\":[254,251,230]}],\n\n\t\"velocity-green\": [{\"index\":0,\"rgb\":[23,35,19]},{\"index\":0.13,\"rgb\":[24,64,38]},{\"index\":0.25,\"rgb\":[11,95,45]},{\"index\":0.38,\"rgb\":[39,123,35]},{\"index\":0.5,\"rgb\":[95,146,12]},{\"index\":0.63,\"rgb\":[152,165,18]},{\"index\":0.75,\"rgb\":[201,186,69]},{\"index\":0.88,\"rgb\":[233,216,137]},{\"index\":1,\"rgb\":[255,253,205]}],\n\n\t\"cubehelix\": [{\"index\":0,\"rgb\":[0,0,0]},{\"index\":0.07,\"rgb\":[22,5,59]},{\"index\":0.13,\"rgb\":[60,4,105]},{\"index\":0.2,\"rgb\":[109,1,135]},{\"index\":0.27,\"rgb\":[161,0,147]},{\"index\":0.33,\"rgb\":[210,2,142]},{\"index\":0.4,\"rgb\":[251,11,123]},{\"index\":0.47,\"rgb\":[255,29,97]},{\"index\":0.53,\"rgb\":[255,54,69]},{\"index\":0.6,\"rgb\":[255,85,46]},{\"index\":0.67,\"rgb\":[255,120,34]},{\"index\":0.73,\"rgb\":[255,157,37]},{\"index\":0.8,\"rgb\":[241,191,57]},{\"index\":0.87,\"rgb\":[224,220,93]},{\"index\":0.93,\"rgb\":[218,241,142]},{\"index\":1,\"rgb\":[227,253,198]}]\n};\n","/*\n * Ben Postlethwaite\n * January 2013\n * License MIT\n */\n'use strict';\n\nvar colorScale = require('./colorScale');\nvar lerp = require('lerp')\n\nmodule.exports = createColormap;\n\nfunction createColormap (spec) {\n    /*\n     * Default Options\n     */\n    var indicies, fromrgba, torgba,\n        nsteps, cmap, colormap, format,\n        nshades, colors, alpha, i;\n\n    if ( !spec ) spec = {};\n\n    nshades = (spec.nshades || 72) - 1;\n    format = spec.format || 'hex';\n\n    colormap = spec.colormap;\n    if (!colormap) colormap = 'jet';\n\n    if (typeof colormap === 'string') {\n        colormap = colormap.toLowerCase();\n\n        if (!colorScale[colormap]) {\n            throw Error(colormap + ' not a supported colorscale');\n        }\n\n        cmap = colorScale[colormap];\n\n    } else if (Array.isArray(colormap)) {\n        cmap = colormap.slice();\n\n    } else {\n        throw Error('unsupported colormap option', colormap);\n    }\n\n    if (cmap.length > nshades + 1) {\n        throw new Error(\n            colormap+' map requires nshades to be at least size '+cmap.length\n        );\n    }\n\n    if (!Array.isArray(spec.alpha)) {\n\n        if (typeof spec.alpha === 'number') {\n            alpha = [spec.alpha, spec.alpha];\n\n        } else {\n            alpha = [1, 1];\n        }\n\n    } else if (spec.alpha.length !== 2) {\n        alpha = [1, 1];\n\n    } else {\n        alpha = spec.alpha.slice();\n    }\n\n    // map index points from 0..1 to 0..n-1\n    indicies = cmap.map(function(c) {\n        return Math.round(c.index * nshades);\n    });\n\n    // Add alpha channel to the map\n    alpha[0] = Math.min(Math.max(alpha[0], 0), 1);\n    alpha[1] = Math.min(Math.max(alpha[1], 0), 1);\n\n    var steps = cmap.map(function(c, i) {\n        var index = cmap[i].index\n\n        var rgba = cmap[i].rgb.slice();\n\n        // if user supplies their own map use it\n        if (rgba.length === 4 && rgba[3] >= 0 && rgba[3] <= 1) {\n            return rgba\n        }\n        rgba[3] = alpha[0] + (alpha[1] - alpha[0])*index;\n\n        return rgba\n    })\n\n\n    /*\n     * map increasing linear values between indicies to\n     * linear steps in colorvalues\n     */\n    var colors = []\n    for (i = 0; i < indicies.length-1; ++i) {\n        nsteps = indicies[i+1] - indicies[i];\n        fromrgba = steps[i];\n        torgba = steps[i+1];\n\n        for (var j = 0; j < nsteps; j++) {\n            var amt = j / nsteps\n            colors.push([\n                Math.round(lerp(fromrgba[0], torgba[0], amt)),\n                Math.round(lerp(fromrgba[1], torgba[1], amt)),\n                Math.round(lerp(fromrgba[2], torgba[2], amt)),\n                lerp(fromrgba[3], torgba[3], amt)\n            ])\n        }\n    }\n\n    //add 1 step as last value\n    colors.push(cmap[cmap.length - 1].rgb.concat(alpha[1]))\n\n    if (format === 'hex') colors = colors.map( rgb2hex );\n    else if (format === 'rgbaString') colors = colors.map( rgbaStr );\n    else if (format === 'float') colors = colors.map( rgb2float );\n\n    return colors;\n};\n\nfunction rgb2float (rgba) {\n    return [\n        rgba[0] / 255,\n        rgba[1] / 255,\n        rgba[2] / 255,\n        rgba[3]\n    ]\n}\n\nfunction rgb2hex (rgba) {\n    var dig, hex = '#';\n    for (var i = 0; i < 3; ++i) {\n        dig = rgba[i];\n        dig = dig.toString(16);\n        hex += ('00' + dig).substr( dig.length );\n    }\n    return hex;\n}\n\nfunction rgbaStr (rgba) {\n    return 'rgba(' + rgba.join(',') + ')';\n}\n","function lerp(v0, v1, t) {\n    return v0*(1-t)+v1*t\n}\nmodule.exports = lerp","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","function clamp(v, min, max) {\n  return Math.max(min, Math.min(v, max));\n}\nconst V = {\n  toVector(v, fallback) {\n    if (v === undefined) v = fallback;\n    return Array.isArray(v) ? v : [v, v];\n  },\n  add(v1, v2) {\n    return [v1[0] + v2[0], v1[1] + v2[1]];\n  },\n  sub(v1, v2) {\n    return [v1[0] - v2[0], v1[1] - v2[1]];\n  },\n  addTo(v1, v2) {\n    v1[0] += v2[0];\n    v1[1] += v2[1];\n  },\n  subTo(v1, v2) {\n    v1[0] -= v2[0];\n    v1[1] -= v2[1];\n  }\n};\nfunction rubberband(distance, dimension, constant) {\n  if (dimension === 0 || Math.abs(dimension) === Infinity) return Math.pow(distance, constant * 5);\n  return distance * dimension * constant / (dimension + constant * distance);\n}\nfunction rubberbandIfOutOfBounds(position, min, max, constant = 0.15) {\n  if (constant === 0) return clamp(position, min, max);\n  if (position < min) return -rubberband(min - position, max - min, constant) + min;\n  if (position > max) return +rubberband(position - max, max - min, constant) + max;\n  return position;\n}\nfunction computeRubberband(bounds, [Vx, Vy], [Rx, Ry]) {\n  const [[X0, X1], [Y0, Y1]] = bounds;\n  return [rubberbandIfOutOfBounds(Vx, X0, X1, Rx), rubberbandIfOutOfBounds(Vy, Y0, Y1, Ry)];\n}\n\nexport { V, computeRubberband as c, rubberbandIfOutOfBounds as r };\n","import { V, c as computeRubberband } from './maths-0ab39ae9.esm.js';\n\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\n\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n\nconst EVENT_TYPE_MAP = {\n  pointer: {\n    start: 'down',\n    change: 'move',\n    end: 'up'\n  },\n  mouse: {\n    start: 'down',\n    change: 'move',\n    end: 'up'\n  },\n  touch: {\n    start: 'start',\n    change: 'move',\n    end: 'end'\n  },\n  gesture: {\n    start: 'start',\n    change: 'change',\n    end: 'end'\n  }\n};\nfunction capitalize(string) {\n  if (!string) return '';\n  return string[0].toUpperCase() + string.slice(1);\n}\nconst actionsWithoutCaptureSupported = ['enter', 'leave'];\nfunction hasCapture(capture = false, actionKey) {\n  return capture && !actionsWithoutCaptureSupported.includes(actionKey);\n}\nfunction toHandlerProp(device, action = '', capture = false) {\n  const deviceProps = EVENT_TYPE_MAP[device];\n  const actionKey = deviceProps ? deviceProps[action] || action : action;\n  return 'on' + capitalize(device) + capitalize(actionKey) + (hasCapture(capture, actionKey) ? 'Capture' : '');\n}\nconst pointerCaptureEvents = ['gotpointercapture', 'lostpointercapture'];\nfunction parseProp(prop) {\n  let eventKey = prop.substring(2).toLowerCase();\n  const passive = !!~eventKey.indexOf('passive');\n  if (passive) eventKey = eventKey.replace('passive', '');\n  const captureKey = pointerCaptureEvents.includes(eventKey) ? 'capturecapture' : 'capture';\n  const capture = !!~eventKey.indexOf(captureKey);\n  if (capture) eventKey = eventKey.replace('capture', '');\n  return {\n    device: eventKey,\n    capture,\n    passive\n  };\n}\nfunction toDomEventType(device, action = '') {\n  const deviceProps = EVENT_TYPE_MAP[device];\n  const actionKey = deviceProps ? deviceProps[action] || action : action;\n  return device + actionKey;\n}\nfunction isTouch(event) {\n  return 'touches' in event;\n}\nfunction getPointerType(event) {\n  if (isTouch(event)) return 'touch';\n  if ('pointerType' in event) return event.pointerType;\n  return 'mouse';\n}\nfunction getCurrentTargetTouchList(event) {\n  return Array.from(event.touches).filter(e => {\n    var _event$currentTarget, _event$currentTarget$;\n    return e.target === event.currentTarget || ((_event$currentTarget = event.currentTarget) === null || _event$currentTarget === void 0 ? void 0 : (_event$currentTarget$ = _event$currentTarget.contains) === null || _event$currentTarget$ === void 0 ? void 0 : _event$currentTarget$.call(_event$currentTarget, e.target));\n  });\n}\nfunction getTouchList(event) {\n  return event.type === 'touchend' || event.type === 'touchcancel' ? event.changedTouches : event.targetTouches;\n}\nfunction getValueEvent(event) {\n  return isTouch(event) ? getTouchList(event)[0] : event;\n}\nfunction distanceAngle(P1, P2) {\n  try {\n    const dx = P2.clientX - P1.clientX;\n    const dy = P2.clientY - P1.clientY;\n    const cx = (P2.clientX + P1.clientX) / 2;\n    const cy = (P2.clientY + P1.clientY) / 2;\n    const distance = Math.hypot(dx, dy);\n    const angle = -(Math.atan2(dx, dy) * 180) / Math.PI;\n    const origin = [cx, cy];\n    return {\n      angle,\n      distance,\n      origin\n    };\n  } catch (_unused) {}\n  return null;\n}\nfunction touchIds(event) {\n  return getCurrentTargetTouchList(event).map(touch => touch.identifier);\n}\nfunction touchDistanceAngle(event, ids) {\n  const [P1, P2] = Array.from(event.touches).filter(touch => ids.includes(touch.identifier));\n  return distanceAngle(P1, P2);\n}\nfunction pointerId(event) {\n  const valueEvent = getValueEvent(event);\n  return isTouch(event) ? valueEvent.identifier : valueEvent.pointerId;\n}\nfunction pointerValues(event) {\n  const valueEvent = getValueEvent(event);\n  return [valueEvent.clientX, valueEvent.clientY];\n}\nconst LINE_HEIGHT = 40;\nconst PAGE_HEIGHT = 800;\nfunction wheelValues(event) {\n  let {\n    deltaX,\n    deltaY,\n    deltaMode\n  } = event;\n  if (deltaMode === 1) {\n    deltaX *= LINE_HEIGHT;\n    deltaY *= LINE_HEIGHT;\n  } else if (deltaMode === 2) {\n    deltaX *= PAGE_HEIGHT;\n    deltaY *= PAGE_HEIGHT;\n  }\n  return [deltaX, deltaY];\n}\nfunction scrollValues(event) {\n  var _ref, _ref2;\n  const {\n    scrollX,\n    scrollY,\n    scrollLeft,\n    scrollTop\n  } = event.currentTarget;\n  return [(_ref = scrollX !== null && scrollX !== void 0 ? scrollX : scrollLeft) !== null && _ref !== void 0 ? _ref : 0, (_ref2 = scrollY !== null && scrollY !== void 0 ? scrollY : scrollTop) !== null && _ref2 !== void 0 ? _ref2 : 0];\n}\nfunction getEventDetails(event) {\n  const payload = {};\n  if ('buttons' in event) payload.buttons = event.buttons;\n  if ('shiftKey' in event) {\n    const {\n      shiftKey,\n      altKey,\n      metaKey,\n      ctrlKey\n    } = event;\n    Object.assign(payload, {\n      shiftKey,\n      altKey,\n      metaKey,\n      ctrlKey\n    });\n  }\n  return payload;\n}\n\nfunction call(v, ...args) {\n  if (typeof v === 'function') {\n    return v(...args);\n  } else {\n    return v;\n  }\n}\nfunction noop() {}\nfunction chain(...fns) {\n  if (fns.length === 0) return noop;\n  if (fns.length === 1) return fns[0];\n  return function () {\n    let result;\n    for (const fn of fns) {\n      result = fn.apply(this, arguments) || result;\n    }\n    return result;\n  };\n}\nfunction assignDefault(value, fallback) {\n  return Object.assign({}, fallback, value || {});\n}\n\nconst BEFORE_LAST_KINEMATICS_DELAY = 32;\nclass Engine {\n  constructor(ctrl, args, key) {\n    this.ctrl = ctrl;\n    this.args = args;\n    this.key = key;\n    if (!this.state) {\n      this.state = {};\n      this.computeValues([0, 0]);\n      this.computeInitial();\n      if (this.init) this.init();\n      this.reset();\n    }\n  }\n  get state() {\n    return this.ctrl.state[this.key];\n  }\n  set state(state) {\n    this.ctrl.state[this.key] = state;\n  }\n  get shared() {\n    return this.ctrl.state.shared;\n  }\n  get eventStore() {\n    return this.ctrl.gestureEventStores[this.key];\n  }\n  get timeoutStore() {\n    return this.ctrl.gestureTimeoutStores[this.key];\n  }\n  get config() {\n    return this.ctrl.config[this.key];\n  }\n  get sharedConfig() {\n    return this.ctrl.config.shared;\n  }\n  get handler() {\n    return this.ctrl.handlers[this.key];\n  }\n  reset() {\n    const {\n      state,\n      shared,\n      ingKey,\n      args\n    } = this;\n    shared[ingKey] = state._active = state.active = state._blocked = state._force = false;\n    state._step = [false, false];\n    state.intentional = false;\n    state._movement = [0, 0];\n    state._distance = [0, 0];\n    state._direction = [0, 0];\n    state._delta = [0, 0];\n    state._bounds = [[-Infinity, Infinity], [-Infinity, Infinity]];\n    state.args = args;\n    state.axis = undefined;\n    state.memo = undefined;\n    state.elapsedTime = state.timeDelta = 0;\n    state.direction = [0, 0];\n    state.distance = [0, 0];\n    state.overflow = [0, 0];\n    state._movementBound = [false, false];\n    state.velocity = [0, 0];\n    state.movement = [0, 0];\n    state.delta = [0, 0];\n    state.timeStamp = 0;\n  }\n  start(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state._active) {\n      this.reset();\n      this.computeInitial();\n      state._active = true;\n      state.target = event.target;\n      state.currentTarget = event.currentTarget;\n      state.lastOffset = config.from ? call(config.from, state) : state.offset;\n      state.offset = state.lastOffset;\n      state.startTime = state.timeStamp = event.timeStamp;\n    }\n  }\n  computeValues(values) {\n    const state = this.state;\n    state._values = values;\n    state.values = this.config.transform(values);\n  }\n  computeInitial() {\n    const state = this.state;\n    state._initial = state._values;\n    state.initial = state.values;\n  }\n  compute(event) {\n    const {\n      state,\n      config,\n      shared\n    } = this;\n    state.args = this.args;\n    let dt = 0;\n    if (event) {\n      state.event = event;\n      if (config.preventDefault && event.cancelable) state.event.preventDefault();\n      state.type = event.type;\n      shared.touches = this.ctrl.pointerIds.size || this.ctrl.touchIds.size;\n      shared.locked = !!document.pointerLockElement;\n      Object.assign(shared, getEventDetails(event));\n      shared.down = shared.pressed = shared.buttons % 2 === 1 || shared.touches > 0;\n      dt = event.timeStamp - state.timeStamp;\n      state.timeStamp = event.timeStamp;\n      state.elapsedTime = state.timeStamp - state.startTime;\n    }\n    if (state._active) {\n      const _absoluteDelta = state._delta.map(Math.abs);\n      V.addTo(state._distance, _absoluteDelta);\n    }\n    if (this.axisIntent) this.axisIntent(event);\n    const [_m0, _m1] = state._movement;\n    const [t0, t1] = config.threshold;\n    const {\n      _step,\n      values\n    } = state;\n    if (config.hasCustomTransform) {\n      if (_step[0] === false) _step[0] = Math.abs(_m0) >= t0 && values[0];\n      if (_step[1] === false) _step[1] = Math.abs(_m1) >= t1 && values[1];\n    } else {\n      if (_step[0] === false) _step[0] = Math.abs(_m0) >= t0 && Math.sign(_m0) * t0;\n      if (_step[1] === false) _step[1] = Math.abs(_m1) >= t1 && Math.sign(_m1) * t1;\n    }\n    state.intentional = _step[0] !== false || _step[1] !== false;\n    if (!state.intentional) return;\n    const movement = [0, 0];\n    if (config.hasCustomTransform) {\n      const [v0, v1] = values;\n      movement[0] = _step[0] !== false ? v0 - _step[0] : 0;\n      movement[1] = _step[1] !== false ? v1 - _step[1] : 0;\n    } else {\n      movement[0] = _step[0] !== false ? _m0 - _step[0] : 0;\n      movement[1] = _step[1] !== false ? _m1 - _step[1] : 0;\n    }\n    if (this.restrictToAxis && !state._blocked) this.restrictToAxis(movement);\n    const previousOffset = state.offset;\n    const gestureIsActive = state._active && !state._blocked || state.active;\n    if (gestureIsActive) {\n      state.first = state._active && !state.active;\n      state.last = !state._active && state.active;\n      state.active = shared[this.ingKey] = state._active;\n      if (event) {\n        if (state.first) {\n          if ('bounds' in config) state._bounds = call(config.bounds, state);\n          if (this.setup) this.setup();\n        }\n        state.movement = movement;\n        this.computeOffset();\n      }\n    }\n    const [ox, oy] = state.offset;\n    const [[x0, x1], [y0, y1]] = state._bounds;\n    state.overflow = [ox < x0 ? -1 : ox > x1 ? 1 : 0, oy < y0 ? -1 : oy > y1 ? 1 : 0];\n    state._movementBound[0] = state.overflow[0] ? state._movementBound[0] === false ? state._movement[0] : state._movementBound[0] : false;\n    state._movementBound[1] = state.overflow[1] ? state._movementBound[1] === false ? state._movement[1] : state._movementBound[1] : false;\n    const rubberband = state._active ? config.rubberband || [0, 0] : [0, 0];\n    state.offset = computeRubberband(state._bounds, state.offset, rubberband);\n    state.delta = V.sub(state.offset, previousOffset);\n    this.computeMovement();\n    if (gestureIsActive && (!state.last || dt > BEFORE_LAST_KINEMATICS_DELAY)) {\n      state.delta = V.sub(state.offset, previousOffset);\n      const absoluteDelta = state.delta.map(Math.abs);\n      V.addTo(state.distance, absoluteDelta);\n      state.direction = state.delta.map(Math.sign);\n      state._direction = state._delta.map(Math.sign);\n      if (!state.first && dt > 0) {\n        state.velocity = [absoluteDelta[0] / dt, absoluteDelta[1] / dt];\n        state.timeDelta = dt;\n      }\n    }\n  }\n  emit() {\n    const state = this.state;\n    const shared = this.shared;\n    const config = this.config;\n    if (!state._active) this.clean();\n    if ((state._blocked || !state.intentional) && !state._force && !config.triggerAllEvents) return;\n    const memo = this.handler(_objectSpread2(_objectSpread2(_objectSpread2({}, shared), state), {}, {\n      [this.aliasKey]: state.values\n    }));\n    if (memo !== undefined) state.memo = memo;\n  }\n  clean() {\n    this.eventStore.clean();\n    this.timeoutStore.clean();\n  }\n}\n\nfunction selectAxis([dx, dy], threshold) {\n  const absDx = Math.abs(dx);\n  const absDy = Math.abs(dy);\n  if (absDx > absDy && absDx > threshold) {\n    return 'x';\n  }\n  if (absDy > absDx && absDy > threshold) {\n    return 'y';\n  }\n  return undefined;\n}\nclass CoordinatesEngine extends Engine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"aliasKey\", 'xy');\n  }\n  reset() {\n    super.reset();\n    this.state.axis = undefined;\n  }\n  init() {\n    this.state.offset = [0, 0];\n    this.state.lastOffset = [0, 0];\n  }\n  computeOffset() {\n    this.state.offset = V.add(this.state.lastOffset, this.state.movement);\n  }\n  computeMovement() {\n    this.state.movement = V.sub(this.state.offset, this.state.lastOffset);\n  }\n  axisIntent(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state.axis && event) {\n      const threshold = typeof config.axisThreshold === 'object' ? config.axisThreshold[getPointerType(event)] : config.axisThreshold;\n      state.axis = selectAxis(state._movement, threshold);\n    }\n    state._blocked = (config.lockDirection || !!config.axis) && !state.axis || !!config.axis && config.axis !== state.axis;\n  }\n  restrictToAxis(v) {\n    if (this.config.axis || this.config.lockDirection) {\n      switch (this.state.axis) {\n        case 'x':\n          v[1] = 0;\n          break;\n        case 'y':\n          v[0] = 0;\n          break;\n      }\n    }\n  }\n}\n\nconst identity = v => v;\nconst DEFAULT_RUBBERBAND = 0.15;\nconst commonConfigResolver = {\n  enabled(value = true) {\n    return value;\n  },\n  eventOptions(value, _k, config) {\n    return _objectSpread2(_objectSpread2({}, config.shared.eventOptions), value);\n  },\n  preventDefault(value = false) {\n    return value;\n  },\n  triggerAllEvents(value = false) {\n    return value;\n  },\n  rubberband(value = 0) {\n    switch (value) {\n      case true:\n        return [DEFAULT_RUBBERBAND, DEFAULT_RUBBERBAND];\n      case false:\n        return [0, 0];\n      default:\n        return V.toVector(value);\n    }\n  },\n  from(value) {\n    if (typeof value === 'function') return value;\n    if (value != null) return V.toVector(value);\n  },\n  transform(value, _k, config) {\n    const transform = value || config.shared.transform;\n    this.hasCustomTransform = !!transform;\n    if (process.env.NODE_ENV === 'development') {\n      const originalTransform = transform || identity;\n      return v => {\n        const r = originalTransform(v);\n        if (!isFinite(r[0]) || !isFinite(r[1])) {\n          console.warn(`[@use-gesture]: config.transform() must produce a valid result, but it was: [${r[0]},${[1]}]`);\n        }\n        return r;\n      };\n    }\n    return transform || identity;\n  },\n  threshold(value) {\n    return V.toVector(value, 0);\n  }\n};\nif (process.env.NODE_ENV === 'development') {\n  Object.assign(commonConfigResolver, {\n    domTarget(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`domTarget\\` option has been renamed to \\`target\\`.`);\n      }\n      return NaN;\n    },\n    lockDirection(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`lockDirection\\` option has been merged with \\`axis\\`. Use it as in \\`{ axis: 'lock' }\\``);\n      }\n      return NaN;\n    },\n    initial(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`initial\\` option has been renamed to \\`from\\`.`);\n      }\n      return NaN;\n    }\n  });\n}\n\nconst DEFAULT_AXIS_THRESHOLD = 0;\nconst coordinatesConfigResolver = _objectSpread2(_objectSpread2({}, commonConfigResolver), {}, {\n  axis(_v, _k, {\n    axis\n  }) {\n    this.lockDirection = axis === 'lock';\n    if (!this.lockDirection) return axis;\n  },\n  axisThreshold(value = DEFAULT_AXIS_THRESHOLD) {\n    return value;\n  },\n  bounds(value = {}) {\n    if (typeof value === 'function') {\n      return state => coordinatesConfigResolver.bounds(value(state));\n    }\n    if ('current' in value) {\n      return () => value.current;\n    }\n    if (typeof HTMLElement === 'function' && value instanceof HTMLElement) {\n      return value;\n    }\n    const {\n      left = -Infinity,\n      right = Infinity,\n      top = -Infinity,\n      bottom = Infinity\n    } = value;\n    return [[left, right], [top, bottom]];\n  }\n});\n\nconst KEYS_DELTA_MAP = {\n  ArrowRight: (displacement, factor = 1) => [displacement * factor, 0],\n  ArrowLeft: (displacement, factor = 1) => [-1 * displacement * factor, 0],\n  ArrowUp: (displacement, factor = 1) => [0, -1 * displacement * factor],\n  ArrowDown: (displacement, factor = 1) => [0, displacement * factor]\n};\nclass DragEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'dragging');\n  }\n  reset() {\n    super.reset();\n    const state = this.state;\n    state._pointerId = undefined;\n    state._pointerActive = false;\n    state._keyboardActive = false;\n    state._preventScroll = false;\n    state._delayed = false;\n    state.swipe = [0, 0];\n    state.tap = false;\n    state.canceled = false;\n    state.cancel = this.cancel.bind(this);\n  }\n  setup() {\n    const state = this.state;\n    if (state._bounds instanceof HTMLElement) {\n      const boundRect = state._bounds.getBoundingClientRect();\n      const targetRect = state.currentTarget.getBoundingClientRect();\n      const _bounds = {\n        left: boundRect.left - targetRect.left + state.offset[0],\n        right: boundRect.right - targetRect.right + state.offset[0],\n        top: boundRect.top - targetRect.top + state.offset[1],\n        bottom: boundRect.bottom - targetRect.bottom + state.offset[1]\n      };\n      state._bounds = coordinatesConfigResolver.bounds(_bounds);\n    }\n  }\n  cancel() {\n    const state = this.state;\n    if (state.canceled) return;\n    state.canceled = true;\n    state._active = false;\n    setTimeout(() => {\n      this.compute();\n      this.emit();\n    }, 0);\n  }\n  setActive() {\n    this.state._active = this.state._pointerActive || this.state._keyboardActive;\n  }\n  clean() {\n    this.pointerClean();\n    this.state._pointerActive = false;\n    this.state._keyboardActive = false;\n    super.clean();\n  }\n  pointerDown(event) {\n    const config = this.config;\n    const state = this.state;\n    if (event.buttons != null && (Array.isArray(config.pointerButtons) ? !config.pointerButtons.includes(event.buttons) : config.pointerButtons !== -1 && config.pointerButtons !== event.buttons)) return;\n    const ctrlIds = this.ctrl.setEventIds(event);\n    if (config.pointerCapture) {\n      event.target.setPointerCapture(event.pointerId);\n    }\n    if (ctrlIds && ctrlIds.size > 1 && state._pointerActive) return;\n    this.start(event);\n    this.setupPointer(event);\n    state._pointerId = pointerId(event);\n    state._pointerActive = true;\n    this.computeValues(pointerValues(event));\n    this.computeInitial();\n    if (config.preventScrollAxis && getPointerType(event) !== 'mouse') {\n      state._active = false;\n      this.setupScrollPrevention(event);\n    } else if (config.delay > 0) {\n      this.setupDelayTrigger(event);\n      if (config.triggerAllEvents) {\n        this.compute(event);\n        this.emit();\n      }\n    } else {\n      this.startPointerDrag(event);\n    }\n  }\n  startPointerDrag(event) {\n    const state = this.state;\n    state._active = true;\n    state._preventScroll = true;\n    state._delayed = false;\n    this.compute(event);\n    this.emit();\n  }\n  pointerMove(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state._pointerActive) return;\n    if (state.type === event.type && event.timeStamp === state.timeStamp) return;\n    const id = pointerId(event);\n    if (state._pointerId !== undefined && id !== state._pointerId) return;\n    const _values = pointerValues(event);\n    if (document.pointerLockElement === event.target) {\n      state._delta = [event.movementX, event.movementY];\n    } else {\n      state._delta = V.sub(_values, state._values);\n      this.computeValues(_values);\n    }\n    V.addTo(state._movement, state._delta);\n    this.compute(event);\n    if (state._delayed && state.intentional) {\n      this.timeoutStore.remove('dragDelay');\n      state.active = false;\n      this.startPointerDrag(event);\n      return;\n    }\n    if (config.preventScrollAxis && !state._preventScroll) {\n      if (state.axis) {\n        if (state.axis === config.preventScrollAxis || config.preventScrollAxis === 'xy') {\n          state._active = false;\n          this.clean();\n          return;\n        } else {\n          this.timeoutStore.remove('startPointerDrag');\n          this.startPointerDrag(event);\n          return;\n        }\n      } else {\n        return;\n      }\n    }\n    this.emit();\n  }\n  pointerUp(event) {\n    this.ctrl.setEventIds(event);\n    try {\n      if (this.config.pointerCapture && event.target.hasPointerCapture(event.pointerId)) {\n        ;\n        event.target.releasePointerCapture(event.pointerId);\n      }\n    } catch (_unused) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn(`[@use-gesture]: If you see this message, it's likely that you're using an outdated version of \\`@react-three/fiber\\`. \\n\\nPlease upgrade to the latest version.`);\n      }\n    }\n    const state = this.state;\n    const config = this.config;\n    if (!state._active || !state._pointerActive) return;\n    const id = pointerId(event);\n    if (state._pointerId !== undefined && id !== state._pointerId) return;\n    this.state._pointerActive = false;\n    this.setActive();\n    this.compute(event);\n    const [dx, dy] = state._distance;\n    state.tap = dx <= config.tapsThreshold && dy <= config.tapsThreshold;\n    if (state.tap && config.filterTaps) {\n      state._force = true;\n    } else {\n      const [_dx, _dy] = state._delta;\n      const [_mx, _my] = state._movement;\n      const [svx, svy] = config.swipe.velocity;\n      const [sx, sy] = config.swipe.distance;\n      const sdt = config.swipe.duration;\n      if (state.elapsedTime < sdt) {\n        const _vx = Math.abs(_dx / state.timeDelta);\n        const _vy = Math.abs(_dy / state.timeDelta);\n        if (_vx > svx && Math.abs(_mx) > sx) state.swipe[0] = Math.sign(_dx);\n        if (_vy > svy && Math.abs(_my) > sy) state.swipe[1] = Math.sign(_dy);\n      }\n    }\n    this.emit();\n  }\n  pointerClick(event) {\n    if (!this.state.tap && event.detail > 0) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n  setupPointer(event) {\n    const config = this.config;\n    const device = config.device;\n    if (process.env.NODE_ENV === 'development') {\n      try {\n        if (device === 'pointer' && config.preventScrollDelay === undefined) {\n          const currentTarget = 'uv' in event ? event.sourceEvent.currentTarget : event.currentTarget;\n          const style = window.getComputedStyle(currentTarget);\n          if (style.touchAction === 'auto') {\n            console.warn(`[@use-gesture]: The drag target has its \\`touch-action\\` style property set to \\`auto\\`. It is recommended to add \\`touch-action: 'none'\\` so that the drag gesture behaves correctly on touch-enabled devices. For more information read this: https://use-gesture.netlify.app/docs/extras/#touch-action.\\n\\nThis message will only show in development mode. It won't appear in production. If this is intended, you can ignore it.`, currentTarget);\n          }\n        }\n      } catch (_unused2) {}\n    }\n    if (config.pointerLock) {\n      event.currentTarget.requestPointerLock();\n    }\n    if (!config.pointerCapture) {\n      this.eventStore.add(this.sharedConfig.window, device, 'change', this.pointerMove.bind(this));\n      this.eventStore.add(this.sharedConfig.window, device, 'end', this.pointerUp.bind(this));\n      this.eventStore.add(this.sharedConfig.window, device, 'cancel', this.pointerUp.bind(this));\n    }\n  }\n  pointerClean() {\n    if (this.config.pointerLock && document.pointerLockElement === this.state.currentTarget) {\n      document.exitPointerLock();\n    }\n  }\n  preventScroll(event) {\n    if (this.state._preventScroll && event.cancelable) {\n      event.preventDefault();\n    }\n  }\n  setupScrollPrevention(event) {\n    this.state._preventScroll = false;\n    persistEvent(event);\n    const remove = this.eventStore.add(this.sharedConfig.window, 'touch', 'change', this.preventScroll.bind(this), {\n      passive: false\n    });\n    this.eventStore.add(this.sharedConfig.window, 'touch', 'end', remove);\n    this.eventStore.add(this.sharedConfig.window, 'touch', 'cancel', remove);\n    this.timeoutStore.add('startPointerDrag', this.startPointerDrag.bind(this), this.config.preventScrollDelay, event);\n  }\n  setupDelayTrigger(event) {\n    this.state._delayed = true;\n    this.timeoutStore.add('dragDelay', () => {\n      this.state._step = [0, 0];\n      this.startPointerDrag(event);\n    }, this.config.delay);\n  }\n  keyDown(event) {\n    const deltaFn = KEYS_DELTA_MAP[event.key];\n    if (deltaFn) {\n      const state = this.state;\n      const factor = event.shiftKey ? 10 : event.altKey ? 0.1 : 1;\n      this.start(event);\n      state._delta = deltaFn(this.config.keyboardDisplacement, factor);\n      state._keyboardActive = true;\n      V.addTo(state._movement, state._delta);\n      this.compute(event);\n      this.emit();\n    }\n  }\n  keyUp(event) {\n    if (!(event.key in KEYS_DELTA_MAP)) return;\n    this.state._keyboardActive = false;\n    this.setActive();\n    this.compute(event);\n    this.emit();\n  }\n  bind(bindFunction) {\n    const device = this.config.device;\n    bindFunction(device, 'start', this.pointerDown.bind(this));\n    if (this.config.pointerCapture) {\n      bindFunction(device, 'change', this.pointerMove.bind(this));\n      bindFunction(device, 'end', this.pointerUp.bind(this));\n      bindFunction(device, 'cancel', this.pointerUp.bind(this));\n      bindFunction('lostPointerCapture', '', this.pointerUp.bind(this));\n    }\n    if (this.config.keys) {\n      bindFunction('key', 'down', this.keyDown.bind(this));\n      bindFunction('key', 'up', this.keyUp.bind(this));\n    }\n    if (this.config.filterTaps) {\n      bindFunction('click', '', this.pointerClick.bind(this), {\n        capture: true,\n        passive: false\n      });\n    }\n  }\n}\nfunction persistEvent(event) {\n  'persist' in event && typeof event.persist === 'function' && event.persist();\n}\n\nconst isBrowser = typeof window !== 'undefined' && window.document && window.document.createElement;\nfunction supportsTouchEvents() {\n  return isBrowser && 'ontouchstart' in window;\n}\nfunction isTouchScreen() {\n  return supportsTouchEvents() || isBrowser && window.navigator.maxTouchPoints > 1;\n}\nfunction supportsPointerEvents() {\n  return isBrowser && 'onpointerdown' in window;\n}\nfunction supportsPointerLock() {\n  return isBrowser && 'exitPointerLock' in window.document;\n}\nfunction supportsGestureEvents() {\n  try {\n    return 'constructor' in GestureEvent;\n  } catch (e) {\n    return false;\n  }\n}\nconst SUPPORT = {\n  isBrowser,\n  gesture: supportsGestureEvents(),\n  touch: isTouchScreen(),\n  touchscreen: isTouchScreen(),\n  pointer: supportsPointerEvents(),\n  pointerLock: supportsPointerLock()\n};\n\nconst DEFAULT_PREVENT_SCROLL_DELAY = 250;\nconst DEFAULT_DRAG_DELAY = 180;\nconst DEFAULT_SWIPE_VELOCITY = 0.5;\nconst DEFAULT_SWIPE_DISTANCE = 50;\nconst DEFAULT_SWIPE_DURATION = 250;\nconst DEFAULT_KEYBOARD_DISPLACEMENT = 10;\nconst DEFAULT_DRAG_AXIS_THRESHOLD = {\n  mouse: 0,\n  touch: 0,\n  pen: 8\n};\nconst dragConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  device(_v, _k, {\n    pointer: {\n      touch = false,\n      lock = false,\n      mouse = false\n    } = {}\n  }) {\n    this.pointerLock = lock && SUPPORT.pointerLock;\n    if (SUPPORT.touch && touch) return 'touch';\n    if (this.pointerLock) return 'mouse';\n    if (SUPPORT.pointer && !mouse) return 'pointer';\n    if (SUPPORT.touch) return 'touch';\n    return 'mouse';\n  },\n  preventScrollAxis(value, _k, {\n    preventScroll\n  }) {\n    this.preventScrollDelay = typeof preventScroll === 'number' ? preventScroll : preventScroll || preventScroll === undefined && value ? DEFAULT_PREVENT_SCROLL_DELAY : undefined;\n    if (!SUPPORT.touchscreen || preventScroll === false) return undefined;\n    return value ? value : preventScroll !== undefined ? 'y' : undefined;\n  },\n  pointerCapture(_v, _k, {\n    pointer: {\n      capture = true,\n      buttons = 1,\n      keys = true\n    } = {}\n  }) {\n    this.pointerButtons = buttons;\n    this.keys = keys;\n    return !this.pointerLock && this.device === 'pointer' && capture;\n  },\n  threshold(value, _k, {\n    filterTaps = false,\n    tapsThreshold = 3,\n    axis = undefined\n  }) {\n    const threshold = V.toVector(value, filterTaps ? tapsThreshold : axis ? 1 : 0);\n    this.filterTaps = filterTaps;\n    this.tapsThreshold = tapsThreshold;\n    return threshold;\n  },\n  swipe({\n    velocity = DEFAULT_SWIPE_VELOCITY,\n    distance = DEFAULT_SWIPE_DISTANCE,\n    duration = DEFAULT_SWIPE_DURATION\n  } = {}) {\n    return {\n      velocity: this.transform(V.toVector(velocity)),\n      distance: this.transform(V.toVector(distance)),\n      duration\n    };\n  },\n  delay(value = 0) {\n    switch (value) {\n      case true:\n        return DEFAULT_DRAG_DELAY;\n      case false:\n        return 0;\n      default:\n        return value;\n    }\n  },\n  axisThreshold(value) {\n    if (!value) return DEFAULT_DRAG_AXIS_THRESHOLD;\n    return _objectSpread2(_objectSpread2({}, DEFAULT_DRAG_AXIS_THRESHOLD), value);\n  },\n  keyboardDisplacement(value = DEFAULT_KEYBOARD_DISPLACEMENT) {\n    return value;\n  }\n});\nif (process.env.NODE_ENV === 'development') {\n  Object.assign(dragConfigResolver, {\n    useTouch(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`useTouch\\` option has been renamed to \\`pointer.touch\\`. Use it as in \\`{ pointer: { touch: true } }\\`.`);\n      }\n      return NaN;\n    },\n    experimental_preventWindowScrollY(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`experimental_preventWindowScrollY\\` option has been renamed to \\`preventScroll\\`.`);\n      }\n      return NaN;\n    },\n    swipeVelocity(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeVelocity\\` option has been renamed to \\`swipe.velocity\\`. Use it as in \\`{ swipe: { velocity: 0.5 } }\\`.`);\n      }\n      return NaN;\n    },\n    swipeDistance(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeDistance\\` option has been renamed to \\`swipe.distance\\`. Use it as in \\`{ swipe: { distance: 50 } }\\`.`);\n      }\n      return NaN;\n    },\n    swipeDuration(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeDuration\\` option has been renamed to \\`swipe.duration\\`. Use it as in \\`{ swipe: { duration: 250 } }\\`.`);\n      }\n      return NaN;\n    }\n  });\n}\n\nfunction clampStateInternalMovementToBounds(state) {\n  const [ox, oy] = state.overflow;\n  const [dx, dy] = state._delta;\n  const [dirx, diry] = state._direction;\n  if (ox < 0 && dx > 0 && dirx < 0 || ox > 0 && dx < 0 && dirx > 0) {\n    state._movement[0] = state._movementBound[0];\n  }\n  if (oy < 0 && dy > 0 && diry < 0 || oy > 0 && dy < 0 && diry > 0) {\n    state._movement[1] = state._movementBound[1];\n  }\n}\n\nconst SCALE_ANGLE_RATIO_INTENT_DEG = 30;\nconst PINCH_WHEEL_RATIO = 100;\nclass PinchEngine extends Engine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'pinching');\n    _defineProperty(this, \"aliasKey\", 'da');\n  }\n  init() {\n    this.state.offset = [1, 0];\n    this.state.lastOffset = [1, 0];\n    this.state._pointerEvents = new Map();\n  }\n  reset() {\n    super.reset();\n    const state = this.state;\n    state._touchIds = [];\n    state.canceled = false;\n    state.cancel = this.cancel.bind(this);\n    state.turns = 0;\n  }\n  computeOffset() {\n    const {\n      type,\n      movement,\n      lastOffset\n    } = this.state;\n    if (type === 'wheel') {\n      this.state.offset = V.add(movement, lastOffset);\n    } else {\n      this.state.offset = [(1 + movement[0]) * lastOffset[0], movement[1] + lastOffset[1]];\n    }\n  }\n  computeMovement() {\n    const {\n      offset,\n      lastOffset\n    } = this.state;\n    this.state.movement = [offset[0] / lastOffset[0], offset[1] - lastOffset[1]];\n  }\n  axisIntent() {\n    const state = this.state;\n    const [_m0, _m1] = state._movement;\n    if (!state.axis) {\n      const axisMovementDifference = Math.abs(_m0) * SCALE_ANGLE_RATIO_INTENT_DEG - Math.abs(_m1);\n      if (axisMovementDifference < 0) state.axis = 'angle';else if (axisMovementDifference > 0) state.axis = 'scale';\n    }\n  }\n  restrictToAxis(v) {\n    if (this.config.lockDirection) {\n      if (this.state.axis === 'scale') v[1] = 0;else if (this.state.axis === 'angle') v[0] = 0;\n    }\n  }\n  cancel() {\n    const state = this.state;\n    if (state.canceled) return;\n    setTimeout(() => {\n      state.canceled = true;\n      state._active = false;\n      this.compute();\n      this.emit();\n    }, 0);\n  }\n  touchStart(event) {\n    this.ctrl.setEventIds(event);\n    const state = this.state;\n    const ctrlTouchIds = this.ctrl.touchIds;\n    if (state._active) {\n      if (state._touchIds.every(id => ctrlTouchIds.has(id))) return;\n    }\n    if (ctrlTouchIds.size < 2) return;\n    this.start(event);\n    state._touchIds = Array.from(ctrlTouchIds).slice(0, 2);\n    const payload = touchDistanceAngle(event, state._touchIds);\n    if (!payload) return;\n    this.pinchStart(event, payload);\n  }\n  pointerStart(event) {\n    if (event.buttons != null && event.buttons % 2 !== 1) return;\n    this.ctrl.setEventIds(event);\n    event.target.setPointerCapture(event.pointerId);\n    const state = this.state;\n    const _pointerEvents = state._pointerEvents;\n    const ctrlPointerIds = this.ctrl.pointerIds;\n    if (state._active) {\n      if (Array.from(_pointerEvents.keys()).every(id => ctrlPointerIds.has(id))) return;\n    }\n    if (_pointerEvents.size < 2) {\n      _pointerEvents.set(event.pointerId, event);\n    }\n    if (state._pointerEvents.size < 2) return;\n    this.start(event);\n    const payload = distanceAngle(...Array.from(_pointerEvents.values()));\n    if (!payload) return;\n    this.pinchStart(event, payload);\n  }\n  pinchStart(event, payload) {\n    const state = this.state;\n    state.origin = payload.origin;\n    this.computeValues([payload.distance, payload.angle]);\n    this.computeInitial();\n    this.compute(event);\n    this.emit();\n  }\n  touchMove(event) {\n    if (!this.state._active) return;\n    const payload = touchDistanceAngle(event, this.state._touchIds);\n    if (!payload) return;\n    this.pinchMove(event, payload);\n  }\n  pointerMove(event) {\n    const _pointerEvents = this.state._pointerEvents;\n    if (_pointerEvents.has(event.pointerId)) {\n      _pointerEvents.set(event.pointerId, event);\n    }\n    if (!this.state._active) return;\n    const payload = distanceAngle(...Array.from(_pointerEvents.values()));\n    if (!payload) return;\n    this.pinchMove(event, payload);\n  }\n  pinchMove(event, payload) {\n    const state = this.state;\n    const prev_a = state._values[1];\n    const delta_a = payload.angle - prev_a;\n    let delta_turns = 0;\n    if (Math.abs(delta_a) > 270) delta_turns += Math.sign(delta_a);\n    this.computeValues([payload.distance, payload.angle - 360 * delta_turns]);\n    state.origin = payload.origin;\n    state.turns = delta_turns;\n    state._movement = [state._values[0] / state._initial[0] - 1, state._values[1] - state._initial[1]];\n    this.compute(event);\n    this.emit();\n  }\n  touchEnd(event) {\n    this.ctrl.setEventIds(event);\n    if (!this.state._active) return;\n    if (this.state._touchIds.some(id => !this.ctrl.touchIds.has(id))) {\n      this.state._active = false;\n      this.compute(event);\n      this.emit();\n    }\n  }\n  pointerEnd(event) {\n    const state = this.state;\n    this.ctrl.setEventIds(event);\n    try {\n      event.target.releasePointerCapture(event.pointerId);\n    } catch (_unused) {}\n    if (state._pointerEvents.has(event.pointerId)) {\n      state._pointerEvents.delete(event.pointerId);\n    }\n    if (!state._active) return;\n    if (state._pointerEvents.size < 2) {\n      state._active = false;\n      this.compute(event);\n      this.emit();\n    }\n  }\n  gestureStart(event) {\n    if (event.cancelable) event.preventDefault();\n    const state = this.state;\n    if (state._active) return;\n    this.start(event);\n    this.computeValues([event.scale, event.rotation]);\n    state.origin = [event.clientX, event.clientY];\n    this.compute(event);\n    this.emit();\n  }\n  gestureMove(event) {\n    if (event.cancelable) event.preventDefault();\n    if (!this.state._active) return;\n    const state = this.state;\n    this.computeValues([event.scale, event.rotation]);\n    state.origin = [event.clientX, event.clientY];\n    const _previousMovement = state._movement;\n    state._movement = [event.scale - 1, event.rotation];\n    state._delta = V.sub(state._movement, _previousMovement);\n    this.compute(event);\n    this.emit();\n  }\n  gestureEnd(event) {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute(event);\n    this.emit();\n  }\n  wheel(event) {\n    const modifierKey = this.config.modifierKey;\n    if (modifierKey && !event[modifierKey]) return;\n    if (!this.state._active) this.wheelStart(event);else this.wheelChange(event);\n    this.timeoutStore.add('wheelEnd', this.wheelEnd.bind(this));\n  }\n  wheelStart(event) {\n    this.start(event);\n    this.wheelChange(event);\n  }\n  wheelChange(event) {\n    const isR3f = ('uv' in event);\n    if (!isR3f) {\n      if (event.cancelable) {\n        event.preventDefault();\n      }\n      if (process.env.NODE_ENV === 'development' && !event.defaultPrevented) {\n        console.warn(`[@use-gesture]: To properly support zoom on trackpads, try using the \\`target\\` option.\\n\\nThis message will only appear in development mode.`);\n      }\n    }\n    const state = this.state;\n    state._delta = [-wheelValues(event)[1] / PINCH_WHEEL_RATIO * state.offset[0], 0];\n    V.addTo(state._movement, state._delta);\n    clampStateInternalMovementToBounds(state);\n    this.state.origin = [event.clientX, event.clientY];\n    this.compute(event);\n    this.emit();\n  }\n  wheelEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    const device = this.config.device;\n    if (!!device) {\n      bindFunction(device, 'start', this[device + 'Start'].bind(this));\n      bindFunction(device, 'change', this[device + 'Move'].bind(this));\n      bindFunction(device, 'end', this[device + 'End'].bind(this));\n      bindFunction(device, 'cancel', this[device + 'End'].bind(this));\n    }\n    if (this.config.pinchOnWheel) {\n      bindFunction('wheel', '', this.wheel.bind(this), {\n        passive: false\n      });\n    }\n  }\n}\n\nconst pinchConfigResolver = _objectSpread2(_objectSpread2({}, commonConfigResolver), {}, {\n  device(_v, _k, {\n    shared,\n    pointer: {\n      touch = false\n    } = {}\n  }) {\n    const sharedConfig = shared;\n    if (sharedConfig.target && !SUPPORT.touch && SUPPORT.gesture) return 'gesture';\n    if (SUPPORT.touch && touch) return 'touch';\n    if (SUPPORT.touchscreen) {\n      if (SUPPORT.pointer) return 'pointer';\n      if (SUPPORT.touch) return 'touch';\n    }\n  },\n  bounds(_v, _k, {\n    scaleBounds = {},\n    angleBounds = {}\n  }) {\n    const _scaleBounds = state => {\n      const D = assignDefault(call(scaleBounds, state), {\n        min: -Infinity,\n        max: Infinity\n      });\n      return [D.min, D.max];\n    };\n    const _angleBounds = state => {\n      const A = assignDefault(call(angleBounds, state), {\n        min: -Infinity,\n        max: Infinity\n      });\n      return [A.min, A.max];\n    };\n    if (typeof scaleBounds !== 'function' && typeof angleBounds !== 'function') return [_scaleBounds(), _angleBounds()];\n    return state => [_scaleBounds(state), _angleBounds(state)];\n  },\n  threshold(value, _k, config) {\n    this.lockDirection = config.axis === 'lock';\n    const threshold = V.toVector(value, this.lockDirection ? [0.1, 3] : 0);\n    return threshold;\n  },\n  modifierKey(value) {\n    if (value === undefined) return 'ctrlKey';\n    return value;\n  },\n  pinchOnWheel(value = true) {\n    return value;\n  }\n});\n\nclass MoveEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'moving');\n  }\n  move(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    if (!this.state._active) this.moveStart(event);else this.moveChange(event);\n    this.timeoutStore.add('moveEnd', this.moveEnd.bind(this));\n  }\n  moveStart(event) {\n    this.start(event);\n    this.computeValues(pointerValues(event));\n    this.compute(event);\n    this.computeInitial();\n    this.emit();\n  }\n  moveChange(event) {\n    if (!this.state._active) return;\n    const values = pointerValues(event);\n    const state = this.state;\n    state._delta = V.sub(values, state._values);\n    V.addTo(state._movement, state._delta);\n    this.computeValues(values);\n    this.compute(event);\n    this.emit();\n  }\n  moveEnd(event) {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute(event);\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('pointer', 'change', this.move.bind(this));\n    bindFunction('pointer', 'leave', this.moveEnd.bind(this));\n  }\n}\n\nconst moveConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  mouseOnly: (value = true) => value\n});\n\nclass ScrollEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'scrolling');\n  }\n  scroll(event) {\n    if (!this.state._active) this.start(event);\n    this.scrollChange(event);\n    this.timeoutStore.add('scrollEnd', this.scrollEnd.bind(this));\n  }\n  scrollChange(event) {\n    if (event.cancelable) event.preventDefault();\n    const state = this.state;\n    const values = scrollValues(event);\n    state._delta = V.sub(values, state._values);\n    V.addTo(state._movement, state._delta);\n    this.computeValues(values);\n    this.compute(event);\n    this.emit();\n  }\n  scrollEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('scroll', '', this.scroll.bind(this));\n  }\n}\n\nconst scrollConfigResolver = coordinatesConfigResolver;\n\nclass WheelEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'wheeling');\n  }\n  wheel(event) {\n    if (!this.state._active) this.start(event);\n    this.wheelChange(event);\n    this.timeoutStore.add('wheelEnd', this.wheelEnd.bind(this));\n  }\n  wheelChange(event) {\n    const state = this.state;\n    state._delta = wheelValues(event);\n    V.addTo(state._movement, state._delta);\n    clampStateInternalMovementToBounds(state);\n    this.compute(event);\n    this.emit();\n  }\n  wheelEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('wheel', '', this.wheel.bind(this));\n  }\n}\n\nconst wheelConfigResolver = coordinatesConfigResolver;\n\nclass HoverEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'hovering');\n  }\n  enter(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    this.start(event);\n    this.computeValues(pointerValues(event));\n    this.compute(event);\n    this.emit();\n  }\n  leave(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    const state = this.state;\n    if (!state._active) return;\n    state._active = false;\n    const values = pointerValues(event);\n    state._movement = state._delta = V.sub(values, state._values);\n    this.computeValues(values);\n    this.compute(event);\n    state.delta = state.movement;\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('pointer', 'enter', this.enter.bind(this));\n    bindFunction('pointer', 'leave', this.leave.bind(this));\n  }\n}\n\nconst hoverConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  mouseOnly: (value = true) => value\n});\n\nconst EngineMap = new Map();\nconst ConfigResolverMap = new Map();\nfunction registerAction(action) {\n  EngineMap.set(action.key, action.engine);\n  ConfigResolverMap.set(action.key, action.resolver);\n}\nconst dragAction = {\n  key: 'drag',\n  engine: DragEngine,\n  resolver: dragConfigResolver\n};\nconst hoverAction = {\n  key: 'hover',\n  engine: HoverEngine,\n  resolver: hoverConfigResolver\n};\nconst moveAction = {\n  key: 'move',\n  engine: MoveEngine,\n  resolver: moveConfigResolver\n};\nconst pinchAction = {\n  key: 'pinch',\n  engine: PinchEngine,\n  resolver: pinchConfigResolver\n};\nconst scrollAction = {\n  key: 'scroll',\n  engine: ScrollEngine,\n  resolver: scrollConfigResolver\n};\nconst wheelAction = {\n  key: 'wheel',\n  engine: WheelEngine,\n  resolver: wheelConfigResolver\n};\n\nexport { ConfigResolverMap as C, EngineMap as E, SUPPORT as S, _objectSpread2 as _, _defineProperty as a, touchIds as b, chain as c, toHandlerProp as d, dragAction as e, pinchAction as f, hoverAction as h, isTouch as i, moveAction as m, parseProp as p, registerAction as r, scrollAction as s, toDomEventType as t, wheelAction as w };\n","import { S as SUPPORT, C as ConfigResolverMap, _ as _objectSpread2, a as _defineProperty, t as toDomEventType, i as isTouch, b as touchIds, E as EngineMap, c as chain, p as parseProp, d as toHandlerProp } from './actions-94b581a0.esm.js';\nimport './maths-0ab39ae9.esm.js';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\n\nconst sharedConfigResolver = {\n  target(value) {\n    if (value) {\n      return () => 'current' in value ? value.current : value;\n    }\n    return undefined;\n  },\n  enabled(value = true) {\n    return value;\n  },\n  window(value = SUPPORT.isBrowser ? window : undefined) {\n    return value;\n  },\n  eventOptions({\n    passive = true,\n    capture = false\n  } = {}) {\n    return {\n      passive,\n      capture\n    };\n  },\n  transform(value) {\n    return value;\n  }\n};\n\nconst _excluded = [\"target\", \"eventOptions\", \"window\", \"enabled\", \"transform\"];\nfunction resolveWith(config = {}, resolvers) {\n  const result = {};\n  for (const [key, resolver] of Object.entries(resolvers)) {\n    switch (typeof resolver) {\n      case 'function':\n        if (process.env.NODE_ENV === 'development') {\n          const r = resolver.call(result, config[key], key, config);\n          if (!Number.isNaN(r)) result[key] = r;\n        } else {\n          result[key] = resolver.call(result, config[key], key, config);\n        }\n        break;\n      case 'object':\n        result[key] = resolveWith(config[key], resolver);\n        break;\n      case 'boolean':\n        if (resolver) result[key] = config[key];\n        break;\n    }\n  }\n  return result;\n}\nfunction parse(newConfig, gestureKey, _config = {}) {\n  const _ref = newConfig,\n    {\n      target,\n      eventOptions,\n      window,\n      enabled,\n      transform\n    } = _ref,\n    rest = _objectWithoutProperties(_ref, _excluded);\n  _config.shared = resolveWith({\n    target,\n    eventOptions,\n    window,\n    enabled,\n    transform\n  }, sharedConfigResolver);\n  if (gestureKey) {\n    const resolver = ConfigResolverMap.get(gestureKey);\n    _config[gestureKey] = resolveWith(_objectSpread2({\n      shared: _config.shared\n    }, rest), resolver);\n  } else {\n    for (const key in rest) {\n      const resolver = ConfigResolverMap.get(key);\n      if (resolver) {\n        _config[key] = resolveWith(_objectSpread2({\n          shared: _config.shared\n        }, rest[key]), resolver);\n      } else if (process.env.NODE_ENV === 'development') {\n        if (!['drag', 'pinch', 'scroll', 'wheel', 'move', 'hover'].includes(key)) {\n          if (key === 'domTarget') {\n            throw Error(`[@use-gesture]: \\`domTarget\\` option has been renamed to \\`target\\`.`);\n          }\n          console.warn(`[@use-gesture]: Unknown config key \\`${key}\\` was used. Please read the documentation for further information.`);\n        }\n      }\n    }\n  }\n  return _config;\n}\n\nclass EventStore {\n  constructor(ctrl, gestureKey) {\n    _defineProperty(this, \"_listeners\", new Set());\n    this._ctrl = ctrl;\n    this._gestureKey = gestureKey;\n  }\n  add(element, device, action, handler, options) {\n    const listeners = this._listeners;\n    const type = toDomEventType(device, action);\n    const _options = this._gestureKey ? this._ctrl.config[this._gestureKey].eventOptions : {};\n    const eventOptions = _objectSpread2(_objectSpread2({}, _options), options);\n    element.addEventListener(type, handler, eventOptions);\n    const remove = () => {\n      element.removeEventListener(type, handler, eventOptions);\n      listeners.delete(remove);\n    };\n    listeners.add(remove);\n    return remove;\n  }\n  clean() {\n    this._listeners.forEach(remove => remove());\n    this._listeners.clear();\n  }\n}\n\nclass TimeoutStore {\n  constructor() {\n    _defineProperty(this, \"_timeouts\", new Map());\n  }\n  add(key, callback, ms = 140, ...args) {\n    this.remove(key);\n    this._timeouts.set(key, window.setTimeout(callback, ms, ...args));\n  }\n  remove(key) {\n    const timeout = this._timeouts.get(key);\n    if (timeout) window.clearTimeout(timeout);\n  }\n  clean() {\n    this._timeouts.forEach(timeout => void window.clearTimeout(timeout));\n    this._timeouts.clear();\n  }\n}\n\nclass Controller {\n  constructor(handlers) {\n    _defineProperty(this, \"gestures\", new Set());\n    _defineProperty(this, \"_targetEventStore\", new EventStore(this));\n    _defineProperty(this, \"gestureEventStores\", {});\n    _defineProperty(this, \"gestureTimeoutStores\", {});\n    _defineProperty(this, \"handlers\", {});\n    _defineProperty(this, \"config\", {});\n    _defineProperty(this, \"pointerIds\", new Set());\n    _defineProperty(this, \"touchIds\", new Set());\n    _defineProperty(this, \"state\", {\n      shared: {\n        shiftKey: false,\n        metaKey: false,\n        ctrlKey: false,\n        altKey: false\n      }\n    });\n    resolveGestures(this, handlers);\n  }\n  setEventIds(event) {\n    if (isTouch(event)) {\n      this.touchIds = new Set(touchIds(event));\n      return this.touchIds;\n    } else if ('pointerId' in event) {\n      if (event.type === 'pointerup' || event.type === 'pointercancel') this.pointerIds.delete(event.pointerId);else if (event.type === 'pointerdown') this.pointerIds.add(event.pointerId);\n      return this.pointerIds;\n    }\n  }\n  applyHandlers(handlers, nativeHandlers) {\n    this.handlers = handlers;\n    this.nativeHandlers = nativeHandlers;\n  }\n  applyConfig(config, gestureKey) {\n    this.config = parse(config, gestureKey, this.config);\n  }\n  clean() {\n    this._targetEventStore.clean();\n    for (const key of this.gestures) {\n      this.gestureEventStores[key].clean();\n      this.gestureTimeoutStores[key].clean();\n    }\n  }\n  effect() {\n    if (this.config.shared.target) this.bind();\n    return () => this._targetEventStore.clean();\n  }\n  bind(...args) {\n    const sharedConfig = this.config.shared;\n    const props = {};\n    let target;\n    if (sharedConfig.target) {\n      target = sharedConfig.target();\n      if (!target) return;\n    }\n    if (sharedConfig.enabled) {\n      for (const gestureKey of this.gestures) {\n        const gestureConfig = this.config[gestureKey];\n        const bindFunction = bindToProps(props, gestureConfig.eventOptions, !!target);\n        if (gestureConfig.enabled) {\n          const Engine = EngineMap.get(gestureKey);\n          new Engine(this, args, gestureKey).bind(bindFunction);\n        }\n      }\n      const nativeBindFunction = bindToProps(props, sharedConfig.eventOptions, !!target);\n      for (const eventKey in this.nativeHandlers) {\n        nativeBindFunction(eventKey, '', event => this.nativeHandlers[eventKey](_objectSpread2(_objectSpread2({}, this.state.shared), {}, {\n          event,\n          args\n        })), undefined, true);\n      }\n    }\n    for (const handlerProp in props) {\n      props[handlerProp] = chain(...props[handlerProp]);\n    }\n    if (!target) return props;\n    for (const handlerProp in props) {\n      const {\n        device,\n        capture,\n        passive\n      } = parseProp(handlerProp);\n      this._targetEventStore.add(target, device, '', props[handlerProp], {\n        capture,\n        passive\n      });\n    }\n  }\n}\nfunction setupGesture(ctrl, gestureKey) {\n  ctrl.gestures.add(gestureKey);\n  ctrl.gestureEventStores[gestureKey] = new EventStore(ctrl, gestureKey);\n  ctrl.gestureTimeoutStores[gestureKey] = new TimeoutStore();\n}\nfunction resolveGestures(ctrl, internalHandlers) {\n  if (internalHandlers.drag) setupGesture(ctrl, 'drag');\n  if (internalHandlers.wheel) setupGesture(ctrl, 'wheel');\n  if (internalHandlers.scroll) setupGesture(ctrl, 'scroll');\n  if (internalHandlers.move) setupGesture(ctrl, 'move');\n  if (internalHandlers.pinch) setupGesture(ctrl, 'pinch');\n  if (internalHandlers.hover) setupGesture(ctrl, 'hover');\n}\nconst bindToProps = (props, eventOptions, withPassiveOption) => (device, action, handler, options = {}, isNative = false) => {\n  var _options$capture, _options$passive;\n  const capture = (_options$capture = options.capture) !== null && _options$capture !== void 0 ? _options$capture : eventOptions.capture;\n  const passive = (_options$passive = options.passive) !== null && _options$passive !== void 0 ? _options$passive : eventOptions.passive;\n  let handlerProp = isNative ? device : toHandlerProp(device, action, capture);\n  if (withPassiveOption && passive) handlerProp += 'Passive';\n  props[handlerProp] = props[handlerProp] || [];\n  props[handlerProp].push(handler);\n};\n\nconst RE_NOT_NATIVE = /^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;\nfunction sortHandlers(_handlers) {\n  const native = {};\n  const handlers = {};\n  const actions = new Set();\n  for (let key in _handlers) {\n    if (RE_NOT_NATIVE.test(key)) {\n      actions.add(RegExp.lastMatch);\n      handlers[key] = _handlers[key];\n    } else {\n      native[key] = _handlers[key];\n    }\n  }\n  return [handlers, native, actions];\n}\nfunction registerGesture(actions, handlers, handlerKey, key, internalHandlers, config) {\n  if (!actions.has(handlerKey)) return;\n  if (!EngineMap.has(key)) {\n    if (process.env.NODE_ENV === 'development') {\n      console.warn(`[@use-gesture]: You've created a custom handler that that uses the \\`${key}\\` gesture but isn't properly configured.\\n\\nPlease add \\`${key}Action\\` when creating your handler.`);\n    }\n    return;\n  }\n  const startKey = handlerKey + 'Start';\n  const endKey = handlerKey + 'End';\n  const fn = state => {\n    let memo = undefined;\n    if (state.first && startKey in handlers) handlers[startKey](state);\n    if (handlerKey in handlers) memo = handlers[handlerKey](state);\n    if (state.last && endKey in handlers) handlers[endKey](state);\n    return memo;\n  };\n  internalHandlers[key] = fn;\n  config[key] = config[key] || {};\n}\nfunction parseMergedHandlers(mergedHandlers, mergedConfig) {\n  const [handlers, nativeHandlers, actions] = sortHandlers(mergedHandlers);\n  const internalHandlers = {};\n  registerGesture(actions, handlers, 'onDrag', 'drag', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onWheel', 'wheel', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onScroll', 'scroll', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onPinch', 'pinch', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onMove', 'move', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onHover', 'hover', internalHandlers, mergedConfig);\n  return {\n    handlers: internalHandlers,\n    config: mergedConfig,\n    nativeHandlers\n  };\n}\n\nexport { Controller, parseMergedHandlers };\n","import { registerAction, dragAction, pinchAction, wheelAction, scrollAction, moveAction, hoverAction } from '@use-gesture/core/actions';\nexport * from '@use-gesture/core/actions';\nimport { Controller, parseMergedHandlers } from '@use-gesture/core';\nexport * from '@use-gesture/core/utils';\nexport * from '@use-gesture/core/types';\n\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\n\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n\nclass Recognizer {\n  constructor(target, handlers, config, gestureKey, nativeHandlers) {\n    this._target = target;\n    this._gestureKey = gestureKey;\n    this._ctrl = new Controller(handlers);\n    this._ctrl.applyHandlers(handlers, nativeHandlers);\n    this._ctrl.applyConfig(_objectSpread2(_objectSpread2({}, config), {}, {\n      target\n    }), gestureKey);\n    this._ctrl.effect();\n  }\n  destroy() {\n    this._ctrl.clean();\n  }\n  setConfig(config) {\n    this._ctrl.clean();\n    this._ctrl.applyConfig(_objectSpread2(_objectSpread2({}, config), {}, {\n      target: this._target\n    }), this._gestureKey);\n    this._ctrl.effect();\n  }\n}\n\nconst DragGesture = function DragGesture(target, handler, config) {\n  registerAction(dragAction);\n  return new Recognizer(target, {\n    drag: handler\n  }, config || {}, 'drag');\n};\n\nconst PinchGesture = function PinchGesture(target, handler, config) {\n  registerAction(pinchAction);\n  return new Recognizer(target, {\n    pinch: handler\n  }, config || {}, 'pinch');\n};\n\nconst WheelGesture = function WheelGesture(target, handler, config) {\n  registerAction(wheelAction);\n  return new Recognizer(target, {\n    wheel: handler\n  }, config || {}, 'wheel');\n};\n\nconst ScrollGesture = function ScrollGesture(target, handler, config) {\n  registerAction(scrollAction);\n  return new Recognizer(target, {\n    scroll: handler\n  }, config || {}, 'scroll');\n};\n\nconst MoveGesture = function MoveGesture(target, handler, config) {\n  registerAction(moveAction);\n  return new Recognizer(target, {\n    move: handler\n  }, config || {}, 'move');\n};\n\nconst HoverGesture = function HoverGesture(target, handler, config) {\n  registerAction(hoverAction);\n  return new Recognizer(target, {\n    hover: handler\n  }, config || {}, 'hover');\n};\n\nfunction createGesture(actions) {\n  actions.forEach(registerAction);\n  return function (target, _handlers, _config) {\n    const {\n      handlers,\n      nativeHandlers,\n      config\n    } = parseMergedHandlers(_handlers, _config || {});\n    return new Recognizer(target, handlers, config, undefined, nativeHandlers);\n  };\n}\n\nconst Gesture = function Gesture(target, handlers, config) {\n  const gestureFunction = createGesture([dragAction, pinchAction, scrollAction, wheelAction, moveAction, hoverAction]);\n  return gestureFunction(target, handlers, config || {});\n};\n\nexport { DragGesture, Gesture, HoverGesture, MoveGesture, PinchGesture, ScrollGesture, WheelGesture, createGesture };\n","export class Region {\n  constructor() {\n    this._bottomLeft = { x: 0, y: 0 };\n    this._topRight = { x: 0, y: 0 };\n  }\n\n  get top() {\n    return this._topRight.y;\n  }\n\n  get bottom() {\n    return this._bottomLeft.y;\n  }\n\n  get left() {\n    return this._bottomLeft.x;\n  }\n\n  get right() {\n    return this._topRight.x;\n  }\n\n  get topLeft() {\n    return { x: this.left, y: this.top };\n  }\n\n  get topRight() {\n    return { ...this._topRight };\n  }\n\n  get bottomLeft() {\n    return { ...this._bottomLeft };\n  }\n\n  get bottomRight() {\n    return { x: this.right, y: this.bottom };\n  }\n\n  get width() {\n    return this._topRight.x - this._bottomLeft.x;\n  }\n\n  get height() {\n    return this.topRight.y - this._bottomLeft.y;\n  }\n\n  get centreX() {\n    return this.left + this.width / 2;\n  }\n\n  get centreY() {\n    return this.bottom + this.height / 2;\n  }\n\n  set(bottomLeft, topRight) {\n    this._bottomLeft.x = bottomLeft.x;\n    this._bottomLeft.y = bottomLeft.y;\n    this._topRight.x = topRight.x;\n    this._topRight.y = topRight.y;\n  }\n\n  adjustAspectRatio(canvasWidth, canvasHeight) {\n    if (canvasWidth >= canvasHeight) {\n      const aspectRatio = canvasWidth / canvasHeight;\n      const widthDelta = aspectRatio * this.height - this.width;\n      const widthDeltaHalf = widthDelta / 2;\n      this._bottomLeft.x -= widthDeltaHalf;\n      this._topRight.x += widthDeltaHalf;\n    }\n\n    if (canvasWidth < canvasHeight) {\n      const aspectRatio = canvasHeight / canvasWidth;\n      const heightDelta = aspectRatio * this.width - this.height;\n      const heightDeltaHalf = heightDelta / 2;\n      this._bottomLeft.y -= heightDeltaHalf;\n      this._topRight.y += heightDeltaHalf;\n    }\n  }\n\n  mouseToRegion(canvas, mouseX, mouseY) {\n    const widthRatio = this.width / canvas.width;\n    const heightRatio = this.height / canvas.height;\n    const offsetRatioX = mouseX * widthRatio;\n    const offsetRatioY = mouseY * heightRatio;\n    return {\n      regionMouseX: this.left + offsetRatioX,\n      regionMouseY: this.bottom + offsetRatioY,\n    };\n  }\n\n  drag(canvas, mouseDeltaX, mouseDeltaY) {\n    const widthRatio = this.width / canvas.width;\n    const heightRatio = this.height / canvas.height;\n    const regionDeltaX = mouseDeltaX * widthRatio;\n    const regionDeltaY = mouseDeltaY * heightRatio;\n    this._bottomLeft.x -= regionDeltaX;\n    this._bottomLeft.y -= regionDeltaY;\n    this._topRight.x -= regionDeltaX;\n    this._topRight.y -= regionDeltaY;\n  }\n\n  recentre(regionMouseX, regionMouseY) {\n    const translationX = regionMouseX - this.centreX;\n    const translationY = regionMouseY - this.centreY;\n    this._bottomLeft.x += translationX;\n    this._bottomLeft.y += translationY;\n    this._topRight.x += translationX;\n    this._topRight.y += translationY;\n  }\n\n  panX(percent) {\n    const widthDelta = (this.width / 100) * percent;\n    this._bottomLeft.x -= widthDelta;\n    this._topRight.x -= widthDelta;\n  }\n\n  panY(percent) {\n    const heightDelta = (this.height / 100) * percent;\n    this._bottomLeft.y -= heightDelta;\n    this._topRight.y -= heightDelta;\n  }\n\n  zoom(percent) {\n    const widthDelta = (this.width / 100) * percent;\n    const widthDeltaHalf = widthDelta / 2;\n    const heightDelta = (this.height / 100) * percent;\n    const heightDeltaHalf = heightDelta / 2;\n    this._bottomLeft.x += widthDeltaHalf;\n    this._bottomLeft.y += heightDeltaHalf;\n    this._topRight.x -= widthDeltaHalf;\n    this._topRight.y -= heightDeltaHalf;\n  }\n}\n","export const clamp = (min, max, value) => Math.max(min, Math.min(max, value));\n\nexport const randomFloat = (min, max) => {\n  return Math.random() * (max - min) + min;\n};\n\nexport const randomInt = (min, max) => {\n  return Math.floor(randomFloat(min, max));\n};\n\nexport const randomElement = (elements) => {\n  const randomIndex = randomInt(0, elements.length);\n  return elements[randomIndex];\n};\n\nexport const randomPanSpeed = () => randomFloat(-0.1, 0.1);\n\nexport const randomZoomSpeed = () => randomFloat(0.01, 1.0);\n\nexport const drawThumbnail = (pixels, canvas, width, height) => {\n  canvas.width = width;\n  canvas.height = height;\n  const canvasCtx2d = canvas.getContext(\"2d\");\n\n  const pixelsClampedArray = new Uint8ClampedArray(pixels);\n  const imageData = new ImageData(pixelsClampedArray, width, height);\n  canvasCtx2d.putImageData(imageData, 0, 0);\n\n  // Seems we need to flip the image vertically.\n  // https://stackoverflow.com/a/41970080\n  canvasCtx2d.scale(1, -1);\n  canvasCtx2d.translate(0, -height);\n  canvasCtx2d.drawImage(canvas, 0, 0);\n};\n","export const INITIAL_ITERATIONS = 128;\nexport const MIN_ITERATIONS = 16;\nexport const MAX_ITERATIONS_MANUAL = 4096;\nexport const MAX_ITERATIONS_AUTO = 256;\nexport const DELTA_ITERATIONS = 16;\nexport const FRACTAL_SET_ID_MANDELBROT = 0;\nexport const FRACTAL_SET_ID_JULIA = 1;\n\nexport const COLOUR_MAP_NAMES = [\n  \"jet\",\n  \"hsv\",\n  \"hot\",\n  \"cool\",\n  \"warm\",\n  \"spring\",\n  \"summer\",\n  \"autumn\",\n  \"winter\",\n  \"bone\",\n  \"copper\",\n  \"greys\",\n  \"YIOrRd\",\n  \"bluered\",\n  \"RdBu\",\n  \"picnic\",\n  \"rainbow\",\n  \"portland\",\n  \"blackbody\",\n  \"earth\",\n  \"electric\",\n  \"viridis\",\n  \"inferno\",\n  \"magma\",\n  \"plasma\",\n  \"rainbow-soft\",\n  \"bathymetry\",\n  \"cdom\",\n  \"chlorophyll\",\n  \"density\",\n  \"freesurface-blue\",\n  \"freesurface-red\",\n];\n\nexport const INITIAL_BOOKMARK = {\n  fractalSetId: FRACTAL_SET_ID_MANDELBROT,\n  juliaConstant: { x: 0, y: 0 },\n  colourMapId: 0,\n  regionBottomLeft: { x: -0.22, y: -0.7 },\n  regionTopRight: { x: -0.21, y: -0.69 },\n  maxIterations: INITIAL_ITERATIONS,\n};\n\nexport const HOME_BOOKMARK = {\n  fractalSetId: FRACTAL_SET_ID_MANDELBROT,\n  juliaConstant: { x: 0, y: 0 },\n  colourMapId: 0,\n  regionBottomLeft: { x: -2.25, y: -1.5 },\n  regionTopRight: { x: 0.75, y: 1.5 },\n  maxIterations: INITIAL_ITERATIONS,\n};\n","import * as C from \"./constants\";\nimport * as U from \"./utils\";\n\nconst THUMBNAIL_SIZE = 64;\n\nexport const configureUI = ({\n  isWebGL2,\n  renderThumbnail,\n  addBookmark,\n  updateBookmark,\n  deleteBookmark,\n  switchToBookmark,\n  fractalSets,\n  colourMaps,\n  onModalOpen,\n  onModalClose,\n}) => {\n  const presentBookmarkModal = (bookmark) => {\n    console.log(\"[presentBookmarkModal]\", \"bookmark:\", bookmark);\n    const bookmarkModal = $(\"#bookmarkModal\")\n      .on(\"show.bs.modal\", onModalOpen)\n      .on(\"hide.bs.modal\", onModalClose);\n    const hasId = Number.isInteger(bookmark.id);\n    const title = hasId ? \"Edit Bookmark\" : \"Create Bookmark\";\n    $(\".modal-title\", bookmarkModal).text(title);\n    $('input[type=\"submit\"]', bookmarkModal)\n      .off(\"click\")\n      .on(\"click\", (e) => {\n        e.preventDefault();\n        bookmark.name = $(\"#name\", bookmarkModal).val();\n        hasId ? updateBookmark(bookmark) : addBookmark(bookmark);\n        bookmarkModal.modal(\"hide\");\n      });\n    const thumbnailCanvas = $(\"#thumbnail-canvas\", bookmarkModal).get(0);\n    const pixels = renderThumbnail(THUMBNAIL_SIZE, THUMBNAIL_SIZE, bookmark);\n    U.drawThumbnail(pixels, thumbnailCanvas, THUMBNAIL_SIZE, THUMBNAIL_SIZE);\n    $(\"#name\", bookmarkModal).val(bookmark.name).focus();\n    $(\".fractal-set\", bookmarkModal).text(fractalSets.get(bookmark.fractalSetId).name);\n    const colourMapSelect = $(\"#colour-map-select\", bookmarkModal).empty();\n    for (const [colourMapId, colourMap] of colourMaps) {\n      const selected = colourMapId === bookmark.colourMapId ? \"selected\" : \"\";\n      colourMapSelect.append(\n        `<option value=\"${colourMapId}\" ${selected}>${colourMap.name}</option>`\n      );\n    }\n    colourMapSelect.on(\"change\", (e) => {\n      bookmark.colourMapId = Number(e.target.value);\n      const pixels = renderThumbnail(THUMBNAIL_SIZE, THUMBNAIL_SIZE, bookmark);\n      U.drawThumbnail(pixels, thumbnailCanvas, THUMBNAIL_SIZE, THUMBNAIL_SIZE);\n    });\n    const maxIterations = $(\"#max-iterations\", bookmarkModal);\n    maxIterations.text(bookmark.maxIterations);\n    const maxIterationsRange = $(\"#max-iterations-range\", bookmarkModal);\n    if (isWebGL2) {\n      maxIterationsRange\n        .attr(\"min\", C.MIN_ITERATIONS)\n        .attr(\"max\", C.MAX_ITERATIONS_MANUAL)\n        .attr(\"step\", C.DELTA_ITERATIONS)\n        .val(bookmark.maxIterations);\n      maxIterationsRange.on(\"input\", (e) => {\n        bookmark.maxIterations = Number(e.target.value);\n        maxIterations.text(bookmark.maxIterations);\n        const pixels = renderThumbnail(THUMBNAIL_SIZE, THUMBNAIL_SIZE, bookmark);\n        U.drawThumbnail(pixels, thumbnailCanvas, THUMBNAIL_SIZE, THUMBNAIL_SIZE);\n      });\n    } else {\n      maxIterationsRange.hide();\n    }\n    $(\".region-bottom-left\", bookmarkModal).text(\n      `(${bookmark.regionBottomLeft.x}, ${bookmark.regionBottomLeft.y})`\n    );\n    $(\".region-top-right\", bookmarkModal).text(\n      `(${bookmark.regionTopRight.x}, ${bookmark.regionTopRight.y})`\n    );\n    const juliaConstantP = $(\".julia-constant\", bookmarkModal);\n    const juliaConstantDiv = juliaConstantP.closest(\"div\");\n    if (bookmark.fractalSetId === C.FRACTAL_SET_ID_JULIA) {\n      juliaConstantP.text(`(${bookmark.juliaConstant.x}, ${bookmark.juliaConstant.y})`);\n      juliaConstantDiv.show();\n    } else {\n      juliaConstantDiv.hide();\n    }\n    bookmarkModal.modal();\n  };\n\n  const presentManageBookmarksModal = (bookmarks) => {\n    console.log(\"[presentManageBookmarksModal]\", \"bookmarks:\", bookmarks);\n    const manageBookmarksModal = $(\"#manageBookmarksModal\")\n      .on(\"show.bs.modal\", onModalOpen)\n      .on(\"hide.bs.modal\", onModalClose);\n    const tbody = $(\"tbody\", manageBookmarksModal).empty();\n    const invokeHandler = (handler, bookmark) => () => {\n      manageBookmarksModal.modal(\"hide\");\n      handler(bookmark);\n    };\n    const onSwitchTo = (bookmark) => switchToBookmark(bookmark);\n    const onEdit = (bookmark) => {\n      const bookmarkClone = { ...bookmark };\n      presentBookmarkModal(bookmarkClone);\n    };\n    const onDelete = (bookmark) => {\n      deleteBookmark(bookmark);\n    };\n    const bookmarkRowTemplate = document.getElementById(\"bookmark-row-template\");\n    bookmarks.forEach((bookmark) => {\n      const tr = document.importNode(bookmarkRowTemplate.content, true);\n      const name = tr.querySelector(\":nth-child(2)\");\n      const editButton = tr.querySelector(\":nth-child(3) i\");\n      const deleteButton = tr.querySelector(\":nth-child(4) i\");\n      const thumbnailCanvas = tr.querySelector(\":nth-child(1) canvas\");\n      const pixels = renderThumbnail(THUMBNAIL_SIZE, THUMBNAIL_SIZE, bookmark);\n      U.drawThumbnail(pixels, thumbnailCanvas, THUMBNAIL_SIZE, THUMBNAIL_SIZE);\n      name.innerText = bookmark.name;\n      thumbnailCanvas.addEventListener(\"click\", invokeHandler(onSwitchTo, bookmark));\n      editButton.addEventListener(\"click\", invokeHandler(onEdit, bookmark));\n      deleteButton.addEventListener(\"click\", invokeHandler(onDelete, bookmark));\n      tbody.append(tr);\n    });\n    manageBookmarksModal.modal();\n  };\n\n  return {\n    presentBookmarkModal,\n    presentManageBookmarksModal,\n  };\n};\n","import colormap from \"colormap\";\nimport * as glm from \"gl-matrix\";\nimport { DragGesture } from \"@use-gesture/vanilla\";\nimport { configureConfigurationChooser } from \"./configuration-chooser\";\nimport { configureOverlay } from \"./overlay\";\nimport { configureThumbnail } from \"./thumbnail\";\nimport { configureUI } from \"./ui\";\nimport { Region } from \"./region\";\nimport * as C from \"./constants\";\nimport * as U from \"./utils\";\n\nimport loopShaderSourceWebGL1 from \"../shaders/webgl1/loop.glsl\";\nimport vertexShaderSourceWebGL1 from \"../shaders/webgl1/shader.vert.glsl\";\nimport mandelbrotShaderSourceWebGL1 from \"../shaders/webgl1/mandelbrot.frag.glsl\";\nimport juliaShaderSourceWebGL1 from \"../shaders/webgl1/julia.frag.glsl\";\n\nimport loopShaderSourceWebGL2 from \"../shaders/webgl2/loop.glsl\";\nimport vertexShaderSourceWebGL2 from \"../shaders/webgl2/shader.vert.glsl\";\nimport mandelbrotShaderSourceWebGL2 from \"../shaders/webgl2/mandelbrot.frag.glsl\";\nimport juliaShaderSourceWebGL2 from \"../shaders/webgl2/julia.frag.glsl\";\n\nlet queryParamOptions;\nlet canvas;\nlet overlay;\nlet thumbnail;\nlet configurationChooser;\nlet gl;\nlet isWebGL2 = false;\nlet ui;\n\nconst createColourMapTexture = (colourMap, textureUnit) => {\n  const texture = gl.createTexture();\n  gl.activeTexture(gl.TEXTURE0 + textureUnit);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  const pixels = new Uint8Array(colourMap.map((value) => value * 255));\n  const width = colourMap.length / 4;\n  gl.texImage2D(\n    gl.TEXTURE_2D, // target\n    0, // level\n    gl.RGBA, // internalFormat\n    width, // width\n    1, // height\n    0, // border\n    gl.RGBA, // format\n    gl.UNSIGNED_BYTE, // type\n    pixels // pixels\n  );\n};\n\nconst loadColourMap = (name, textureUnit) => {\n  const colourMap = colormap({\n    colormap: name,\n    nshades: 256,\n    format: \"float\",\n  }).flat();\n  createColourMapTexture(colourMap, textureUnit);\n  return {\n    name,\n    colourMap,\n    textureUnit,\n  };\n};\n\nconst loadColourMaps = () => {\n  const maxTextureUnits = gl.getParameter(gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS);\n  const maxColourMaps = maxTextureUnits - 1;\n  C.COLOUR_MAP_NAMES.slice(0, maxColourMaps).forEach((colourMapName, index) => {\n    // We want to reserve gl.TEXTURE0 for rendering thumbnails\n    const textureUnit = index + 1;\n    colourMaps.set(index, loadColourMap(colourMapName, textureUnit));\n  });\n};\n\nconst fractalSets = new Map();\nconst colourMaps = new Map();\n\nconst CHANGE_REGION_INTERVAL_SECONDS = 10;\n\nlet currentMaxIterations = C.INITIAL_ITERATIONS;\nlet currentFractalSetId = undefined;\nlet currentFractalSet = undefined;\nlet currentJuliaConstant = undefined;\nlet currentColourMapId = undefined;\nlet currentColourMap = undefined;\nconst region = new Region();\nlet panSpeedX = 0;\nlet panSpeedY = 0;\nlet zoomSpeed = 0;\nlet panning = false;\nlet selectingRegion = false;\nlet selectingRegionInitialPt = undefined;\nlet selectingRegionCurrentPt = undefined;\nlet lastMousePt;\nlet bookmarkMode = false;\nlet bookmarks = new Map();\nlet nextBookmarkId = 0;\nlet modalOpen = false;\nlet configurationSummaryOpen = false;\nlet smoothColouring = true;\nlet nextConfiguration = undefined;\nlet nextConfigurationCount = 0;\n\nconst onModalOpen = () => {\n  modalOpen = true;\n};\n\nconst onModalClose = () => {\n  modalOpen = false;\n};\n\nconst loadBookmarks = (bookmarks) => {\n  const entries = JSON.parse(localStorage.bookmarks || \"[]\");\n  for (const [id, bookmark] of entries) {\n    const { thumbnail: _thumbnail, ...bookmarkWithoutThumbnail } = bookmark;\n    bookmarks.set(id, bookmarkWithoutThumbnail);\n  }\n};\n\nconst saveBookmarks = (bookmarks) => {\n  localStorage.bookmarks = JSON.stringify(Array.from(bookmarks.entries()));\n};\n\nconst addBookmark = (bookmark) => {\n  bookmark.id = nextBookmarkId++;\n  bookmarks.set(bookmark.id, bookmark);\n  saveBookmarks(bookmarks);\n};\n\nconst updateBookmark = (bookmark) => {\n  bookmarks.set(bookmark.id, bookmark);\n  saveBookmarks(bookmarks);\n};\n\nconst deleteBookmark = (bookmark) => {\n  bookmarks.delete(bookmark.id);\n  saveBookmarks(bookmarks);\n};\n\nconst createBookmark = (name) => ({\n  name: name || `Bookmark${nextBookmarkId}`,\n  fractalSetId: currentFractalSetId,\n  juliaConstant: { ...currentJuliaConstant },\n  colourMapId: currentColourMapId,\n  regionBottomLeft: { ...region.bottomLeft },\n  regionTopRight: { ...region.topRight },\n  maxIterations: currentMaxIterations,\n});\n\n// Implies all configuration values are being changed.\nconst switchToBookmark = (bookmark) => {\n  makeConfigurationChanges(bookmark);\n};\n\nconst CONTEXT_TYPE_EXPERIMENTAL_WEBGL = \"experimental-webgl\";\nconst CONTEXT_TYPE_WEBGL = \"webgl\";\nconst CONTEXT_TYPE_WEBGL_2 = \"webgl2\";\n\nconst VALID_CONTEXT_TYPES = [\n  CONTEXT_TYPE_EXPERIMENTAL_WEBGL,\n  CONTEXT_TYPE_WEBGL,\n  CONTEXT_TYPE_WEBGL_2,\n];\n\nconst initialiseWebGL = (canvas) => {\n  const tryContextType = (contextType) => {\n    try {\n      gl = canvas.getContext(contextType);\n      if (!gl) {\n        console.log(`Failed to initialise WebGL (contextType: ${contextType})`);\n      }\n    } catch (error) {\n      alert(`Exception trying to initialise WebGL (contextType: ${contextType})\\n${error.message}`);\n    }\n\n    const result = Boolean(gl);\n\n    if (result) {\n      if (contextType === CONTEXT_TYPE_WEBGL_2) {\n        isWebGL2 = true;\n      }\n    }\n\n    return result;\n  };\n\n  const contextTypeToTryFirst = VALID_CONTEXT_TYPES.includes(queryParamOptions.contextType)\n    ? queryParamOptions.contextType\n    : CONTEXT_TYPE_WEBGL_2;\n\n  if (!tryContextType(contextTypeToTryFirst)) {\n    if (contextTypeToTryFirst !== CONTEXT_TYPE_WEBGL) {\n      tryContextType(CONTEXT_TYPE_WEBGL);\n    }\n  }\n};\n\nconst MARKER = \"// INSERT-COMMON-CODE-HERE\\n\";\n\nconst insertCommonShaderSources = (source, commonShaderSources) => {\n  if (commonShaderSources?.length > 0) {\n    const markerPos = source.indexOf(MARKER);\n    if (markerPos >= 0) {\n      const insertPos = markerPos + MARKER.length;\n      const concatenatedCommonShaderSources = commonShaderSources.join(\"\\n\");\n      const before = source.substring(0, insertPos);\n      const after = source.substring(insertPos);\n      return before + concatenatedCommonShaderSources + after;\n    }\n  }\n  return source;\n};\n\nconst makeShader = (gl, source, shaderType, commonShaderSources) => {\n  const updatedSource = insertCommonShaderSources(source, commonShaderSources);\n  const shader = gl.createShader(shaderType);\n  gl.shaderSource(shader, updatedSource);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    const errorMessage = gl.getShaderInfoLog(shader);\n    console.error(`Failed to compile shader: ${errorMessage}`);\n    return null;\n  }\n  return shader;\n};\n\nconst initialiseShadersHelper = (name, vertexShaderSource, fragmentShaderSource) => {\n  const commonShaderSources = isWebGL2 ? [loopShaderSourceWebGL2] : [loopShaderSourceWebGL1];\n  const vertexShader = makeShader(gl, vertexShaderSource, gl.VERTEX_SHADER);\n  const fragmentShader = makeShader(\n    gl,\n    fragmentShaderSource,\n    gl.FRAGMENT_SHADER,\n    commonShaderSources\n  );\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    const errorMessage = gl.getProgramInfoLog(program);\n    console.error(`Failed to link program: ${errorMessage}`);\n    return;\n  }\n  gl.validateProgram(program);\n  if (!gl.getProgramParameter(program, gl.VALIDATE_STATUS)) {\n    const errorMessage = gl.getProgramInfoLog(program);\n    console.error(`Failed to validate program: ${errorMessage}`);\n    return;\n  }\n\n  const aVertexPosition = gl.getAttribLocation(program, \"aVertexPosition\");\n  gl.enableVertexAttribArray(aVertexPosition);\n\n  const aRegionPosition = gl.getAttribLocation(program, \"aRegionPosition\");\n  gl.enableVertexAttribArray(aRegionPosition);\n\n  const regionPositionBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, regionPositionBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, 4 * 2 * 4, gl.DYNAMIC_DRAW);\n\n  const uModelViewMatrix = gl.getUniformLocation(program, \"uModelViewMatrix\");\n  const uColourMap = gl.getUniformLocation(program, \"uColourMap\");\n  const uJuliaConstant = gl.getUniformLocation(program, \"uJuliaConstant\");\n\n  const uSmoothColouring = gl.getUniformLocation(program, \"uSmoothColouring\");\n  const uReturnIteration = gl.getUniformLocation(program, \"uReturnIteration\");\n\n  const maybeMaxIterationsUniform = isWebGL2\n    ? { uMaxIterations: gl.getUniformLocation(program, \"uMaxIterations\") }\n    : undefined;\n\n  // prettier-ignore\n  const vertexPositionBufferData = new Float32Array([\n    1.0, 1.0, // top right\n    -1.0, 1.0, // top left\n    1.0, -1.0, // bottom right\n    -1.0, -1.0 // bottom left\n  ]);\n  const vertexPositionBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexPositionBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, vertexPositionBufferData, gl.STATIC_DRAW);\n  gl.vertexAttribPointer(aVertexPosition, 2, gl.FLOAT, false, 0, 0);\n\n  return {\n    name,\n    program,\n    aVertexPosition,\n    aRegionPosition,\n    uModelViewMatrix,\n    ...maybeMaxIterationsUniform,\n    uColourMap,\n    uJuliaConstant,\n    uSmoothColouring,\n    uReturnIteration,\n    vertexPositionBuffer,\n    regionPositionBuffer,\n  };\n};\n\nconst initialiseShaders = () => {\n  const vertexShaderSource = isWebGL2 ? vertexShaderSourceWebGL2 : vertexShaderSourceWebGL1;\n  const mandelbrotShaderSource = isWebGL2\n    ? mandelbrotShaderSourceWebGL2\n    : mandelbrotShaderSourceWebGL1;\n  const juliaShaderSource = isWebGL2 ? juliaShaderSourceWebGL2 : juliaShaderSourceWebGL1;\n  const mandelbrotSet = initialiseShadersHelper(\n    \"Mandelbrot\",\n    vertexShaderSource,\n    mandelbrotShaderSource\n  );\n  const juliaSet = initialiseShadersHelper(\"Julia\", vertexShaderSource, juliaShaderSource);\n  fractalSets.set(C.FRACTAL_SET_ID_MANDELBROT, mandelbrotSet);\n  fractalSets.set(C.FRACTAL_SET_ID_JULIA, juliaSet);\n};\n\n// Some or all configuration values are being changed.\nconst makeConfigurationChanges = ({\n  fractalSetId,\n  juliaConstant,\n  colourMapId,\n  maxIterations,\n  regionBottomLeft,\n  regionTopRight,\n}) => {\n  if (regionBottomLeft && regionTopRight) {\n    performRegionUpdate(() => {\n      region.set(regionBottomLeft, regionTopRight);\n    });\n  }\n\n  if (Number.isInteger(fractalSetId)) {\n    currentFractalSetId = fractalSetId;\n    currentFractalSet = fractalSets.get(fractalSetId);\n  }\n\n  if (juliaConstant) {\n    currentJuliaConstant = juliaConstant;\n  }\n\n  if (Number.isInteger(colourMapId)) {\n    currentColourMapId = colourMapId;\n    currentColourMap = colourMaps.get(colourMapId);\n  }\n\n  if (isWebGL2) {\n    if (Number.isInteger(maxIterations)) {\n      currentMaxIterations = maxIterations;\n    }\n  }\n\n  gl.useProgram(currentFractalSet.program);\n\n  const modelViewMatrix = glm.mat4.fromScaling(glm.mat4.create(), [1, -1, 1]);\n  gl.uniformMatrix4fv(currentFractalSet.uModelViewMatrix, false, modelViewMatrix);\n\n  gl.uniform1i(currentFractalSet.uColourMap, currentColourMap.textureUnit);\n\n  gl.uniform2f(currentFractalSet.uJuliaConstant, currentJuliaConstant.x, currentJuliaConstant.y);\n\n  gl.uniform1i(currentFractalSet.uSmoothColouring, smoothColouring);\n  gl.uniform1i(currentFractalSet.uReturnIteration, false);\n\n  if (isWebGL2) {\n    gl.uniform1i(currentFractalSet.uMaxIterations, currentMaxIterations);\n  }\n};\n\nconst updateRegionPositionBuffer = () => {\n  if (!currentFractalSet) return;\n\n  const { regionPositionBuffer, aRegionPosition } = currentFractalSet;\n\n  // prettier-ignore\n  const regionPositionBufferData = new Float32Array([\n    region.topRight.x, region.topRight.y,\n    region.topLeft.x, region.topLeft.y,\n    region.bottomRight.x, region.bottomRight.y,\n    region.bottomLeft.x, region.bottomLeft.y,\n  ]);\n  gl.bindBuffer(gl.ARRAY_BUFFER, regionPositionBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, regionPositionBufferData, gl.DYNAMIC_DRAW);\n  gl.vertexAttribPointer(aRegionPosition, 2, gl.FLOAT, false, 0, 0);\n  gl.bindBuffer(gl.ARRAY_BUFFER, null);\n};\n\nconst performRegionUpdate = (thunk) => {\n  thunk();\n  updateRegionPositionBuffer();\n};\n\nconst render = (returnIteration = false) => {\n  if (returnIteration) {\n    gl.uniform1i(currentFractalSet.uReturnIteration, true);\n  }\n\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n  if (returnIteration) {\n    gl.uniform1i(currentFractalSet.uReturnIteration, false);\n  }\n\n  if (queryParamOptions.manualMode) {\n    updateConfigurationSummary();\n  }\n};\n\nconst displayConfiguration = async (explicitConfiguration) => {\n  const configuration = explicitConfiguration ?? nextConfiguration;\n  if (configuration) {\n    if (!explicitConfiguration) {\n      console.log(\"[displayConfiguration]\", \"nextConfigurationCount:\", nextConfigurationCount);\n      nextConfiguration = undefined;\n      nextConfigurationCount = 0;\n    }\n    switchToBookmark(configuration);\n    setCanvasAndViewportSize();\n    updateConfigurationSummary(configuration);\n    panSpeedX = configuration.panSpeedX ?? U.randomPanSpeed();\n    panSpeedY = configuration.panSpeedY ?? U.randomPanSpeed();\n    zoomSpeed = configuration.zoomSpeed ?? U.randomZoomSpeed();\n  }\n\n  setTimeout(displayConfiguration, CHANGE_REGION_INTERVAL_SECONDS * 1000);\n};\n\nexport const startGraphics = async (queryParamOptionsArg) => {\n  queryParamOptions = queryParamOptionsArg;\n\n  // Turning off the service worker for the moment. Not quite happy with it yet.\n  // if ('serviceWorker' in navigator) {\n  //   try {\n  //     const registration = await navigator.serviceWorker.register('service-worker.js')\n  //     console.log('Successfully registered service worker', registration)\n  //   } catch (error) {\n  //     console.error(`Failed to register service worker: ${error.message}`)\n  //   }\n  // }\n\n  canvas = document.getElementById(\"canvas\");\n\n  initialiseWebGL(canvas);\n  initialiseShaders();\n  loadColourMaps();\n\n  overlay = configureOverlay({\n    fractalSets,\n    colourMaps,\n  });\n\n  thumbnail = configureThumbnail({\n    gl,\n    createBookmark,\n    switchToBookmark,\n    setCanvasAndViewportSize,\n    render,\n  });\n\n  const fractalSetIds = Array.from(fractalSets.keys());\n  const colourMapIds = Array.from(colourMaps.keys());\n\n  configurationChooser = configureConfigurationChooser({\n    renderThumbnail: thumbnail.renderThumbnail,\n    fractalSetIds,\n    colourMapIds,\n    preview: queryParamOptions.preview,\n  });\n\n  ui = configureUI({\n    isWebGL2,\n    renderThumbnail: thumbnail.renderThumbnail,\n    addBookmark,\n    updateBookmark,\n    deleteBookmark,\n    switchToBookmark: (bookmark) => {\n      switchToBookmark(bookmark);\n      setCanvasAndViewportSize();\n      render();\n    },\n    fractalSets,\n    colourMaps,\n    onModalOpen,\n    onModalClose,\n  });\n\n  window.addEventListener(\"resize\", onWindowResize);\n\n  if (queryParamOptions.manualMode) {\n    canvas.addEventListener(\"mousedown\", onCanvasMouseDownHandler);\n    canvas.addEventListener(\"mousemove\", onCanvasMouseMoveHandler);\n    canvas.addEventListener(\"mouseup\", onCanvasMouseUpHandler);\n    canvas.addEventListener(\"mouseleave\", onCanvasMouseLeaveHandler);\n    document.addEventListener(\"keydown\", onDocumentKeyDownHandler);\n\n    new DragGesture(canvas, (e) => {\n      if (e.metaKey) return;\n      if (e.active) {\n        if (!panning) {\n          panning = true;\n          const [mouseX, mouseY] = e.initial;\n          lastMousePt = { mouseX, mouseY };\n        } else {\n          performRegionUpdate(() => {\n            const [mouseX, mouseY] = e.values;\n            const mouseDeltaX = mouseX - lastMousePt.mouseX;\n            const mouseDeltaY = mouseY - lastMousePt.mouseY;\n            region.drag(canvas, mouseDeltaX, mouseDeltaY);\n            lastMousePt = { mouseX, mouseY };\n          });\n          render();\n        }\n      } else {\n        panning = false;\n      }\n    });\n\n    loadBookmarks(bookmarks);\n    nextBookmarkId = bookmarks.size ? Math.max(...bookmarks.keys()) + 1 : 0;\n    switchToBookmark(C.INITIAL_BOOKMARK);\n    setCanvasAndViewportSize();\n    render();\n  } else {\n    displayConfiguration(C.INITIAL_BOOKMARK);\n    const animate = () => {\n      performRegionUpdate(() => {\n        region.panX(panSpeedX);\n        region.panY(panSpeedY);\n        region.zoom(zoomSpeed);\n      });\n      render();\n      requestAnimationFrame(animate);\n      doIdleTasks();\n    };\n    animate();\n  }\n};\n\nconst doIdleTasks = () => {\n  if (!nextConfiguration) {\n    nextConfiguration = configurationChooser.chooseConfiguration(CHANGE_REGION_INTERVAL_SECONDS);\n    nextConfigurationCount++;\n  }\n};\n\nconst setCanvasAndViewportSize = (explicitWidth, explicitHeight) => {\n  const width = explicitWidth ?? canvas.clientWidth;\n  const height = explicitHeight ?? canvas.clientHeight;\n\n  if (!explicitWidth && !explicitHeight) {\n    canvas.width = width;\n    canvas.height = height;\n    overlay.setSize(width, height);\n  }\n\n  gl.viewport(0, 0, width, height);\n\n  performRegionUpdate(() => {\n    region.adjustAspectRatio(width, height);\n  });\n};\n\nconst onWindowResize = () => {\n  setCanvasAndViewportSize();\n  render();\n};\n\nconst onCanvasMouseDownHandler = (e) => {\n  const mouseX = e.offsetX;\n  const mouseY = e.offsetY;\n  const { regionMouseX, regionMouseY } = region.mouseToRegion(canvas, mouseX, mouseY);\n\n  if (e.metaKey) {\n    selectingRegion = true;\n    selectingRegionInitialPt = { mouseX, mouseY };\n    selectingRegionCurrentPt = { mouseX, mouseY };\n    return;\n  }\n\n  if (e.shiftKey) {\n    performRegionUpdate(() => {\n      region.recentre(regionMouseX, regionMouseY);\n    });\n    return render();\n  }\n\n  if (e.altKey) {\n    switch (currentFractalSetId) {\n      case C.FRACTAL_SET_ID_MANDELBROT: {\n        const juliaConstant = {\n          x: regionMouseX,\n          y: regionMouseY,\n        };\n        makeConfigurationChanges({\n          fractalSetId: C.FRACTAL_SET_ID_JULIA,\n          juliaConstant,\n        });\n        render();\n        return;\n      }\n\n      case C.FRACTAL_SET_ID_JULIA:\n        makeConfigurationChanges({ fractalSetId: C.FRACTAL_SET_ID_MANDELBROT });\n        render();\n        return;\n\n      default:\n        return;\n    }\n  }\n\n  panning = true;\n  lastMousePt = { mouseX, mouseY };\n};\n\nconst onCanvasMouseMoveHandler = (e) => {\n  const mouseX = e.offsetX;\n  const mouseY = e.offsetY;\n\n  if (panning) {\n    performRegionUpdate(() => {\n      const mouseDeltaX = mouseX - lastMousePt.mouseX;\n      const mouseDeltaY = mouseY - lastMousePt.mouseY;\n      region.drag(canvas, mouseDeltaX, mouseDeltaY);\n    });\n    render();\n    lastMousePt = { mouseX, mouseY };\n    return;\n  }\n\n  if (selectingRegion) {\n    selectingRegionCurrentPt = { mouseX, mouseY };\n    overlay.drawSelectionRegion(\n      selectingRegionInitialPt.mouseX,\n      selectingRegionInitialPt.mouseY,\n      selectingRegionCurrentPt.mouseX,\n      selectingRegionCurrentPt.mouseY\n    );\n    return;\n  }\n};\n\nconst onCanvasMouseUpHandler = () => {\n  panning = false;\n\n  if (selectingRegion) {\n    const initialPt = selectingRegionInitialPt;\n    const currentPt = selectingRegionCurrentPt;\n    const topMouseY = Math.max(initialPt.mouseY, currentPt.mouseY);\n    const bottomMouseY = Math.min(initialPt.mouseY, currentPt.mouseY);\n    const leftMouseX = Math.min(initialPt.mouseX, currentPt.mouseX);\n    const rightMouseX = Math.max(initialPt.mouseX, currentPt.mouseX);\n    const diffX = rightMouseX - leftMouseX;\n    const diffY = topMouseY - bottomMouseY;\n    const minChange = 5;\n    if (diffX >= minChange && diffY >= minChange) {\n      const regionMouseBottomLeft = region.mouseToRegion(canvas, leftMouseX, bottomMouseY);\n      const regionMouseTopRight = region.mouseToRegion(canvas, rightMouseX, topMouseY);\n      const bottomLeft = {\n        x: regionMouseBottomLeft.regionMouseX,\n        y: regionMouseBottomLeft.regionMouseY,\n      };\n      const topRight = { x: regionMouseTopRight.regionMouseX, y: regionMouseTopRight.regionMouseY };\n      performRegionUpdate(() => {\n        region.set(bottomLeft, topRight);\n      });\n      setCanvasAndViewportSize();\n      render();\n    }\n\n    overlay.clearSelectionRegion();\n\n    selectingRegion = false;\n  }\n};\n\nconst onCanvasMouseLeaveHandler = () => {\n  if (panning) {\n    panning = false;\n  }\n\n  if (selectingRegion) {\n    overlay.clearSelectionRegion();\n    selectingRegionInitialPt = undefined;\n    selectingRegionCurrentPt = undefined;\n    selectingRegion = false;\n  }\n};\n\nconst onDocumentKeyDownHandler = (e) => {\n  if (modalOpen) return;\n\n  if (bookmarkMode) {\n    return handleBookmarkKeys(e);\n  }\n\n  if (!bookmarkMode && e.key === \"b\") {\n    bookmarkMode = true;\n    return;\n  }\n\n  if (e.key === \"+\") {\n    performRegionUpdate(() => {\n      region.zoom(50);\n    });\n    render();\n    return;\n  }\n\n  if (e.key === \"-\") {\n    performRegionUpdate(() => {\n      region.zoom(-100);\n    });\n    render();\n    return;\n  }\n\n  if (e.key === \"h\") {\n    switchToBookmark(C.HOME_BOOKMARK);\n    setCanvasAndViewportSize();\n    render();\n    return;\n  }\n\n  if (e.key === \"c\" || e.key === \"C\") {\n    const keys = Array.from(colourMaps.keys());\n    const maxIndex = keys.length;\n    const oldIndex = keys.indexOf(currentColourMapId);\n    const newIndex = (oldIndex + (e.shiftKey ? maxIndex - 1 : 1)) % maxIndex;\n    const newColourMapId = keys[newIndex];\n    makeConfigurationChanges({ colourMapId: newColourMapId });\n    render();\n    return;\n  }\n\n  if (isWebGL2) {\n    if (e.key === \"i\" || e.key === \"I\") {\n      const delta = C.DELTA_ITERATIONS * (e.shiftKey ? -1 : +1);\n      currentMaxIterations = U.clamp(\n        C.MIN_ITERATIONS,\n        C.MAX_ITERATIONS_MANUAL,\n        currentMaxIterations + delta\n      );\n      makeConfigurationChanges({ maxIterations: currentMaxIterations });\n      render();\n      return;\n    }\n  }\n\n  if (e.key === \"s\") {\n    smoothColouring = !smoothColouring;\n    makeConfigurationChanges({});\n    render();\n  }\n\n  if (e.key === \"v\") {\n    if (configurationSummaryOpen) {\n      hideConfigurationSummary();\n    } else {\n      showConfigurationSummary();\n    }\n  }\n};\n\nconst hideConfigurationSummary = () => {\n  overlay.hideConfigurationSummary();\n  configurationSummaryOpen = false;\n};\n\nconst showConfigurationSummary = () => {\n  const configuration = createBookmark();\n  overlay.showConfigurationSummary(configuration);\n  configurationSummaryOpen = true;\n};\n\nconst updateConfigurationSummary = () => {\n  const configuration = createBookmark();\n  overlay.updateConfigurationSummary(configuration);\n};\n\nconst handleBookmarkKeys = (e) => {\n  bookmarkMode = false;\n\n  if (e.key === \"n\") {\n    const bookmark = createBookmark();\n    return ui.presentBookmarkModal(bookmark);\n  }\n\n  if (e.key === \"l\") {\n    return ui.presentManageBookmarksModal(bookmarks);\n  }\n};\n","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import { startGraphics } from \"./graphics\";\n\nconst isBoolTrue = (s) => {\n  const trueValues = [\"\", \"true\", \"1\", \"on\"];\n  return trueValues.includes(s?.toLowerCase());\n};\n\nconst url = new URL(document.location);\nconst manualMode = url.searchParams.get(\"mode\") === \"manual\";\nconst contextType = url.searchParams.get(\"contextType\");\nconst preview = isBoolTrue(url.searchParams.get(\"preview\"));\n\nstartGraphics({ manualMode, contextType, preview });\n","import * as C from \"./constants\";\n\nconst RUBBER_BAND_RECT_THICKNESS = 2;\nconst RUBBER_BAND_RECT_COLOUR = \"#FFFFFF80\";\n\nconst CONFIGURATION_SUMMARY_TIMEOUT = 5000;\n\nexport const configureOverlay = ({ fractalSets, colourMaps }) => {\n  const canvasOverlay = document.getElementById(\"canvasOverlay\");\n  const canvasOverlayCtx2d = canvasOverlay.getContext(\"2d\");\n\n  const divOverlay = document.getElementById(\"divOverlay\");\n  const configurationSummary = document.getElementById(\"configurationSummary\");\n  let configurationSummaryForcedOn = false;\n  let configurationSummaryTimer = undefined;\n\n  const setSize = (width, height) => {\n    canvasOverlay.width = width;\n    canvasOverlay.height = height;\n    divOverlay.width = width;\n    divOverlay.height = height;\n  };\n\n  const drawSelectionRegion = (x1, y1, x2, y2) => {\n    clearSelectionRegion();\n    const top = Math.max(y1, y2);\n    const bottom = Math.min(y1, y2);\n    const left = Math.min(x1, x2);\n    const right = Math.max(x1, x2);\n    const width = right - left;\n    const height = top - bottom;\n    canvasOverlayCtx2d.lineWidth = RUBBER_BAND_RECT_THICKNESS;\n    canvasOverlayCtx2d.strokeStyle = RUBBER_BAND_RECT_COLOUR;\n    canvasOverlayCtx2d.strokeRect(left, bottom, width, height);\n  };\n\n  const clearSelectionRegion = () => {\n    canvasOverlayCtx2d.clearRect(0, 0, canvasOverlay.width, canvasOverlay.height);\n  };\n\n  const formatCoords = ({ x, y }) => {\n    return `(${x}, ${y})`;\n  };\n\n  const setConfigurationSummaryText = (configuration) => {\n    const juliaConstant =\n      configuration.fractalSetId === C.FRACTAL_SET_ID_JULIA\n        ? formatCoords(configuration.juliaConstant)\n        : \"\";\n    const bottomLeftFormatted = formatCoords(configuration.regionBottomLeft);\n    const topRightFormatted = formatCoords(configuration.regionTopRight);\n    const region = `${bottomLeftFormatted}, ${topRightFormatted}`;\n    const bits = [\n      fractalSets.get(configuration.fractalSetId)?.name ?? \"unknown\",\n      juliaConstant,\n      region,\n      colourMaps.get(configuration.colourMapId)?.name ?? \"unknown\",\n      configuration.maxIterations,\n    ];\n    configurationSummary.innerText = bits.filter(Boolean).join(\" | \");\n  };\n\n  const makeConfigurationSummaryVisible = () => {\n    configurationSummary.style.display = \"block\";\n  };\n\n  const makeConfigurationSummaryInvisible = () => {\n    configurationSummary.style.display = \"none\";\n  };\n\n  const showConfigurationSummary = (configuration) => {\n    setConfigurationSummaryText(configuration);\n    makeConfigurationSummaryVisible();\n    setConfigurationSummaryForcedOn();\n  };\n\n  const hideConfigurationSummary = () => {\n    makeConfigurationSummaryInvisible();\n    resetConfigurationSummaryForcedOn();\n  };\n\n  const updateConfigurationSummary = (configuration) => {\n    setConfigurationSummaryText(configuration);\n    if (!configurationSummaryForcedOn) {\n      startConfigurationSummaryTimer();\n    }\n  };\n\n  const setConfigurationSummaryForcedOn = () => {\n    killConfigurationSummaryTimer();\n    configurationSummaryForcedOn = true;\n  };\n\n  const resetConfigurationSummaryForcedOn = () => {\n    killConfigurationSummaryTimer();\n    configurationSummaryForcedOn = false;\n  };\n\n  const startConfigurationSummaryTimer = () => {\n    makeConfigurationSummaryVisible();\n    killConfigurationSummaryTimer();\n    configurationSummaryTimer = setTimeout(() => {\n      makeConfigurationSummaryInvisible();\n      configurationSummaryTimer = undefined;\n    }, CONFIGURATION_SUMMARY_TIMEOUT);\n  };\n\n  const killConfigurationSummaryTimer = () => {\n    clearTimeout(configurationSummaryTimer);\n    configurationSummaryTimer = undefined;\n  };\n\n  return {\n    setSize,\n    drawSelectionRegion,\n    clearSelectionRegion,\n    showConfigurationSummary,\n    hideConfigurationSummary,\n    updateConfigurationSummary,\n  };\n};\n","export const configureThumbnail = ({\n  gl,\n  createBookmark,\n  switchToBookmark,\n  setCanvasAndViewportSize,\n  render,\n}) => {\n  // https://webglfundamentals.org/webgl/lessons/webgl-render-to-texture.html\n  // https://stackoverflow.com/a/13640310\n  const renderThumbnail = (width, height, configuration, returnIteration) => {\n    const texture = gl.createTexture();\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n\n    gl.texImage2D(\n      gl.TEXTURE_2D, // target\n      0, // level\n      gl.RGBA, // internalFormat\n      width, // width\n      height, // height\n      0, // border\n      gl.RGBA, // format\n      gl.UNSIGNED_BYTE, // type\n      null // pixels\n    );\n\n    const fb = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER, // target\n      gl.COLOR_ATTACHMENT0, // attachment\n      gl.TEXTURE_2D, // texture target\n      texture, // texture\n      0 // level\n    );\n\n    const savedConfiguration = createBookmark(\"saved-configuration\");\n    switchToBookmark(configuration);\n    setCanvasAndViewportSize(width, height);\n\n    render(returnIteration);\n\n    const pixels = new Uint8Array(width * height * 4);\n    gl.readPixels(0, 0, width, height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\n\n    switchToBookmark(savedConfiguration);\n    setCanvasAndViewportSize();\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.deleteFramebuffer(fb);\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.deleteTexture(texture);\n\n    return pixels;\n  };\n\n  return { renderThumbnail };\n};\n","import { Region } from \"./region\";\nimport * as U from \"./utils\";\n\nconst SAMPLE_SIZE = 64;\nconst MIN_REQUIRED_PERCENT = 60;\nconst MAX_FPS = 60;\n\nexport const configureConfigurationChooser = ({\n  renderThumbnail,\n  fractalSetIds,\n  colourMapIds,\n  preview,\n}) => {\n  const canvas = document.getElementById(\"canvas\");\n  const previewPanel = document.getElementById(\"preview-panel\");\n  const previewInitialCanvas = document.getElementById(\"preview-initial\");\n  const previewFinalCanvas = document.getElementById(\"preview-final\");\n\n  const isInterestingConfiguration = (configuration, sampleWidth, sampleHeight, type) => {\n    const returnIterationFlag = true;\n    const pixels = renderThumbnail(sampleWidth, sampleHeight, configuration, returnIterationFlag);\n    const iterationValues = new Set();\n    for (let i = 0; i < pixels.length; i += 4) {\n      const lo = pixels[i];\n      const hi = pixels[i + 1];\n      const iteration = lo + (hi << 8);\n      iterationValues.add(iteration);\n    }\n    const uniqueIterationValues = Array.from(iterationValues);\n    const numUniqueIterationValues = uniqueIterationValues.length;\n    const maxIterations = configuration.maxIterations;\n    const threshold = maxIterations * (MIN_REQUIRED_PERCENT / 100);\n    const result = numUniqueIterationValues >= threshold;\n    if (result) {\n      const dataToLog = {\n        type,\n        numUniqueIterationValues,\n        threshold,\n        maxIterations,\n      };\n      console.log(\"[configureConfigurationChooser]\", JSON.stringify(dataToLog, null, 2));\n    }\n    return result;\n  };\n\n  const computeFinalConfiguration = (configuration, seconds) => {\n    const frameCount = seconds * MAX_FPS;\n    const region = new Region();\n    region.set(configuration.regionBottomLeft, configuration.regionTopRight);\n    for (let i = 0; i < frameCount; i++) {\n      region.panX(configuration.panSpeedX);\n      region.panY(configuration.panSpeedY);\n      region.zoom(configuration.zoomSpeed);\n    }\n    return {\n      ...configuration,\n      regionBottomLeft: region.bottomLeft,\n      regionTopRight: region.topRight,\n    };\n  };\n\n  const createRandomConfiguration = () => {\n    const fractalSetId = U.randomElement(fractalSetIds);\n    const colourMapId = U.randomElement(colourMapIds);\n    const cx = U.randomFloat(-2, 0.75);\n    const cy = U.randomFloat(-1.5, 1.5);\n    const sz = U.randomFloat(0.01, 0.5);\n    const maxIterations = U.randomInt(32, 1024);\n    const panSpeedX = U.randomPanSpeed();\n    const panSpeedY = U.randomPanSpeed();\n    const zoomSpeed = U.randomZoomSpeed();\n\n    return {\n      fractalSetId,\n      juliaConstant: { x: cx, y: cy },\n      colourMapId,\n      regionBottomLeft: { x: cx - sz, y: cy - sz },\n      regionTopRight: { x: cx + sz, y: cy + sz },\n      maxIterations,\n      panSpeedX,\n      panSpeedY,\n      zoomSpeed,\n    };\n  };\n\n  const chooseConfiguration = (seconds) => {\n    const initialConfiguration = createRandomConfiguration(fractalSetIds, colourMapIds);\n    const canvasWidth = canvas.clientWidth;\n    const canvasHeight = canvas.clientHeight;\n    const aspectRatio = canvasWidth / canvasHeight;\n    const region = new Region();\n    region.set(initialConfiguration.regionBottomLeft, initialConfiguration.regionTopRight);\n    region.adjustAspectRatio(canvas.clientWidth, canvas.clientHeight);\n    initialConfiguration.regionBottomLeft = region.bottomLeft;\n    initialConfiguration.regionTopRight = region.topRight;\n    const sampleWidth = SAMPLE_SIZE;\n    const sampleHeight = Math.round(SAMPLE_SIZE / aspectRatio);\n    if (isInterestingConfiguration(initialConfiguration, sampleWidth, sampleHeight, \"initial\")) {\n      const finalConfiguration = computeFinalConfiguration(initialConfiguration, seconds);\n      if (isInterestingConfiguration(finalConfiguration, sampleWidth, sampleHeight, \"final\")) {\n        if (preview) {\n          previewPanel.style.visibility = \"visible\";\n          const previewInitialPixels = renderThumbnail(\n            sampleWidth,\n            sampleHeight,\n            initialConfiguration\n          );\n          const previewFinalPixels = renderThumbnail(sampleWidth, sampleHeight, finalConfiguration);\n          U.drawThumbnail(previewInitialPixels, previewInitialCanvas, sampleWidth, sampleHeight);\n          U.drawThumbnail(previewFinalPixels, previewFinalCanvas, sampleWidth, sampleHeight);\n        }\n        return initialConfiguration;\n      }\n    }\n  };\n\n  return {\n    chooseConfiguration,\n  };\n};\n"],"names":["module","exports","colorScale","lerp","rgb2float","rgba","rgb2hex","dig","hex","i","toString","substr","length","rgbaStr","join","spec","indicies","fromrgba","torgba","nsteps","cmap","colormap","format","nshades","alpha","toLowerCase","Error","Array","isArray","slice","map","c","Math","round","index","min","max","steps","rgb","colors","j","amt","push","concat","v0","v1","t","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","ARRAY_TYPE","Float32Array","random","PI","hypot","y","arguments","sqrt","V","toVector","v","fallback","add","v2","sub","addTo","subTo","rubberband","distance","dimension","constant","abs","Infinity","pow","rubberbandIfOutOfBounds","position","clamp","_defineProperty","value","arg","input","hint","prim","Symbol","toPrimitive","res","TypeError","String","_toPrimitive","_toPropertyKey","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread2","target","source","forEach","getOwnPropertyDescriptors","defineProperties","EVENT_TYPE_MAP","pointer","start","change","end","mouse","touch","gesture","capitalize","string","toUpperCase","actionsWithoutCaptureSupported","pointerCaptureEvents","parseProp","eventKey","substring","passive","indexOf","replace","captureKey","includes","capture","device","isTouch","event","getPointerType","pointerType","getValueEvent","type","changedTouches","targetTouches","getTouchList","pointerId","valueEvent","identifier","pointerValues","clientX","clientY","args","noop","chain","fns","result","fn","this","assignDefault","assign","Engine","constructor","ctrl","state","computeValues","computeInitial","init","reset","shared","eventStore","gestureEventStores","timeoutStore","gestureTimeoutStores","config","sharedConfig","handler","handlers","ingKey","_active","active","_blocked","_force","_step","intentional","_movement","_distance","_direction","_delta","_bounds","axis","memo","elapsedTime","timeDelta","direction","overflow","_movementBound","velocity","movement","delta","timeStamp","currentTarget","lastOffset","from","offset","startTime","values","_values","transform","_initial","initial","compute","dt","preventDefault","cancelable","touches","pointerIds","size","touchIds","locked","document","pointerLockElement","payload","buttons","shiftKey","altKey","metaKey","ctrlKey","getEventDetails","down","pressed","_absoluteDelta","axisIntent","_m0","_m1","t0","t1","threshold","hasCustomTransform","sign","restrictToAxis","previousOffset","gestureIsActive","first","last","bounds","setup","computeOffset","ox","oy","x0","x1","y0","y1","Vx","Vy","Rx","Ry","X0","X1","Y0","Y1","computeRubberband","computeMovement","absoluteDelta","emit","clean","triggerAllEvents","aliasKey","CoordinatesEngine","super","axisThreshold","dx","dy","absDx","absDy","selectAxis","lockDirection","commonConfigResolver","enabled","eventOptions","_k","coordinatesConfigResolver","_v","current","HTMLElement","left","right","top","bottom","KEYS_DELTA_MAP","ArrowRight","displacement","factor","ArrowLeft","ArrowUp","ArrowDown","isBrowser","window","createElement","isTouchScreen","navigator","maxTouchPoints","SUPPORT","GestureEvent","e","supportsGestureEvents","touchscreen","pointerLock","DEFAULT_DRAG_AXIS_THRESHOLD","pen","dragConfigResolver","lock","preventScrollAxis","preventScroll","preventScrollDelay","pointerCapture","pointerButtons","filterTaps","tapsThreshold","swipe","duration","delay","keyboardDisplacement","scaleBounds","angleBounds","_scaleBounds","D","_angleBounds","A","modifierKey","pinchOnWheel","mouseOnly","Map","ConfigResolverMap","engine","_pointerId","_pointerActive","_keyboardActive","_preventScroll","_delayed","tap","canceled","cancel","bind","boundRect","getBoundingClientRect","targetRect","setTimeout","setActive","pointerClean","pointerDown","ctrlIds","setEventIds","setPointerCapture","setupPointer","setupScrollPrevention","setupDelayTrigger","startPointerDrag","pointerMove","id","movementX","movementY","remove","pointerUp","hasPointerCapture","releasePointerCapture","_unused","_dx","_dy","_mx","_my","svx","svy","sx","sy","sdt","_vx","_vy","pointerClick","detail","stopPropagation","requestPointerLock","exitPointerLock","persist","persistEvent","keyDown","deltaFn","keyUp","bindFunction","resolver","sharedConfigResolver","_excluded","resolveWith","resolvers","entries","EventStore","gestureKey","Set","_ctrl","_gestureKey","element","action","options","listeners","_listeners","deviceProps","toDomEventType","addEventListener","removeEventListener","delete","clear","TimeoutStore","callback","ms","_timeouts","set","timeout","clearTimeout","Controller","internalHandlers","drag","setupGesture","wheel","scroll","move","pinch","hover","_event$currentTarget","_event$currentTarget$","contains","getCurrentTargetTouchList","applyHandlers","nativeHandlers","applyConfig","newConfig","_config","_ref","rest","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","propertyIsEnumerable","_objectWithoutProperties","parse","_targetEventStore","gestures","effect","props","gestureConfig","bindToProps","nativeBindFunction","handlerProp","withPassiveOption","isNative","_options$capture","_options$passive","actionKey","hasCapture","toHandlerProp","Recognizer","_target","destroy","setConfig","DragGesture","Region","_bottomLeft","x","_topRight","topLeft","topRight","bottomLeft","bottomRight","width","height","centreX","centreY","adjustAspectRatio","canvasWidth","canvasHeight","widthDeltaHalf","heightDeltaHalf","mouseToRegion","canvas","mouseX","mouseY","offsetRatioX","offsetRatioY","regionMouseX","regionMouseY","mouseDeltaX","mouseDeltaY","regionDeltaX","regionDeltaY","recentre","translationX","translationY","panX","percent","widthDelta","panY","heightDelta","zoom","randomFloat","randomInt","floor","randomElement","elements","randomPanSpeed","randomZoomSpeed","drawThumbnail","pixels","canvasCtx2d","getContext","pixelsClampedArray","Uint8ClampedArray","imageData","ImageData","putImageData","scale","translate","drawImage","COLOUR_MAP_NAMES","INITIAL_BOOKMARK","fractalSetId","juliaConstant","colourMapId","regionBottomLeft","regionTopRight","maxIterations","HOME_BOOKMARK","THUMBNAIL_SIZE","queryParamOptions","overlay","thumbnail","configurationChooser","gl","ui","isWebGL2","fractalSets","colourMaps","currentFractalSetId","currentFractalSet","currentJuliaConstant","currentColourMapId","currentColourMap","currentMaxIterations","region","selectingRegionInitialPt","selectingRegionCurrentPt","lastMousePt","nextConfiguration","panSpeedX","panSpeedY","zoomSpeed","panning","selectingRegion","bookmarkMode","bookmarks","nextBookmarkId","modalOpen","configurationSummaryOpen","smoothColouring","nextConfigurationCount","onModalOpen","onModalClose","saveBookmarks","localStorage","JSON","stringify","addBookmark","bookmark","updateBookmark","deleteBookmark","createBookmark","name","switchToBookmark","makeConfigurationChanges","CONTEXT_TYPE_WEBGL","CONTEXT_TYPE_WEBGL_2","VALID_CONTEXT_TYPES","makeShader","shaderType","commonShaderSources","updatedSource","insertCommonShaderSources","markerPos","insertPos","MARKER","concatenatedCommonShaderSources","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorMessage","getShaderInfoLog","console","error","initialiseShadersHelper","vertexShaderSource","fragmentShaderSource","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","validateProgram","VALIDATE_STATUS","aVertexPosition","getAttribLocation","enableVertexAttribArray","aRegionPosition","regionPositionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","uModelViewMatrix","getUniformLocation","uColourMap","uJuliaConstant","uSmoothColouring","uReturnIteration","maybeMaxIterationsUniform","uMaxIterations","vertexPositionBufferData","vertexPositionBuffer","STATIC_DRAW","vertexAttribPointer","FLOAT","performRegionUpdate","Number","isInteger","useProgram","modelViewMatrix","out","glm","uniformMatrix4fv","uniform1i","textureUnit","uniform2f","thunk","updateRegionPositionBuffer","regionPositionBufferData","render","returnIteration","drawArrays","TRIANGLE_STRIP","manualMode","updateConfigurationSummary","displayConfiguration","async","configuration","explicitConfiguration","log","setCanvasAndViewportSize","U","CHANGE_REGION_INTERVAL_SECONDS","explicitWidth","explicitHeight","clientWidth","clientHeight","setSize","viewport","onWindowResize","onCanvasMouseDownHandler","offsetX","offsetY","onCanvasMouseMoveHandler","drawSelectionRegion","onCanvasMouseUpHandler","initialPt","currentPt","topMouseY","bottomMouseY","leftMouseX","rightMouseX","minChange","regionMouseBottomLeft","regionMouseTopRight","clearSelectionRegion","onCanvasMouseLeaveHandler","onDocumentKeyDownHandler","handleBookmarkKeys","C","maxIndex","oldIndex","newColourMapId","hideConfigurationSummary","showConfigurationSummary","presentBookmarkModal","presentManageBookmarksModal","url","URL","location","s","queryParamOptionsArg","getElementById","tryContextType","contextType","alert","message","Boolean","contextTypeToTryFirst","initialiseWebGL","initialiseShaders","juliaShaderSource","mandelbrotSet","juliaSet","loadColourMaps","maxColourMaps","getParameter","MAX_COMBINED_TEXTURE_IMAGE_UNITS","colourMapName","loadColourMap","colourMap","flat","createColourMapTexture","texture","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","Uint8Array","texImage2D","RGBA","UNSIGNED_BYTE","canvasOverlay","canvasOverlayCtx2d","divOverlay","configurationSummary","configurationSummaryTimer","configurationSummaryForcedOn","clearRect","formatCoords","_ref2","setConfigurationSummaryText","_fractalSets$get","_colourMaps$get","bits","innerText","makeConfigurationSummaryVisible","style","display","makeConfigurationSummaryInvisible","killConfigurationSummaryTimer","x2","y2","lineWidth","strokeStyle","strokeRect","configureOverlay","renderThumbnail","fb","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","savedConfiguration","readPixels","deleteFramebuffer","deleteTexture","configureThumbnail","fractalSetIds","colourMapIds","preview","previewPanel","previewInitialCanvas","previewFinalCanvas","isInterestingConfiguration","sampleWidth","sampleHeight","iterationValues","iteration","numUniqueIterationValues","dataToLog","chooseConfiguration","seconds","initialConfiguration","createRandomConfiguration","cx","cy","sz","aspectRatio","finalConfiguration","computeFinalConfiguration","frameCount","visibility","previewInitialPixels","previewFinalPixels","configureConfigurationChooser","bookmarkModal","$","on","hasId","title","text","off","val","modal","thumbnailCanvas","focus","colourMapSelect","empty","selected","append","maxIterationsRange","attr","hide","juliaConstantP","juliaConstantDiv","closest","show","manageBookmarksModal","tbody","invokeHandler","onSwitchTo","onEdit","bookmarkClone","onDelete","bookmarkRowTemplate","tr","importNode","content","querySelector","editButton","deleteButton","configureUI","_thumbnail","bookmarkWithoutThumbnail","loadBookmarks","animate","requestAnimationFrame","startGraphics","searchParams"],"sourceRoot":""}